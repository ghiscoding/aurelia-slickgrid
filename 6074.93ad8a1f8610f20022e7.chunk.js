"use strict";(self.webpackChunkau_slickgrid_demo=self.webpackChunkau_slickgrid_demo||[]).push([[6074],{6074:(t,e,r)=>{r.d(e,{N:()=>Ht});var s={},o=Uint8Array,i=Uint16Array,n=Int32Array,a=new o([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new o([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new o([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(t,e){for(var r=new i(31),s=0;s<31;++s)r[s]=e+=1<<t[s-1];var o=new n(r[30]);for(s=1;s<30;++s)for(var a=r[s];a<r[s+1];++a)o[a]=a-r[s]<<5|s;return{b:r,r:o}},d=c(a,2),p=d.b,u=d.r;p[28]=258,u[258]=28;for(var m=c(l,0),f=(m.b,m.r),g=new i(32768),b=0;b<32768;++b){var x=(43690&b)>>1|(21845&b)<<1;x=(61680&(x=(52428&x)>>2|(13107&x)<<2))>>4|(3855&x)<<4,g[b]=((65280&x)>>8|(255&x)<<8)>>1}var y=function(t,e,r){for(var s=t.length,o=0,n=new i(e);o<s;++o)t[o]&&++n[t[o]-1];var a,l=new i(e);for(o=1;o<e;++o)l[o]=l[o-1]+n[o-1]<<1;if(r){a=new i(1<<e);var h=15-e;for(o=0;o<s;++o)if(t[o])for(var c=o<<4|t[o],d=e-t[o],p=l[t[o]-1]++<<d,u=p|(1<<d)-1;p<=u;++p)a[g[p]>>h]=c}else for(a=new i(s),o=0;o<s;++o)t[o]&&(a[o]=g[l[t[o]-1]++]>>15-t[o]);return a},C=new o(288);for(b=0;b<144;++b)C[b]=8;for(b=144;b<256;++b)C[b]=9;for(b=256;b<280;++b)C[b]=7;for(b=280;b<288;++b)C[b]=8;var w=new o(32);for(b=0;b<32;++b)w[b]=5;var _=y(C,9,0),v=y(w,5,0),E=function(t){return(t+7)/8|0},S=function(t,e,r){return(null==e||e<0)&&(e=0),(null==r||r>t.length)&&(r=t.length),new o(t.subarray(e,r))},T=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(t,e,r){var s=new Error(e||T[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,F),!r)throw s;return s},A=function(t,e,r){r<<=7&e;var s=e/8|0;t[s]|=r,t[s+1]|=r>>8},k=function(t,e,r){r<<=7&e;var s=e/8|0;t[s]|=r,t[s+1]|=r>>8,t[s+2]|=r>>16},O=function(t,e){for(var r=[],s=0;s<t.length;++s)t[s]&&r.push({s,f:t[s]});var n=r.length,a=r.slice();if(!n)return{t:L,l:0};if(1==n){var l=new o(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort((function(t,e){return t.f-e.f})),r.push({s:-1,f:25001});var h=r[0],c=r[1],d=0,p=1,u=2;for(r[0]={s:-1,f:h.f+c.f,l:h,r:c};p!=n-1;)h=r[r[d].f<r[u].f?d++:u++],c=r[d!=p&&r[d].f<r[u].f?d++:u++],r[p++]={s:-1,f:h.f+c.f,l:h,r:c};var m=a[0].s;for(s=1;s<n;++s)a[s].s>m&&(m=a[s].s);var f=new i(m+1),g=P(r[p-1],f,0);if(g>e){s=0;var b=0,x=g-e,y=1<<x;for(a.sort((function(t,e){return f[e.s]-f[t.s]||t.f-e.f}));s<n;++s){var C=a[s].s;if(!(f[C]>e))break;b+=y-(1<<g-f[C]),f[C]=e}for(b>>=x;b>0;){var w=a[s].s;f[w]<e?b-=1<<e-f[w]++-1:++s}for(;s>=0&&b;--s){var _=a[s].s;f[_]==e&&(--f[_],++b)}g=e}return{t:new o(f),l:g}},P=function(t,e,r){return-1==t.s?Math.max(P(t.l,e,r+1),P(t.r,e,r+1)):e[t.s]=r},I=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new i(++e),s=0,o=t[0],n=1,a=function(t){r[s++]=t},l=1;l<=e;++l)if(t[l]==o&&l!=e)++n;else{if(!o&&n>2){for(;n>138;n-=138)a(32754);n>2&&(a(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(a(o),--n;n>6;n-=6)a(8304);n>2&&(a(n-3<<5|8208),n=0)}for(;n--;)a(o);n=1,o=t[l]}return{c:r.subarray(0,s),n:e}},D=function(t,e){for(var r=0,s=0;s<e.length;++s)r+=t[s]*e[s];return r},N=function(t,e,r){var s=r.length,o=E(e+2);t[o]=255&s,t[o+1]=s>>8,t[o+2]=255^t[o],t[o+3]=255^t[o+1];for(var i=0;i<s;++i)t[o+i+4]=r[i];return 8*(o+4+s)},R=function(t,e,r,s,o,n,c,d,p,u,m){A(e,m++,r),++o[256];for(var f=O(o,15),g=f.t,b=f.l,x=O(n,15),E=x.t,S=x.l,T=I(g),F=T.c,P=T.n,R=I(E),M=R.c,L=R.n,$=new i(19),z=0;z<F.length;++z)++$[31&F[z]];for(z=0;z<M.length;++z)++$[31&M[z]];for(var B=O($,7),H=B.t,V=B.l,j=19;j>4&&!H[h[j-1]];--j);var G,X,W,Q,U=u+5<<3,q=D(o,C)+D(n,w)+c,J=D(o,g)+D(n,E)+c+14+3*j+D($,H)+2*$[16]+3*$[17]+7*$[18];if(p>=0&&U<=q&&U<=J)return N(e,m,t.subarray(p,p+u));if(A(e,m,1+(J<q)),m+=2,J<q){G=y(g,b,0),X=g,W=y(E,S,0),Q=E;var K=y(H,V,0);for(A(e,m,P-257),A(e,m+5,L-1),A(e,m+10,j-4),m+=14,z=0;z<j;++z)A(e,m+3*z,H[h[z]]);m+=3*j;for(var Y=[F,M],Z=0;Z<2;++Z){var tt=Y[Z];for(z=0;z<tt.length;++z){var et=31&tt[z];A(e,m,K[et]),m+=H[et],et>15&&(A(e,m,tt[z]>>5&127),m+=tt[z]>>12)}}}else G=_,X=C,W=v,Q=w;for(z=0;z<d;++z){var rt=s[z];if(rt>255){k(e,m,G[257+(et=rt>>18&31)]),m+=X[et+257],et>7&&(A(e,m,rt>>23&31),m+=a[et]);var st=31&rt;k(e,m,W[st]),m+=Q[st],st>3&&(k(e,m,rt>>5&8191),m+=l[st])}else k(e,m,G[rt]),m+=X[rt]}return k(e,m,G[256]),m+X[256]},M=new n([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),L=new o(0),$=function(t,e,r,s,h,c){var d=c.z||t.length,p=new o(s+d+5*(1+Math.ceil(d/7e3))+h),m=p.subarray(s,p.length-h),g=c.l,b=7&(c.r||0);if(e){b&&(m[0]=c.r>>3);for(var x=M[e-1],y=x>>13,C=8191&x,w=(1<<r)-1,_=c.p||new i(32768),v=c.h||new i(w+1),T=Math.ceil(r/3),F=2*T,A=function(e){return(t[e]^t[e+1]<<T^t[e+2]<<F)&w},k=new n(25e3),O=new i(288),P=new i(32),I=0,D=0,L=c.i||0,$=0,z=c.w||0,B=0;L+2<d;++L){var H=A(L),V=32767&L,j=v[H];if(_[V]=j,v[H]=V,z<=L){var G=d-L;if((I>7e3||$>24576)&&(G>423||!g)){b=R(t,m,0,k,O,P,D,$,B,L-B,b),$=I=D=0,B=L;for(var X=0;X<286;++X)O[X]=0;for(X=0;X<30;++X)P[X]=0}var W=2,Q=0,U=C,q=V-j&32767;if(G>2&&H==A(L-q))for(var J=Math.min(y,G)-1,K=Math.min(32767,L),Y=Math.min(258,G);q<=K&&--U&&V!=j;){if(t[L+W]==t[L+W-q]){for(var Z=0;Z<Y&&t[L+Z]==t[L+Z-q];++Z);if(Z>W){if(W=Z,Q=q,Z>J)break;var tt=Math.min(q,Z-2),et=0;for(X=0;X<tt;++X){var rt=L-q+X&32767,st=rt-_[rt]&32767;st>et&&(et=st,j=rt)}}}q+=(V=j)-(j=_[V])&32767}if(Q){k[$++]=268435456|u[W]<<18|f[Q];var ot=31&u[W],it=31&f[Q];D+=a[ot]+l[it],++O[257+ot],++P[it],z=L+W,++I}else k[$++]=t[L],++O[t[L]]}}for(L=Math.max(L,z);L<d;++L)k[$++]=t[L],++O[t[L]];b=R(t,m,g,k,O,P,D,$,B,L-B,b),g||(c.r=7&b|m[b/8|0]<<3,b-=7,c.h=v,c.p=_,c.i=L,c.w=z)}else{for(L=c.w||0;L<d+g;L+=65535){var nt=L+65535;nt>=d&&(m[b/8|0]=g,nt=d),b=N(m,b+1,t.subarray(L,nt))}c.i=d}return S(p,0,s+E(b)+h)},z=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,s=9;--s;)r=(1&r&&-306674912)^r>>>1;t[e]=r}return t}(),B=function(){var t=-1;return{p:function(e){for(var r=t,s=0;s<e.length;++s)r=z[255&r^e[s]]^r>>>8;t=r},d:function(){return~t}}},H=function(t,e,r,s,i){if(!i&&(i={l:1},e.dictionary)){var n=e.dictionary.subarray(-32768),a=new o(n.length+t.length);a.set(n),a.set(t,n.length),t=a,i.w=n.length}return $(t,null==e.level?6:e.level,null==e.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):20:12+e.mem,r,s,i)},V=function(t,e){var r={};for(var s in t)r[s]=t[s];for(var s in e)r[s]=e[s];return r},j=function(t,e,r){for(var s=t(),o=t.toString(),i=o.slice(o.indexOf("[")+1,o.lastIndexOf("]")).replace(/\s+/g,"").split(","),n=0;n<s.length;++n){var a=s[n],l=i[n];if("function"==typeof a){e+=";"+l+"=";var h=a.toString();if(a.prototype)if(-1!=h.indexOf("[native code]")){var c=h.indexOf(" ",8)+1;e+=h.slice(c,h.indexOf("(",c))}else for(var d in e+=h,a.prototype)e+=";"+l+".prototype."+d+"="+a.prototype[d].toString();else e+=h}else r[l]=a}return e},G=[],X=function(){return[o,i,n,a,l,h,u,f,_,C,v,w,g,M,L,y,A,k,O,P,I,D,N,R,E,S,$,H,q,W]},W=function(t){return postMessage(t,[t.buffer])},Q=function(t,e,r,o,i,n){var a=function(t,e,r,o){if(!G[r]){for(var i="",n={},a=t.length-1,l=0;l<a;++l)i=j(t[l],i,n);G[r]={c:j(t[a],i,n),e:n}}var h=V({},G[r].e);return function(t,e,r,o,i){var n=new Worker(s[e]||(s[e]=URL.createObjectURL(new Blob([t+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return n.onmessage=function(t){var e=t.data,r=e.$e$;if(r){var s=new Error(r[0]);s.code=r[1],s.stack=r[2],i(s,null)}else i(null,e)},n.postMessage(r,o),n}(G[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,h,function(t){var e=[];for(var r in t)t[r].buffer&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e}(h),o)}(r,o,i,(function(t,e){a.terminate(),n(t,e)}));return a.postMessage([t,e],e.consume?[t.buffer]:[]),function(){a.terminate()}},U=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8};function q(t,e){return H(t,e||{},0,0)}var J=function(t,e,r,s){for(var i in t){var n=t[i],a=e+i,l=s;Array.isArray(n)&&(l=V(s,n[1]),n=n[0]),n instanceof o?r[a]=[n,l]:(r[a+="/"]=[new o(0),l],J(n,a,r,s))}},K="undefined"!=typeof TextEncoder&&new TextEncoder,Y="undefined"!=typeof TextDecoder&&new TextDecoder;try{Y.decode(L,{stream:!0})}catch(t){}function Z(t,e){if(e){for(var r=new o(t.length),s=0;s<t.length;++s)r[s]=t.charCodeAt(s);return r}if(K)return K.encode(t);var i=t.length,n=new o(t.length+(t.length>>1)),a=0,l=function(t){n[a++]=t};for(s=0;s<i;++s){if(a+5>n.length){var h=new o(a+8+(i-s<<1));h.set(n),n=h}var c=t.charCodeAt(s);c<128||e?l(c):c<2048?(l(192|c>>6),l(128|63&c)):c>55295&&c<57344?(l(240|(c=65536+(1047552&c)|1023&t.charCodeAt(++s))>>18),l(128|c>>12&63),l(128|c>>6&63),l(128|63&c)):(l(224|c>>12),l(128|c>>6&63),l(128|63&c))}return S(n,0,a)}var tt=function(t){var e=0;if(t)for(var r in t){var s=t[r].length;s>65535&&F(9),e+=s+4}return e},et=function(t,e,r,s,o,i,n,a){var l=s.length,h=r.extra,c=a&&a.length,d=tt(h);U(t,e,null!=n?33639248:67324752),e+=4,null!=n&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(i<0&&8),t[e++]=o&&8,t[e++]=255&r.compression,t[e++]=r.compression>>8;var p=new Date(null==r.mtime?Date.now():r.mtime),u=p.getFullYear()-1980;if((u<0||u>119)&&F(10),U(t,e,u<<25|p.getMonth()+1<<21|p.getDate()<<16|p.getHours()<<11|p.getMinutes()<<5|p.getSeconds()>>1),e+=4,-1!=i&&(U(t,e,r.crc),U(t,e+4,i<0?-i-2:i),U(t,e+8,r.size)),U(t,e+12,l),U(t,e+14,d),e+=16,null!=n&&(U(t,e,c),U(t,e+6,r.attrs),U(t,e+10,n),e+=14),t.set(s,e),e+=l,d)for(var m in h){var f=h[m],g=f.length;U(t,e,+m),U(t,e+2,g),t.set(f,e+4),e+=4+g}return c&&(t.set(a,e),e+=c),e},rt=function(t,e,r,s,o){U(t,e,101010256),U(t,e+8,r),U(t,e+10,r),U(t,e+12,s),U(t,e+16,o)};var st="function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout?setTimeout:function(t){t()},ot=Object.defineProperty,it=(t,e,r)=>((t,e,r)=>e in t?ot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r);function nt(t){const e=typeof t;return null!=t&&("object"===e||"function"===e)}function at(t){if("object"!=typeof t||null===t||"[object Object]"!==Object.prototype.toString.call(t))return!1;const e=Object.getPrototypeOf(t);if(null===e)return!0;const r=Object.prototype.hasOwnProperty.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(t)}function lt(t){return null!=t&&"string"==typeof t.valueOf()}const ht={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ct=t=>("string"!=typeof t&&(t=`${t}`),t.replace(/[&<>"']/g,(t=>ht[t])));class dt{constructor(t,e){it(this,"documentElement"),this.documentElement=this.createElement(e),this.documentElement.setAttribute("xmlns",t)}createElement(t){return new ut({nodeName:t})}createTextNode(t){return new pt(t)}toString(){return this.documentElement.toString()}}it(dt,"Node",{Create:t=>{switch(t.type){case"XML":return new ut(t);case"TEXT":return new pt(t.nodeValue);default:return null}}});class pt{constructor(t){it(this,"nodeValue"),this.nodeValue=t}toJSON(){return{nodeValue:this.nodeValue,type:"TEXT"}}toString(){return ct(this.nodeValue)}}class ut{constructor(t){if(it(this,"nodeName",""),it(this,"children"),it(this,"nodeValue"),it(this,"attributes"),it(this,"firstChild"),this.nodeName=t.nodeName,this.children=[],this.nodeValue=t.nodeValue||"",this.attributes={},t.children)for(let e=0,r=t.children.length;e<r;e++)this.appendChild(dt.Node.Create(t.children[e]));if(t.attributes)for(const e in t.attributes)t.attributes.hasOwnProperty(e)&&this.setAttribute(e,t.attributes[e])}toString(){let t=`<${this.nodeName}`;for(const e in this.attributes)this.attributes.hasOwnProperty(e)&&(t=`${t} ${e}="${ct(this.attributes[e])}"`);let e="";for(let t=0,r=this.children.length;t<r;t++)e+=this.children[t].toString();return t+=e?`>${e}</${this.nodeName}>`:"/>",t}toJSON(){const t=[];for(let e=0,r=this.children.length;e<r;e++)t.push(this.children[e].toJSON());return{nodeName:this.nodeName,children:t,nodeValue:this.nodeValue,attributes:this.attributes,type:"XML"}}setAttribute(t,e){if(null===e)return delete this.attributes[t],void delete this[t];this.attributes[t]=e,this[t]=e}appendChild(t){this.children.push(t),this.firstChild=this.children[0]}cloneNode(t){return new ut(this.toJSON())}}const mt=class t{static uniqueId(e){return t._idSpaces[e]||(t._idSpaces[e]=1),t._idSpaces[e]++}static createXmlDoc(t,e){return new dt(t||null,e)}static createElement(t,e,r){const s=t.createElement(e);let o=(r=r||[]).length;for(;o--;)s.setAttribute(r[o][0],r[o][1]);return s}static setAttributesOnDoc(t,e){for(let[r,s]of Object.entries(e))at(s)&&(null!==s.v&&void 0!==s.v?s.type===Boolean&&(s=s.v?"1":"0"):s=null),null!=s&&t.setAttribute(r,s)}static positionToLetterRef(e,r){let s,o=1,i=e,n="";if(t.LETTER_REFS[e])return t.LETTER_REFS[e].concat(r);for(;i>0;)i-=Math.pow(26,o-1),s=i%Math.pow(26,o),i-=s,s/=Math.pow(26,o-1),n="ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(s)+n,o+=1;return t.LETTER_REFS[e]=n,n.concat(String(r))}};it(mt,"_idSpaces",{}),it(mt,"LETTER_REFS",{}),it(mt,"schemas",{worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"});let ft=mt;const gt={};function bt(t="$lodash$"){gt[t]||(gt[t]=0);const e=++gt[t];return"$lodash$"===t?`${e}`:`${t}${e}`}const xt={};class yt{constructor(){it(this,"relations",{}),it(this,"lastId",1),bt("rId")}importData(t){this.relations=t.relations,this.lastId=t.lastId}exportData(){return{relations:this.relations,lastId:this.lastId}}addRelation(t,e){return this.relations[t.id]={id:bt("rId"),schema:ft.schemas[e],object:t},this.relations[t.id].id}getRelationshipId(t){return this.relations[t.id]?this.relations[t.id].id:null}toXML(){const t=ft.createXmlDoc(ft.schemas.relationshipPackage,"Relationships"),e=t.documentElement;for(const[r,s]of Object.entries(this.relations)){const o=ft.createElement(t,"Relationship",[["Id",s.id],["Type",s.schema],["Target",s.object.target||xt[r]]]);s.object.targetMode&&o.setAttribute("TargetMode",s.object.targetMode),e.appendChild(o)}return t}}class Ct{constructor(){it(this,"state",null),it(this,"xSplit",null),it(this,"ySplit",null),it(this,"activePane","bottomRight"),it(this,"topLeftCell",null),it(this,"_freezePane")}freezePane(t,e,r){this._freezePane={xSplit:t,ySplit:e,cell:r}}exportXML(t){const e=t.createElement("pane");return null!==this.state&&(e.setAttribute("xSplit",this._freezePane.xSplit),e.setAttribute("ySplit",this._freezePane.ySplit),e.setAttribute("topLeftCell",this._freezePane.cell),e.setAttribute("activePane","bottomRight"),e.setAttribute("state","frozen")),e}}class wt{constructor(){it(this,"strings",{}),it(this,"stringArray",[]),it(this,"id",bt("SharedStrings"))}addString(t){return this.strings[t]=this.stringArray.length,this.stringArray[this.stringArray.length]=t,this.strings[t]}exportData(){return this.strings}toXML(){const t=ft.createXmlDoc(ft.schemas.spreadsheetml,"sst"),e=t.documentElement;this.stringArray.reverse();let r=this.stringArray.length;e.setAttribute("count",r),e.setAttribute("uniqueCount",r);const s=t.createElement("si"),o=t.createElement("t");o.appendChild(t.createTextNode("--placeholder--")),s.appendChild(o);const i=this.stringArray;for(;r--;){const t=s.cloneNode(!0);"string"==typeof i[r]&&i[r].match(/\s+/)&&t.firstChild.setAttribute("xml:space","preserve"),t.firstChild.firstChild.nodeValue=i[r],e.appendChild(t)}return t}}class _t{constructor(t){it(this,"pane"),it(this,"showZeros",null),it(this,"defaultGridColor",null),it(this,"colorId",null),it(this,"rightToLeft",null),it(this,"showFormulas",null),it(this,"showGridLines",null),it(this,"showOutlineSymbols",null),it(this,"showRowColHeaders",null),it(this,"showRuler",null),it(this,"showWhiteSpace",null),it(this,"tabSelected",null),it(this,"topLeftCell",null),it(this,"viewType",null),it(this,"windowProtection",null),it(this,"zoomScale",null),it(this,"zoomScaleNormal",null),it(this,"zoomScalePageLayoutView",null),it(this,"zoomScaleSheetLayoutView",null);const e=t||{};this.pane=e.pane||new Ct}freezePane(t,e,r){this.pane.state="frozen",this.pane.xSplit=t,this.pane.ySplit=e,this.pane.topLeftCell=r}exportXML(t){const e=t.createElement("sheetViews"),r=t.createElement("sheetView");return ft.setAttributesOnDoc(r,{workbookViewId:0,showZeros:{v:this.showZeros,type:Boolean},defaultGridColor:{v:this.defaultGridColor,type:Boolean},colorId:this.colorId,rightToLeft:{v:this.rightToLeft,type:Boolean},showFormulas:{v:this.showFormulas,type:Boolean},showGridLines:{v:this.showGridLines,type:Boolean},showOutlineSymbols:{v:this.showOutlineSymbols,type:Boolean},showRowColHeaders:{v:this.showRowColHeaders,type:Boolean},showRuler:{v:this.showRuler,type:Boolean},showWhiteSpace:{v:this.showWhiteSpace,type:Boolean},tabSelected:{v:this.tabSelected,type:Boolean},viewType:this.viewType,windowProtection:{v:this.windowProtection,type:Boolean},zoomScale:{v:this.zoomScale,type:Boolean},zoomScaleNormal:this.zoomScaleNormal,zoomScalePageLayoutView:this.zoomScalePageLayoutView,zoomScaleSheetLayoutView:this.zoomScaleSheetLayoutView}),r.appendChild(this.pane.exportXML(t)),e.appendChild(r),e}}class vt{constructor(){it(this,"id",bt("StyleSheet")),it(this,"cellStyles",[{name:"Normal",xfId:"0",builtinId:"0"}]),it(this,"defaultTableStyle",!1),it(this,"differentialStyles",[{}]),it(this,"masterCellFormats",[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfid:0}]),it(this,"masterCellStyles",[{numFmtId:0,fontId:0,fillId:0,borderId:0}]),it(this,"fonts",[{}]),it(this,"numberFormatters",[]),it(this,"fills",[{},{type:"pattern",patternType:"gray125",fgColor:"FF333333",bgColor:"FF333333"}]),it(this,"borders",[{top:{},left:{},right:{},bottom:{},diagonal:{}}]),it(this,"tableStyles",[])}createSimpleFormatter(t){const e={id:this.masterCellFormats.length};return"date"===t&&(e.numFmtId=14),this.masterCellFormats.push(e),e}createFill(t){const e=this.fills.length,r=t;return r.id=e,this.fills.push(r),r}createNumberFormatter(t){const e={id:this.numberFormatters.length+100,formatCode:t};return this.numberFormatters.push(e),e}createFormat(t){const e={id:this.masterCellFormats.length};if(t.protection&&(e.protection=t.protection),t.font&&nt(t.font))e.fontId=this.createFontStyle(t.font).id;else if(t.font){if(Number.isNaN(Number.parseInt(t.font,10)))throw new Error("Passing a non-numeric font id is not supported");e.fontId=t.font}if(t.format&&lt(t.format))e.numFmtId=this.createNumberFormatter(t.format).id;else if(t.format){if(Number.isNaN(Number.parseInt(t.format,10)))throw new Error("Invalid number formatter id");e.numFmtId=t.format}if(t.border&&nt(t.border))e.borderId=this.createBorderFormatter(t.border).id;else if(t.border){if(Number.isNaN(Number.parseInt(t.border,10)))throw new Error("Passing a non-numeric border id is not supported");e.borderId=t.border}if(t.fill&&nt(t.fill))e.fillId=this.createFill(t.fill).id;else if(t.fill){if(Number.isNaN(Number.parseInt(t.fill,10)))throw new Error("Passing a non-numeric fill id is not supported");e.fillId=t.fill}return t.alignment&&nt(t.alignment)&&(e.alignment=(r=t.alignment,["horizontal","justifyLastLine","readingOrder","relativeIndent","shrinkToFit","textRotation","vertical","wrapText"].reduce(((t,e)=>(null!=r&&r.hasOwnProperty(e)&&(t[e]=r[e]),t)),{}))),this.masterCellFormats.push(e),e;var r}createDifferentialStyle(t){const e=this.differentialStyles.length,r={id:e};return t.font&&nt(t.font)&&(r.font=t.font),t.border&&nt(t.border)&&(r.border=Object.assign({top:{},left:{},right:{},bottom:{},diagonal:{}},t.border)),t.fill&&nt(t.fill)&&(r.fill=t.fill),t.alignment&&nt(t.alignment)&&(r.alignment=t.alignment),t.format&&lt(t.format)&&(r.numFmt=t.format),this.differentialStyles[e]=r,r}createTableStyle(t){this.tableStyles.push(t)}createBorderFormatter(t){return t={top:{},left:{},right:{},bottom:{},diagonal:{},id:this.borders.length,...t},this.borders.push(t),t}createFontStyle(t){const e={id:this.fonts.length};return t.bold&&(e.bold=!0),t.italic&&(e.italic=!0),t.superscript&&(e.vertAlign="superscript"),t.subscript&&(e.vertAlign="subscript"),t.underline&&("string"==typeof t.underline&&["double","singleAccounting","doubleAccounting"].includes(t.underline)?e.underline=t.underline:e.underline=!0),t.strike&&(e.strike=!0),t.outline&&(e.outline=!0),t.shadow&&(e.shadow=!0),t.size&&(e.size=t.size),t.color&&(e.color=t.color),t.fontName&&(e.fontName=t.fontName),this.fonts.push(e),e}exportBorders(t){const e=t.createElement("borders");e.setAttribute("count",this.borders.length);for(let r=0,s=this.borders.length;r<s;r++)e.appendChild(this.exportBorder(t,this.borders[r]));return e}exportBorder(t,e){const r=t.createElement("border"),s=r=>{const s=t.createElement(r);return e[r].style&&s.setAttribute("style",e[r].style),e[r].color&&s.appendChild(this.exportColor(t,e[r].color)),s};return r.appendChild(s("left")),r.appendChild(s("right")),r.appendChild(s("top")),r.appendChild(s("bottom")),r.appendChild(s("diagonal")),r}exportColor(t,e){const r=t.createElement("color");return lt(e)?(r.setAttribute("rgb",e),r):(void 0!==e.tint&&r.setAttribute("tint",e.tint),void 0!==e.auto&&r.setAttribute("auto",String(!!e.auto)),void 0!==e.theme&&r.setAttribute("theme",e.theme),r)}exportMasterCellFormats(t){const e=ft.createElement(t,"cellXfs",[["count",this.masterCellFormats.length]]);for(let r=0,s=this.masterCellFormats.length;r<s;r++){const s=this.masterCellFormats[r];e.appendChild(this.exportCellFormatElement(t,s))}return e}exportMasterCellStyles(t){const e=ft.createElement(t,"cellStyleXfs",[["count",this.masterCellStyles.length]]);for(let r=0,s=this.masterCellStyles.length;r<s;r++){const s=this.masterCellStyles[r];e.appendChild(this.exportCellFormatElement(t,s))}return e}exportCellFormatElement(t,e){const r=t.createElement("xf"),s=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","xfId"],o=Object.keys(e).filter((t=>-1!==s.indexOf(t)));if(e.alignment){const s=e.alignment;r.appendChild(this.exportAlignment(t,s))}e.protection&&(r.appendChild(this.exportProtection(t,e.protection)),r.setAttribute("applyProtection","1"));let i=o.length;for(;i--;)r.setAttribute(o[i],e[o[i]]);return e.fillId&&r.setAttribute("applyFill","1"),e.fontId&&r.setAttribute("applyFont","1"),e.borderId&&r.setAttribute("applyBorder","1"),e.alignment&&r.setAttribute("applyAlignment","1"),e.numFmtId&&r.setAttribute("applyNumberFormat","1"),void 0!==e.numFmtId&&void 0===e.xfId&&r.setAttribute("xfId","0"),r}exportAlignment(t,e){const r=t.createElement("alignment"),s=Object.keys(e);for(let t=0,o=s.length;t<o;t++)r.setAttribute(s[t],e[s[t]]);return r}exportFonts(t){const e=t.createElement("fonts");e.setAttribute("count",String(this.fonts.length));for(let r=0,s=this.fonts.length;r<s;r++){const s=this.fonts[r];e.appendChild(this.exportFont(t,s))}return e}exportFont(t,e){const r=t.createElement("font");if(e.size){const s=t.createElement("sz");s.setAttribute("val",e.size),r.appendChild(s)}if(e.fontName){const s=t.createElement("name");s.setAttribute("val",e.fontName),r.appendChild(s)}if(e.bold&&r.appendChild(t.createElement("b")),e.italic&&r.appendChild(t.createElement("i")),e.vertAlign){const s=t.createElement("vertAlign");s.setAttribute("val",e.vertAlign),r.appendChild(s)}if(e.underline){const s=t.createElement("u");!0!==e.underline&&s.setAttribute("val",e.underline),r.appendChild(s)}return e.strike&&r.appendChild(t.createElement("strike")),e.shadow&&r.appendChild(t.createElement("shadow")),e.outline&&r.appendChild(t.createElement("outline")),e.color&&r.appendChild(this.exportColor(t,e.color)),r}exportFills(t){const e=t.createElement("fills");e.setAttribute("count",String(this.fills.length));for(let r=0,s=this.fills.length;r<s;r++){const s=this.fills[r];e.appendChild(this.exportFill(t,s))}return e}exportFill(t,e){let r;const s=t.createElement("fill");return"pattern"===e.type?(r=this.exportPatternFill(t,e),s.appendChild(r)):"gradient"===e.type&&(r=this.exportGradientFill(t,e),s.appendChild(r)),s}exportGradientFill(t,e){const r=t.createElement("gradientFill");e.degree?r.setAttribute("degree",e.degree):e.left&&(r.setAttribute("left",e.left),r.setAttribute("right",e.right),r.setAttribute("top",e.top),r.setAttribute("bottom",e.bottom));const s=t.createElement("stop");s.setAttribute("position",e.start.pureAt||0);const o=t.createElement("color");"string"==typeof e.start||e.start.color?o.setAttribute("rgb",e.start.color||e.start):e.start.theme&&o.setAttribute("theme",e.start.theme);const i=t.createElement("stop"),n=t.createElement("color");return i.setAttribute("position",e.end.pureAt||1),"string"==typeof e.start||e.end.color?n.setAttribute("rgb",e.end.color||e.end):e.end.theme&&n.setAttribute("theme",e.end.theme),s.appendChild(o),i.appendChild(n),r.appendChild(s),r.appendChild(i),r}exportPatternFill(t,e){const r=ft.createElement(t,"patternFill",[["patternType",e.patternType]]);e.bgColor||(e.bgColor="FFFFFFFF"),e.fgColor||(e.fgColor="FFFFFFFF");const s=t.createElement("bgColor");lt(e.bgColor)?s.setAttribute("rgb",e.bgColor):e.bgColor.theme?s.setAttribute("theme",e.bgColor.theme):s.setAttribute("rgb",e.bgColor.rbg);const o=t.createElement("fgColor");return lt(e.fgColor)?o.setAttribute("rgb",e.fgColor):e.fgColor.theme?o.setAttribute("theme",e.fgColor.theme):o.setAttribute("rgb",e.fgColor.rbg),r.appendChild(o),r.appendChild(s),r}exportNumberFormatters(t){const e=t.createElement("numFmts");e.setAttribute("count",String(this.numberFormatters.length));for(let r=0,s=this.numberFormatters.length;r<s;r++){const s=this.numberFormatters[r];e.appendChild(this.exportNumberFormatter(t,s))}return e}exportNumberFormatter(t,e){const r=t.createElement("numFmt");return r.setAttribute("numFmtId",e.id),r.setAttribute("formatCode",e.formatCode),r}exportCellStyles(t){const e=t.createElement("cellStyles");e.setAttribute("count",String(this.cellStyles.length));for(let r=0,s=this.cellStyles.length;r<s;r++){const s=this.cellStyles[r];delete s.id;const o=ft.createElement(t,"cellStyle");e.appendChild(o);const i=Object.keys(s);let n=i.length;for(;n--;)o.setAttribute(i[n],s[i[n]])}return e}exportDifferentialStyles(t){const e=t.createElement("dxfs");e.setAttribute("count",String(this.differentialStyles.length));for(let r=0,s=this.differentialStyles.length;r<s;r++){const s=this.differentialStyles[r];e.appendChild(this.exportDFX(t,s))}return e}exportDFX(t,e){const r=t.createElement("dxf");return e.font&&r.appendChild(this.exportFont(t,e.font)),e.fill&&r.appendChild(this.exportFill(t,e.fill)),e.border&&r.appendChild(this.exportBorder(t,e.border)),e.numFmt&&r.appendChild(this.exportNumberFormatter(t,e.numFmt)),e.alignment&&r.appendChild(this.exportAlignment(t,e.alignment)),r}exportTableStyles(t){const e=t.createElement("tableStyles");e.setAttribute("count",String(this.tableStyles.length)),this.defaultTableStyle&&e.setAttribute("defaultTableStyle",String(this.defaultTableStyle));for(let r=0,s=this.tableStyles.length;r<s;r++)e.appendChild(this.exportTableStyle(t,this.tableStyles[r]));return e}exportTableStyle(t,e){const r=t.createElement("tableStyle");r.setAttribute("name",e.name),r.setAttribute("pivot",String(0));let s=0;return Object.entries(e).forEach((([e,o])=>{if("name"===e)return;s++;const i=t.createElement("tableStyleElement");i.setAttribute("type",e),i.setAttribute("dxfId",o),r.appendChild(i)})),r.setAttribute("count",String(s)),r}exportProtection(t,e){const r=t.createElement("protection");for(const t in e)t in e&&r.setAttribute(t,e[t]);return r}toXML(){const t=ft.createXmlDoc(ft.schemas.spreadsheetml,"styleSheet"),e=t.documentElement;return e.appendChild(this.exportNumberFormatters(t)),e.appendChild(this.exportFonts(t)),e.appendChild(this.exportFills(t)),e.appendChild(this.exportBorders(t)),e.appendChild(this.exportMasterCellStyles(t)),e.appendChild(this.exportMasterCellFormats(t)),e.appendChild(this.exportCellStyles(t)),e.appendChild(this.exportDifferentialStyles(t)),this.tableStyles.length&&e.appendChild(this.exportTableStyles(t)),t}}class Et{constructor(t){it(this,"name",""),it(this,"id",bt("Worksheet")),it(this,"_timezoneOffset"),it(this,"relations",null),it(this,"columnFormats",[]),it(this,"data",[]),it(this,"mergedCells",[]),it(this,"columns",[]),it(this,"sheetProtection",!1),it(this,"_headers",[]),it(this,"_footers",[]),it(this,"_tables",[]),it(this,"_drawings",[]),it(this,"_orientation"),it(this,"_margin"),it(this,"_rowInstructions",{}),it(this,"_freezePane",{}),it(this,"sharedStrings",null),it(this,"hyperlinks",[]),it(this,"sheetView"),it(this,"showZeros",null),this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,this.sheetView=t.sheetView||new _t,this.initialize(t)}initialize(t){t=t||{},this.name=t.name,this.id=bt("Worksheet"),this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,t.columns&&this.setColumns(t.columns),this.relations=new yt}exportData(){return{relations:this.relations.exportData(),columnFormats:this.columnFormats,data:this.data,columns:this.columns,mergedCells:this.mergedCells,_headers:this._headers,_footers:this._footers,_tables:this._tables,_rowInstructions:this._rowInstructions,_freezePane:this._freezePane,name:this.name,id:this.id}}importData(t){this.relations.importData(t.relations),delete t.relations,Object.assign(this,t)}setSharedStringCollection(t){this.sharedStrings=t}addTable(t){this._tables.push(t),this.relations.addRelation(t,"table")}addDrawings(t){this._drawings.push(t),this.relations.addRelation(t,"drawingRelationship")}setRowInstructions(t,e){this._rowInstructions[t]=e}setHeader(t){if(!Array.isArray(t))throw"Invalid argument type - setHeader expects an array of three instructions";this._headers=t}setFooter(t){if(!Array.isArray(t))throw"Invalid argument type - setFooter expects an array of three instructions";this._footers=t}compilePageDetailPackage(t){return t=t||"",["&L",this.compilePageDetailPiece(t[0]||""),"&C",this.compilePageDetailPiece(t[1]||""),"&R",this.compilePageDetailPiece(t[2]||"")].join("")}compilePageDetailPiece(t){if(lt(t))return'&"-,Regular"'.concat(t);if(nt(t)&&!Array.isArray(t)){let e="";if(t.font||t.bold){const r=t.bold?"Bold":"Regular";e+=`&"${t.font||"-"}`,e+=`,${r}"`}else e+='&"-,Regular"';return t.underline&&(e+="&U"),t.fontSize&&(e+=`&${t.fontSize}`),e+=t.text,e}return Array.isArray(t)?t.reduce(((t,e)=>t.concat(this.compilePageDetailPiece(e))),""):void 0}exportHeader(t){const e=t.createElement("oddHeader");return e.appendChild(t.createTextNode(this.compilePageDetailPackage(this._headers))),e}exportFooter(t){const e=t.createElement("oddFooter");return e.appendChild(t.createTextNode(this.compilePageDetailPackage(this._footers))),e}_buildCache(t){const e=t.createElement("c"),r=t.createElement("v");r.appendChild(t.createTextNode("--temp--")),e.appendChild(r);const s=t.createElement("c"),o=t.createElement("f");o.appendChild(t.createTextNode("--temp--")),s.appendChild(o);const i=t.createElement("c");i.setAttribute("t","s");const n=t.createElement("v");return n.appendChild(t.createTextNode("--temp--")),i.appendChild(n),{number:e,date:e,string:i,formula:s}}collectSharedStrings(){const t=this.data,e={};for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.length;for(let t=0;t<o;t++){let r=s[t];const o=(null==r?void 0:r.metadata)||{};r&&"object"==typeof r&&(r=r.value),o.type||"number"==typeof r&&(o.type="number"),("text"===o.type||!o.type)&&typeof e[r]>"u"&&(e[r]=!0)}}return Object.keys(e)}toXML(){var t,e,r;const s=this.data,o=this.columns||[],i=ft.createXmlDoc(ft.schemas.spreadsheetml,"worksheet"),n=i.documentElement;let a,l,h;n.setAttribute("xmlns:r",ft.schemas.relationships),n.setAttribute("xmlns:mc",ft.schemas.markupCompat);let c=0;const d=ft.createElement(i,"sheetData"),p=this._buildCache(i);for(h=0,l=s.length;h<l;h++){const n=s[h],a=n.length;c=a>c?a:c;const l=i.createElement("row");for(let s=0;s<a;s++){o[s]=o[s]||{};let i,a=n[s];const c=(null==a?void 0:a.metadata)||{};switch(a&&"object"==typeof a&&(a=a.value),c.type||"number"==typeof a&&(c.type="number"),c.type){case"number":i=p.number.cloneNode(!0),i.firstChild.firstChild.nodeValue=a;break;case"date":i=p.date.cloneNode(!0),a instanceof Date&&(a=a.getTime()),i.firstChild.firstChild.nodeValue=25569+(a-this._timezoneOffset)/864e5;break;case"formula":i=p.formula.cloneNode(!0),i.firstChild.firstChild.nodeValue=a;break;default:{let r;r=typeof(null==(t=this.sharedStrings)?void 0:t.strings[a])<"u"?this.sharedStrings.strings[a]:null==(e=this.sharedStrings)?void 0:e.addString(a),i=p.string.cloneNode(!0),i.firstChild.firstChild.nodeValue=r;break}}c.style?i.setAttribute("s",c.style):void 0!==(null==(r=this._rowInstructions[h])?void 0:r.style)&&i.setAttribute("s",this._rowInstructions[h].style),i.setAttribute("r",ft.positionToLetterRef(s+1,String(h+1))),l.appendChild(i)}if(l.setAttribute("r",h+1),this._rowInstructions[h]){const t=this._rowInstructions[h];void 0!==t.height&&(l.setAttribute("customHeight","1"),l.setAttribute("ht",t.height)),void 0!==t.style&&(l.setAttribute("customFormat","1"),l.setAttribute("s",t.style))}d.appendChild(l)}if(0!==c?n.appendChild(ft.createElement(i,"dimension",[["ref",`${ft.positionToLetterRef(1,1)}:${ft.positionToLetterRef(c,String(s.length))}`]])):n.appendChild(ft.createElement(i,"dimension",[["ref",ft.positionToLetterRef(1,1)]])),n.appendChild(this.sheetView.exportXML(i)),this.columns.length&&n.appendChild(this.exportColumns(i)),n.appendChild(d),this.sheetProtection&&n.appendChild(this.sheetProtection.exportXML(i)),this.hyperlinks.length>0){const t=i.createElement("hyperlinks"),e=this.hyperlinks;for(a=0,l=e.length;a<l;a++){const r=i.createElement("hyperlink"),s=e[a];r.setAttribute("ref",String(s.cell)),s.id=ft.uniqueId("hyperlink"),this.relations.addRelation({id:s.id,target:s.location,targetMode:s.targetMode||"External"},"hyperlink"),r.setAttribute("r:id",this.relations.getRelationshipId(s)),t.appendChild(r)}n.appendChild(t)}if(this.mergedCells.length>0){const t=i.createElement("mergeCells");for(a=0,l=this.mergedCells.length;a<l;a++){const e=i.createElement("mergeCell");e.setAttribute("ref",`${this.mergedCells[a][0]}:${this.mergedCells[a][1]}`),t.appendChild(e)}n.appendChild(t)}if(this.exportPageSettings(i,n),this._headers.length>0||this._footers.length>0){const t=i.createElement("headerFooter");this._headers.length>0&&t.appendChild(this.exportHeader(i)),this._footers.length>0&&t.appendChild(this.exportFooter(i)),n.appendChild(t)}for(a=0,l=this._drawings.length;a<l;a++){const t=i.createElement("drawing");t.setAttribute("r:id",this.relations.getRelationshipId(this._drawings[a])),n.appendChild(t)}if(this._tables.length>0){const t=i.createElement("tableParts");for(t.setAttribute("count",this._tables.length),a=0,l=this._tables.length;a<l;a++){const e=i.createElement("tablePart");e.setAttribute("r:id",this.relations.getRelationshipId(this._tables[a])),t.appendChild(e)}n.appendChild(t)}return i}exportColumns(t){const e=ft.createElement(t,"cols");for(let r=0,s=this.columns.length;r<s;r++){const s=this.columns[r],o=ft.createElement(t,"col",[["min",s.min||r+1],["max",s.max||r+1]]);s.hidden&&o.setAttribute("hidden",String(1)),s.bestFit&&o.setAttribute("bestFit",String(1)),(s.customWidth||s.width)&&o.setAttribute("customWidth",String(1)),s.width?o.setAttribute("width",s.width):o.setAttribute("width",String(9.140625)),e.appendChild(o)}return e}exportPageSettings(t,e){if(this._margin){let r=.7;const s=this._margin.left?this._margin.left:r,o=this._margin.right?this._margin.right:r,i=this._margin.top?this._margin.top:r,n=this._margin.bottom?this._margin.bottom:r;r=.3;const a=this._margin.header?this._margin.header:r,l=this._margin.footer?this._margin.footer:r;e.appendChild(ft.createElement(t,"pageMargins",[["top",i],["bottom",n],["left",s],["right",o],["header",a],["footer",l]]))}this._orientation&&e.appendChild(ft.createElement(t,"pageSetup",[["orientation",this._orientation]]))}setPageOrientation(t){this._orientation=t}setPageMargin(t){this._margin=t}setColumns(t){this.columns=t}setData(t){this.data=t}mergeCells(t,e){this.mergedCells.push([t,e])}freezePane(t,e,r){this.sheetView.freezePane(t,e,r)}setColumnFormats(t){this.columnFormats=t}}class St{constructor(){it(this,"id",bt("Workbook")),it(this,"styleSheet",new vt),it(this,"sharedStrings",new wt),it(this,"relations",new yt),it(this,"worksheets",[]),it(this,"tables",[]),it(this,"drawings",[]),it(this,"media",{}),it(this,"printTitles"),this.initialize()}initialize(){this.id=bt("Workbook"),this.styleSheet=new vt,this.sharedStrings=new wt,this.relations=new yt,this.relations.addRelation(this.styleSheet,"stylesheet"),this.relations.addRelation(this.sharedStrings,"sharedStrings")}createWorksheet(t){return t=Object.assign({},{name:"Sheet ".concat(String(this.worksheets.length+1))},t),new Et(t)}getStyleSheet(){return this.styleSheet}addTable(t){this.tables.push(t)}addDrawings(t){this.drawings.push(t)}setPrintTitleTop(t,e){null==this.printTitles&&(this.printTitles={}),null==this.printTitles[t]&&(this.printTitles[t]={}),this.printTitles[t].top=e}setPrintTitleLeft(t,e){null==this.printTitles&&(this.printTitles={}),null==this.printTitles[t]&&(this.printTitles[t]={}),this.printTitles[t].left=String.fromCharCode(64+e)}addMedia(t,e,r,s){const o=e.split("."),i=o[o.length-1];if(!s)switch(i.toLowerCase()){case"jpeg":case"jpg":s="image/jpeg";break;case"png":s="image/png";break;case"gif":s="image/gif";break;default:s=null}return this.media[e]||(this.media[e]={id:e,data:r,fileName:e,contentType:s,extension:i}),this.media[e]}addWorksheet(t){this.relations.addRelation(t,"worksheet"),t.setSharedStringCollection(this.sharedStrings),this.worksheets.push(t)}createContentTypes(){const t=ft.createXmlDoc(ft.schemas.contentTypes,"Types"),e=t.documentElement;let r,s;e.appendChild(ft.createElement(t,"Default",[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]])),e.appendChild(ft.createElement(t,"Default",[["Extension","xml"],["ContentType","application/xml"]]));const o={};for(const t in this.media)t in this.media&&(o[this.media[t].extension]=this.media[t].contentType);for(const r in o)r in o&&e.appendChild(ft.createElement(t,"Default",[["Extension",r],["ContentType",o[r]]]));for(e.appendChild(ft.createElement(t,"Override",[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]])),e.appendChild(ft.createElement(t,"Override",[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]])),e.appendChild(ft.createElement(t,"Override",[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]])),r=0,s=this.worksheets.length;r<s;r++)e.appendChild(ft.createElement(t,"Override",[["PartName",`/xl/worksheets/sheet${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]));for(r=0,s=this.tables.length;r<s;r++)e.appendChild(ft.createElement(t,"Override",[["PartName",`/xl/tables/table${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]));for(r=0,s=this.drawings.length;r<s;r++)e.appendChild(ft.createElement(t,"Override",[["PartName",`/xl/drawings/drawing${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]));return t}toXML(){const t=ft.createXmlDoc(ft.schemas.spreadsheetml,"workbook"),e=t.documentElement;e.setAttribute("xmlns:r",ft.schemas.relationships);const r=ft.createElement(t,"sheets");for(let e=0,s=this.worksheets.length;e<s;e++){const s=t.createElement("sheet");typeof console<"u"&&this.worksheets[e].name.length>31&&console.log(`Microsoft Excel requires work sheet names to be less than 32 characters long, work sheet name "${this.worksheets[e].name}" is ${this.worksheets[e].name.length} characters long`),s.setAttribute("name",this.worksheets[e].name),s.setAttribute("sheetId",e+1),s.setAttribute("r:id",this.relations.getRelationshipId(this.worksheets[e])),r.appendChild(s)}e.appendChild(r);const s=ft.createElement(t,"definedNames");let o=0;for(const e in this.printTitles)if(e in this.printTitles){const r=this.printTitles[e],i=t.createElement("definedName");i.setAttribute("name","_xlnm.Print_Titles"),i.setAttribute("localSheetId",o++);let n="";r.top&&(n+=`${e}!$1:$${r.top}`,r.left&&(n+=",")),r.left&&(n+=`${e}!$A:$${r.left}`),i.appendChild(t.createTextNode(n)),s.appendChild(i)}return e.appendChild(s),t}createWorkbookRelationship(){const t=ft.createXmlDoc(ft.schemas.relationshipPackage,"Relationships");return t.documentElement.appendChild(ft.createElement(t,"Relationship",[["Id","rId1"],["Type",ft.schemas.officeDocument],["Target","xl/workbook.xml"]])),t}_generateCorePaths(t){let e,r;for(xt[this.styleSheet.id]="styles.xml",xt[this.sharedStrings.id]="sharedStrings.xml",xt[this.id]="/xl/workbook.xml",e=0,r=this.tables.length;e<r;e++)t[`/xl/tables/table${e+1}.xml`]=this.tables[e].toXML(),xt[this.tables[e].id]=`/xl/tables/table${e+1}.xml`;for(const e in this.media)if(e in this.media){const r=this.media[e];t[`/xl/media/${e}`]=r.data,xt[e]=`/xl/media/${e}`}for(e=0,r=this.drawings.length;e<r;e++)t[`/xl/drawings/drawing${e+1}.xml`]=this.drawings[e].toXML(),xt[this.drawings[e].id]=`/xl/drawings/drawing${e+1}.xml`,t[`/xl/drawings/_rels/drawing${e+1}.xml.rels`]=this.drawings[e].relations.toXML()}_prepareFilesForPackaging(t){Object.assign(t,{"/[Content_Types].xml":this.createContentTypes(),"/_rels/.rels":this.createWorkbookRelationship(),"/xl/styles.xml":this.styleSheet.toXML(),"/xl/workbook.xml":this.toXML(),"/xl/sharedStrings.xml":this.sharedStrings.toXML(),"/xl/_rels/workbook.xml.rels":this.relations.toXML()});for(const[e,r]of Object.entries(t))if(-1!==e.indexOf(".xml")||-1!==e.indexOf(".rels")){t[e]=r instanceof dt?r.toString():r.xml||(new window.XMLSerializer).serializeToString(r);let s=t[e].replace(/xmlns=""/g,"");s=s.replace(/NS[\d]+:/g,""),s=s.replace(/xmlns:NS[\d]+=""/g,""),t[e]=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n${s}`}}generateFiles(){return new Promise((t=>{const e={};this._generateCorePaths(e);for(let t=0,r=this.worksheets.length;t<r;t++)e[`/xl/worksheets/sheet${t+1}.xml`]=this.worksheets[t].toXML(),xt[this.worksheets[t].id]=`worksheets/sheet${t+1}.xml`,e[`/xl/worksheets/_rels/sheet${t+1}.xml.rels`]=this.worksheets[t].relations.toXML();return this._prepareFilesForPackaging(e),t(e)}))}}function Tt(t,e,r){if("node"===(null==r?void 0:r.downloadType))throw new Error('[Excel-Builder-Vanilla] Please note that `downloadExcelFile()` is currently only supporting the "browser" download type at the moment.');const s=e.match(/.*\.xls$/)?"xls":"xlsx";return function(t,e,r){const s={};return new Promise(((e,i)=>{t.generateFiles().then((t=>{for(const[e,r]of Object.entries(t))s[e.substr(1)]=Z(r);return function(t,e,r){r||(r=e,e={}),"function"!=typeof r&&F(7);var s={};J(t,"",s,e);var i=Object.keys(s),n=i.length,a=0,l=0,h=n,c=new Array(n),d=[],p=function(){for(var t=0;t<d.length;++t)d[t]()},u=function(t,e){st((function(){r(t,e)}))};st((function(){u=r}));var m=function(){var t=new o(l+22),e=a,r=l-a;l=0;for(var s=0;s<h;++s){var i=c[s];try{var n=i.c.length;et(t,l,i,i.f,i.u,n);var d=30+i.f.length+tt(i.extra),p=l+d;t.set(i.c,p),et(t,a,i,i.f,i.u,n,l,i.m),a+=16+d+(i.m?i.m.length:0),l=p+n}catch(t){return u(t,null)}}rt(t,a,c.length,r,e),u(null,t)};n||m();for(var f=function(t){var e=i[t],r=s[e],o=r[0],h=r[1],f=B(),g=o.length;f.p(o);var b=Z(e),x=b.length,y=h.comment,C=y&&Z(y),w=C&&C.length,_=tt(h.extra),v=0==h.level?0:8,E=function(r,s){if(r)p(),u(r,null);else{var o=s.length;c[t]=V(h,{size:g,crc:f.d(),c:s,f:b,m:C,u:x!=e.length||C&&y.length!=w,compression:v}),a+=30+x+_+o,l+=76+2*(x+_)+(w||0)+o,--n||m()}};if(x>65535&&E(F(11,0,1),null),v)if(g<16e4)try{E(null,q(o,h))}catch(t){E(t,null)}else d.push(function(t,e,r){return r||(r=e,e={}),"function"!=typeof r&&F(7),Q(t,e,[X],(function(t){return W(q(t.data[0],t.data[1]))}),0,r)}(o,h,E));else E(null,o)},g=0;g<h;++g)f(g);return p}(s,(null==r?void 0:r.zipOptions)||{},((t,s)=>{if(t)i(t);else{{const t=(null==r?void 0:r.fileFormat)??"xlsx";let o=null==r?void 0:r.mimeType;void 0===o&&(o="xls"===t?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),e(new Blob([s],{type:o}))}}}))}))}))}(t,0,{...r,fileFormat:s}).then((t=>{!function(t,e){const r=document.createElement("a"),s=URL.createObjectURL(e);r&&document&&(r.textContent="download",r.href=s,r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s))}(e,t)}))}var Ft=r(8755),At=r(1956);const kt=(t,{excelFormatId:e})=>void 0!==e?{value:t,metadata:{style:e}}:t,Ot=(t,{columnDef:e,excelFormatId:r,gridOptions:s})=>({value:"string"==typeof t&&/\d/g.test(t)?Pt(t,e,s):t,metadata:{style:r}});function Pt(t,e,r){let s=t;if("string"==typeof t&&t){const o=","===(0,Ft.Nv7)("decimalSeparator",e,r,Ft.YMJ.DEFAULT_NUMBER_DECIMAL_SEPARATOR)?parseFloat(t.replace(/[^0-9,-]+/g,"").replace(",",".")):parseFloat(t.replace(/[^\d.-]/g,""));s=isNaN(o)?t:o}return s}function It(t,e,r,s,o=!0){const i=(0,Ft.lB_)(r);let n,a=kt;return i===Ft.PUO.number&&o&&(n=Rt(t,e,r,s,"cell").excelFormat.id,a=Ot),{excelFormatId:n,getDataValueParser:a}}function Dt(t,e){return t?.[e.groupType]?.[e.columnDef.field]??0}function Nt(t){let e;switch(t){case Ft._tQ.currency:case Ft._tQ.dollar:case Ft._tQ.dollarColored:case Ft._tQ.dollarColoredBold:e="currency";break;case Ft._tQ.percent:case Ft._tQ.percentComplete:case Ft._tQ.percentCompleteBar:case Ft._tQ.percentCompleteBarWithText:case Ft._tQ.percentSymbol:e="percent";break;case Ft._tQ.decimal:default:e="decimal"}return e}function Rt(t,e,r,s,o){let i,n="",a=r.groupTotalsExcelExportOptions?.groupType||"";const l=(0,Ft.lB_)(r);if("group"===o)switch(r.groupTotalsFormatter){case Ft.tao.avgTotals:case Ft.tao.avgTotalsCurrency:case Ft.tao.avgTotalsDollar:case Ft.tao.avgTotalsPercentage:a="avg";break;case Ft.tao.minTotals:a="min";break;case Ft.tao.maxTotals:a="max";break;case Ft.tao.sumTotals:case Ft.tao.sumTotalsBold:case Ft.tao.sumTotalsColored:case Ft.tao.sumTotalsCurrency:case Ft.tao.sumTotalsCurrencyColored:case Ft.tao.sumTotalsDollar:case Ft.tao.sumTotalsDollarColoredBold:case Ft.tao.sumTotalsDollarColored:case Ft.tao.sumTotalsDollarBold:a="sum";break;default:i=e.numberFormat}else if(l===Ft.PUO.number)switch(r.formatter){case Ft._tQ.multiple:if(Array.isArray(r.params?.formatters))for(const n of r.params.formatters){const{excelFormat:a}=Rt(t,e,{...r,formatter:n},s,o);if(a!==e.numberFormat){i=a;break}}i||(i=e.numberFormat);break;case Ft._tQ.currency:case Ft._tQ.decimal:case Ft._tQ.dollar:case Ft._tQ.dollarColored:case Ft._tQ.dollarColoredBold:case Ft._tQ.percent:case Ft._tQ.percentComplete:case Ft._tQ.percentCompleteBar:case Ft._tQ.percentCompleteBarWithText:case Ft._tQ.percentSymbol:n=Lt(r,s,"cell");break;default:i=e.numberFormat}return i||!r.formatter&&!r.groupTotalsFormatter||(n=Lt(r,s,o,a),e.hasOwnProperty(n)||(e[n]=t.createFormat({format:n})),i=e[n]),{excelFormat:i,groupType:a}}function Mt(t){const[e,r,s,o,i,n,a,l]=t?.match(/^([^\d(-]*)([(]?)([^\d]*)([-]?[\w]]?[\d\s]*[.,\d]*[\d]*[^)\s%]?)([^\d.,)]*)([)]?)([^\d]*)$/i)||[],h=(i||"").replace(/1/g,"0").replace(/[2]/g,"#");return[$t(r??""),s??"",$t(o??""),h,$t(n??""),a??"",$t(l??"")].join("").replace(",",",")}function Lt(t,e,r,s=""){let o="",i="",n="";const{minDecimal:a,maxDecimal:l,thousandSeparator:h}=function(t,e,r){let s;if("group"===r)switch(t.groupTotalsFormatter){case Ft.tao.avgTotalsCurrency:case Ft.tao.avgTotalsDollar:case Ft.tao.sumTotalsCurrency:case Ft.tao.sumTotalsCurrencyColored:case Ft.tao.sumTotalsDollar:case Ft.tao.sumTotalsDollarBold:case Ft.tao.sumTotalsDollarColored:case Ft.tao.sumTotalsDollarColoredBold:s="currency";break;case Ft.tao.avgTotalsPercentage:s="percent";break;case Ft.tao.avgTotals:case Ft.tao.minTotals:case Ft.tao.maxTotals:case Ft.tao.sumTotals:case Ft.tao.sumTotalsColored:case Ft.tao.sumTotalsBold:default:s="decimal"}else if(t.formatter===Ft._tQ.multiple&&Array.isArray(t.params?.formatters)){s="decimal";for(const e of t.params.formatters)if(s=Nt(e),"decimal"!==s)break}else s=Nt(t.formatter);return(0,Ft.TT_)(t,e,s,r)}(t,e,r),c=parseFloat(`${h?"2220":"0"}.${function(t,e){return zt("1",t)+zt("2",e-t)}(a,l)}`);return"group"===r&&t.groupTotalsFormatter?(i=(0,At.stripTags)(t.groupTotalsFormatter({[s]:{[t.field]:c}},t,e)),n=(0,At.stripTags)(t.groupTotalsFormatter({[s]:{[t.field]:-c}},t,e))):t.formatter&&(i=(0,At.stripTags)(t.formatter(0,0,c,t,{},e)),n=(0,At.stripTags)(t.formatter(0,0,-c,t,{},e))),i&&n&&(o=Mt(i)+";"+Mt(n)),o}function $t(t){return t?`"${t}"`:t}function zt(t,e){let r="";for(let s=0;s<e;s++)r+=t;return r}const Bt={filename:"export",format:Ft.ptE.xlsx};class Ht{constructor(){this._fileFormat=Ft.ptE.xlsx,this._columnHeaders=[],this._hasColumnTitlePreHeader=!1,this._hasGroupedItems=!1,this._pubSubService=null,this._regularCellExcelFormats={},this._groupTotalExcelFormats={},this.className="ExcelExportService"}get _datasetIdPropName(){return this._gridOptions?.datasetIdPropertyName??"id"}get _dataView(){return this._grid?.getData()}get _gridOptions(){return this._grid?.getOptions()||{}}get stylesheet(){return this._stylesheet}get stylesheetFormats(){return this._stylesheetFormats}get groupTotalExcelFormats(){return this._groupTotalExcelFormats}get regularCellExcelFormats(){return this._regularCellExcelFormats}dispose(){this._pubSubService?.unsubscribeAll()}init(t,e){if(this._grid=t,this._pubSubService=e.get("PubSubService"),this._locales=this._gridOptions?.locales??Ft.YMJ.locales,this._translaterService=this._gridOptions?.translater,this._gridOptions.enableTranslate&&(!this._translaterService||!this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be passed in the "translater" Grid Options when "enableTranslate" is enabled. (example: this.gridOptions = { enableTranslate: true, translater: this.translaterService })')}exportToExcel(t){if(!this._grid||!this._dataView||!this._pubSubService)throw new Error('[Slickgrid-Universal] it seems that the SlickGrid & DataView objects and/or PubSubService are not initialized did you forget to enable the grid option flag "enableExcelExport"?');return this._pubSubService?.publish("onBeforeExportToExcel",!0),this._excelExportOptions=(0,At.extend)(!0,{},{...Bt,...this._gridOptions.excelExportOptions,...t}),this._fileFormat=this._excelExportOptions.format||Ft.ptE.xlsx,this._regularCellExcelFormats={},this._groupTotalExcelFormats={},new Promise((t=>{const e={name:this._excelExportOptions.sheetName||"Sheet1"};this._workbook=new St,this._sheet=this._workbook.createWorksheet(e),this._stylesheet=this._workbook.getStyleSheet();const r=this._stylesheet.createFormat({font:{bold:!0}}),s=this._stylesheet.createFormat({format:"@"}),o=this._stylesheet.createFormat({format:"0"});this._stylesheetFormats={boldFormat:r,numberFormat:o,stringFormat:s},this._sheet.setColumnFormats([r]);const i=this.getDataOutput();window.setTimeout((async()=>{this._gridOptions?.excelExportOptions?.customExcelHeader&&this._gridOptions.excelExportOptions.customExcelHeader(this._workbook,this._sheet);const e=this._grid?.getColumns()||[];this._sheet.setColumns(this.getColumnStyles(e));const r=this._sheet.data;let s=r;Array.isArray(r)&&Array.isArray(i)&&(s=this._sheet.data.concat(i)),this._sheet.setData(s),this._workbook.addWorksheet(this._sheet);let o=this._excelExportOptions?.mimeType;void 0===o&&(o=this._fileFormat===Ft.ptE.xls?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const n=`${this._excelExportOptions.filename}.${this._fileFormat}`;Tt(this._workbook,n,{mimeType:o}).then((()=>{this._pubSubService?.publish("onAfterExportToExcel",{filename:n,mimeType:o}),t(!0)}))}))}))}getExcelColumnNameByIndex(t){const e="ZABCDEFGHIJKLMNOPQRSTUVWXY";let r=Math.floor(t/26);const s=Math.floor(t%26);return 0===s&&r--,t>26?this.getExcelColumnNameByIndex(r)+e[s]:e[s]+""}getDataOutput(){const t=this._grid?.getColumns()||[],e=[],r=this._gridOptions?.excelExportOptions,s=r?.columnHeaderStyle;let o=this._stylesheetFormats.boldFormat.id;if(s&&(o=this._stylesheet.createFormat(s).id),this._gridOptions.createPreHeaderPanel&&this._gridOptions.showPreHeaderPanel&&!this._gridOptions.enableDraggableGrouping){const r=this._stylesheet.createFormat({alignment:{horizontal:"center"},font:{bold:!0}});e.push(this.getColumnGroupedHeaderTitlesData(t,{style:r?.id})),this._hasColumnTitlePreHeader=!0}return e.push(this.getColumnHeaderData(t,{style:o})),this.pushAllGridRowDataToArray(e,t),e}getColumnStyles(t){const e=this._dataView.getGrouping(),r=[];return Array.isArray(e)&&e.length>0&&r.push({bestFit:!0,columnStyles:this._gridOptions?.excelExportOptions?.customColumnWidth??10}),t.forEach((t=>{const e=t.excludeFromExport??!1;(void 0===t.width||t.width>0)&&!e&&r.push({bestFit:!0,width:t.excelExportOptions?.width??this._gridOptions?.excelExportOptions?.customColumnWidth??10})})),r}getColumnGroupedHeaderTitlesData(t,e){let r=[];this._groupedColumnHeaders=this.getColumnGroupedHeaderTitles(t)||[],this._groupedColumnHeaders&&Array.isArray(this._groupedColumnHeaders)&&this._groupedColumnHeaders.length>0&&(r=this._groupedColumnHeaders.map((t=>({value:t.title,metadata:e}))));let s=0;const o=this._groupedColumnHeaders.length;for(let t=0;t<o;t++)if(t+1===o||t+1<o&&this._groupedColumnHeaders[t].title!==this._groupedColumnHeaders[t+1].title){const e=this.getExcelColumnNameByIndex(s+1),r=this.getExcelColumnNameByIndex(t+1);this._sheet.mergeCells(`${e}1`,`${r}1`),s=t+1}return r}getColumnHeaderData(t,e){let r=[];this._columnHeaders=this.getColumnHeaders(t)||[],this._columnHeaders&&Array.isArray(this._columnHeaders)&&this._columnHeaders.length>0&&(r=this._columnHeaders.map((t=>({value:(0,At.stripTags)(t.title),metadata:e}))));const s=this.getGroupColumnTitle();return s&&r.unshift({value:s,metadata:e}),r}getGroupColumnTitle(){let t=this._excelExportOptions.groupingColumnHeaderTitle;!t&&this._gridOptions.enableTranslate&&this._translaterService?.translate?t=this._translaterService.translate(`${(0,Ft.mVi)(this._gridOptions)}GROUP_BY`):t||(t=this._locales?.TEXT_GROUP_BY);const e=this._dataView.getGrouping();return Array.isArray(e)&&e.length>0?(this._hasGroupedItems=!0,t):(this._hasGroupedItems=!1,null)}getColumnGroupedHeaderTitles(t){const e=[];return Array.isArray(t)&&t.forEach((t=>{let r="";r=t.columnGroupKey&&this._gridOptions.enableTranslate&&this._translaterService?.translate?this._translaterService.translate(t.columnGroupKey):t.columnGroup||"";const s=t.excludeFromExport||!1;(void 0===t.width||t.width>0)&&!s&&e.push({key:t.field||t.id,title:r||""})})),e}getColumnHeaders(t){const e=[];return Array.isArray(t)&&t.forEach((t=>{let r="";r=(t.nameKey||t.nameKey)&&this._gridOptions.enableTranslate&&this._translaterService?.translate?this._translaterService.translate(t.nameKey||t.nameKey):(0,At.getHtmlStringOutput)(t.name||"","innerHTML")||(0,At.titleCase)(t.field);const s=t.excludeFromExport||!1;(void 0===t.width||t.width>0)&&!s&&e.push({key:(t.field||t.id)+"",title:r})})),e}pushAllGridRowDataToArray(t,e){const r=this._dataView.getLength();for(let s=0;s<r;s++){const r=this._dataView.getItem(s);r&&!r.hasOwnProperty("getItem")&&(null!==r[this._datasetIdPropName]&&void 0!==r[this._datasetIdPropName]?t.push(this.readRegularRowData(e,s,r,s)):this._hasGroupedItems&&void 0===r.__groupTotals?t.push([this.readGroupedRowTitle(r)]):r.__groupTotals&&t.push(this.readGroupedTotalRows(e,r,s)))}return t}readRegularRowData(t,e,r,s){let o=0;const i=[],n=t.length;let a=1,l=0;const h=this._dataView.getItemMetadata(e);for(let c=0;c<n;c++){const n=t[c];if(n.excludeFromExport)continue;this._hasGroupedItems&&0===o&&i.push("");let d,p=1;if(h?.columns){const e=h.columns,r=e[n.id]||e[c];!isNaN(a)&&+a>1||"*"===a&&c>0||(a=r?.colspan??1),"*"===a?p=t.length-c:(p=a,n.id in e&&(d=n.id,l=c))}if("*"===a&&c>0||!isNaN(a)&&+a>1&&n.id!==d){const t=e+(this._hasColumnTitlePreHeader?3:2);if("number"==typeof a&&p-1==1){const e=this.getExcelColumnNameByIndex(l+1),r=this.getExcelColumnNameByIndex(c+1);this._sheet.mergeCells(`${e}${t}`,`${r}${t}`),i.push("")}else if("*"===a&&1===p){const e=this.getExcelColumnNameByIndex(c+1);this._sheet.mergeCells(`A${t}`,`${e}${t}`)}else i.push("");"number"==typeof a&&!isNaN(a)&&+a>1&&(p=a--)}else{let t="";const a=(0,Ft.lB_)(n),l={...this._excelExportOptions};if(!1!==n.exportWithFormatter&&(0,Ft.vsW)(a)&&(l.exportWithFormatter=!0),t=(0,Ft.qgn)(e,c,n,r,this._grid,l),!this._regularCellExcelFormats.hasOwnProperty(n.id)){const t=n.excelExportOptions?.autoDetectCellFormat??this._excelExportOptions?.autoDetectCellFormat,e=It(this._stylesheet,this._stylesheetFormats,n,this._grid,t);n.excelExportOptions?.style&&(e.excelFormatId=this._stylesheet.createFormat(n.excelExportOptions.style).id),n.excelExportOptions?.valueParserCallback&&(e.getDataValueParser=n.excelExportOptions.valueParserCallback),this._regularCellExcelFormats[n.id]=e}"string"==typeof t&&(n.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(t=(0,At.stripTags)(t));const{excelFormatId:h,getDataValueParser:d}=this._regularCellExcelFormats[n.id];t=d(t,{columnDef:n,excelFormatId:h,stylesheet:this._stylesheet,gridOptions:this._gridOptions,dataRowIdx:s,dataContext:r}),i.push(t),o++}}return i}readGroupedRowTitle(t){const e=(0,At.stripTags)(t.title);if(this._excelExportOptions?.addGroupIndentation){const r=this._excelExportOptions?.groupCollapsedSymbol||"⮞",s=this._excelExportOptions?.groupExpandedSymbol||"⮟";return(t.collapsed?r:s)+" "+(0,At.addWhiteSpaces)(5*t.level)+e}return e}readGroupedTotalRows(t,e,r){const s=[this._excelExportOptions.groupingAggregatorRowText||""];return t.forEach((t=>{let o="";const i=(0,Ft.lB_)(t),n=t.excludeFromExport||!1;if(t.exportCustomGroupTotalsFormatter){const r=t.exportCustomGroupTotalsFormatter(e,t,this._grid);o=r instanceof HTMLElement?r.textContent||"":r}const a=t.excelExportOptions?.autoDetectCellFormat??this._excelExportOptions?.autoDetectCellFormat;if(i===Ft.PUO.number&&!1!==a){let s=this._groupTotalExcelFormats[t.id];s?.groupType||(s=Rt(this._stylesheet,this._stylesheetFormats,t,this._grid,"group"),t.groupTotalsExcelExportOptions?.style&&(s.excelFormat=this._stylesheet.createFormat(t.groupTotalsExcelExportOptions.style)),this._groupTotalExcelFormats[t.id]=s);const i=t.groupTotalsExcelExportOptions?.valueParserCallback??Dt;if(void 0!==e[s.groupType]?.[t.field]){const n=i(e,{columnDef:t,groupType:s.groupType,excelFormatId:s.excelFormat?.id,stylesheet:this._stylesheet,dataRowIdx:r});o="object"==typeof n&&n.hasOwnProperty("metadata")?n:o={value:n,metadata:{style:s.excelFormat?.id}}}}else if(t.groupTotalsFormatter){const r=t.groupTotalsFormatter(e,t,this._grid);o=r instanceof HTMLElement?r.textContent||"":r}"string"==typeof o&&(t.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(o=(0,At.stripTags)(o)),(void 0===t.width||t.width>0)&&!n&&s.push(o)})),s}}}}]);