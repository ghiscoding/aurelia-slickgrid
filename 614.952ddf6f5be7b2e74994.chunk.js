"use strict";(self.webpackChunkau_slickgrid_demo=self.webpackChunkau_slickgrid_demo||[]).push([[614],{614:(t,e,r)=>{r.d(e,{N:()=>zt});var s={},i=Uint8Array,o=Uint16Array,n=Int32Array,a=new i([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new i([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new i([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(t,e){for(var r=new o(31),s=0;s<31;++s)r[s]=e+=1<<t[s-1];var i=new n(r[30]);for(s=1;s<30;++s)for(var a=r[s];a<r[s+1];++a)i[a]=a-r[s]<<5|s;return{b:r,r:i}},d=c(a,2),p=d.b,u=d.r;p[28]=258,u[258]=28;for(var m=c(l,0),f=(m.b,m.r),g=new o(32768),b=0;b<32768;++b){var x=(43690&b)>>1|(21845&b)<<1;x=(61680&(x=(52428&x)>>2|(13107&x)<<2))>>4|(3855&x)<<4,g[b]=((65280&x)>>8|(255&x)<<8)>>1}var y=function(t,e,r){for(var s=t.length,i=0,n=new o(e);i<s;++i)t[i]&&++n[t[i]-1];var a,l=new o(e);for(i=1;i<e;++i)l[i]=l[i-1]+n[i-1]<<1;if(r){a=new o(1<<e);var h=15-e;for(i=0;i<s;++i)if(t[i])for(var c=i<<4|t[i],d=e-t[i],p=l[t[i]-1]++<<d,u=p|(1<<d)-1;p<=u;++p)a[g[p]>>h]=c}else for(a=new o(s),i=0;i<s;++i)t[i]&&(a[i]=g[l[t[i]-1]++]>>15-t[i]);return a},C=new i(288);for(b=0;b<144;++b)C[b]=8;for(b=144;b<256;++b)C[b]=9;for(b=256;b<280;++b)C[b]=7;for(b=280;b<288;++b)C[b]=8;var w=new i(32);for(b=0;b<32;++b)w[b]=5;var _=y(C,9,0),v=y(w,5,0),E=function(t){return(t+7)/8|0},S=function(t,e,r){return(null==e||e<0)&&(e=0),(null==r||r>t.length)&&(r=t.length),new i(t.subarray(e,r))},T=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(t,e,r){var s=new Error(e||T[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,F),!r)throw s;return s},A=function(t,e,r){r<<=7&e;var s=e/8|0;t[s]|=r,t[s+1]|=r>>8},k=function(t,e,r){r<<=7&e;var s=e/8|0;t[s]|=r,t[s+1]|=r>>8,t[s+2]|=r>>16},O=function(t,e){for(var r=[],s=0;s<t.length;++s)t[s]&&r.push({s,f:t[s]});var n=r.length,a=r.slice();if(!n)return{t:$,l:0};if(1==n){var l=new i(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort((function(t,e){return t.f-e.f})),r.push({s:-1,f:25001});var h=r[0],c=r[1],d=0,p=1,u=2;for(r[0]={s:-1,f:h.f+c.f,l:h,r:c};p!=n-1;)h=r[r[d].f<r[u].f?d++:u++],c=r[d!=p&&r[d].f<r[u].f?d++:u++],r[p++]={s:-1,f:h.f+c.f,l:h,r:c};var m=a[0].s;for(s=1;s<n;++s)a[s].s>m&&(m=a[s].s);var f=new o(m+1),g=P(r[p-1],f,0);if(g>e){s=0;var b=0,x=g-e,y=1<<x;for(a.sort((function(t,e){return f[e.s]-f[t.s]||t.f-e.f}));s<n;++s){var C=a[s].s;if(!(f[C]>e))break;b+=y-(1<<g-f[C]),f[C]=e}for(b>>=x;b>0;){var w=a[s].s;f[w]<e?b-=1<<e-f[w]++-1:++s}for(;s>=0&&b;--s){var _=a[s].s;f[_]==e&&(--f[_],++b)}g=e}return{t:new i(f),l:g}},P=function(t,e,r){return-1==t.s?Math.max(P(t.l,e,r+1),P(t.r,e,r+1)):e[t.s]=r},I=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new o(++e),s=0,i=t[0],n=1,a=function(t){r[s++]=t},l=1;l<=e;++l)if(t[l]==i&&l!=e)++n;else{if(!i&&n>2){for(;n>138;n-=138)a(32754);n>2&&(a(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(a(i),--n;n>6;n-=6)a(8304);n>2&&(a(n-3<<5|8208),n=0)}for(;n--;)a(i);n=1,i=t[l]}return{c:r.subarray(0,s),n:e}},D=function(t,e){for(var r=0,s=0;s<e.length;++s)r+=t[s]*e[s];return r},N=function(t,e,r){var s=r.length,i=E(e+2);t[i]=255&s,t[i+1]=s>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var o=0;o<s;++o)t[i+o+4]=r[o];return 8*(i+4+s)},R=function(t,e,r,s,i,n,c,d,p,u,m){A(e,m++,r),++i[256];for(var f=O(i,15),g=f.t,b=f.l,x=O(n,15),E=x.t,S=x.l,T=I(g),F=T.c,P=T.n,R=I(E),M=R.c,$=R.n,L=new o(19),B=0;B<F.length;++B)++L[31&F[B]];for(B=0;B<M.length;++B)++L[31&M[B]];for(var z=O(L,7),H=z.t,V=z.l,j=19;j>4&&!H[h[j-1]];--j);var G,X,W,Q,U=u+5<<3,q=D(i,C)+D(n,w)+c,J=D(i,g)+D(n,E)+c+14+3*j+D(L,H)+2*L[16]+3*L[17]+7*L[18];if(p>=0&&U<=q&&U<=J)return N(e,m,t.subarray(p,p+u));if(A(e,m,1+(J<q)),m+=2,J<q){G=y(g,b,0),X=g,W=y(E,S,0),Q=E;var K=y(H,V,0);for(A(e,m,P-257),A(e,m+5,$-1),A(e,m+10,j-4),m+=14,B=0;B<j;++B)A(e,m+3*B,H[h[B]]);m+=3*j;for(var Y=[F,M],Z=0;Z<2;++Z){var tt=Y[Z];for(B=0;B<tt.length;++B){var et=31&tt[B];A(e,m,K[et]),m+=H[et],et>15&&(A(e,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else G=_,X=C,W=v,Q=w;for(B=0;B<d;++B){var rt=s[B];if(rt>255){k(e,m,G[257+(et=rt>>18&31)]),m+=X[et+257],et>7&&(A(e,m,rt>>23&31),m+=a[et]);var st=31&rt;k(e,m,W[st]),m+=Q[st],st>3&&(k(e,m,rt>>5&8191),m+=l[st])}else k(e,m,G[rt]),m+=X[rt]}return k(e,m,G[256]),m+X[256]},M=new n([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),$=new i(0),L=function(t,e,r,s,h,c){var d=c.z||t.length,p=new i(s+d+5*(1+Math.ceil(d/7e3))+h),m=p.subarray(s,p.length-h),g=c.l,b=7&(c.r||0);if(e){b&&(m[0]=c.r>>3);for(var x=M[e-1],y=x>>13,C=8191&x,w=(1<<r)-1,_=c.p||new o(32768),v=c.h||new o(w+1),T=Math.ceil(r/3),F=2*T,A=function(e){return(t[e]^t[e+1]<<T^t[e+2]<<F)&w},k=new n(25e3),O=new o(288),P=new o(32),I=0,D=0,$=c.i||0,L=0,B=c.w||0,z=0;$+2<d;++$){var H=A($),V=32767&$,j=v[H];if(_[V]=j,v[H]=V,B<=$){var G=d-$;if((I>7e3||L>24576)&&(G>423||!g)){b=R(t,m,0,k,O,P,D,L,z,$-z,b),L=I=D=0,z=$;for(var X=0;X<286;++X)O[X]=0;for(X=0;X<30;++X)P[X]=0}var W=2,Q=0,U=C,q=V-j&32767;if(G>2&&H==A($-q))for(var J=Math.min(y,G)-1,K=Math.min(32767,$),Y=Math.min(258,G);q<=K&&--U&&V!=j;){if(t[$+W]==t[$+W-q]){for(var Z=0;Z<Y&&t[$+Z]==t[$+Z-q];++Z);if(Z>W){if(W=Z,Q=q,Z>J)break;var tt=Math.min(q,Z-2),et=0;for(X=0;X<tt;++X){var rt=$-q+X&32767,st=rt-_[rt]&32767;st>et&&(et=st,j=rt)}}}q+=(V=j)-(j=_[V])&32767}if(Q){k[L++]=268435456|u[W]<<18|f[Q];var it=31&u[W],ot=31&f[Q];D+=a[it]+l[ot],++O[257+it],++P[ot],B=$+W,++I}else k[L++]=t[$],++O[t[$]]}}for($=Math.max($,B);$<d;++$)k[L++]=t[$],++O[t[$]];b=R(t,m,g,k,O,P,D,L,z,$-z,b),g||(c.r=7&b|m[b/8|0]<<3,b-=7,c.h=v,c.p=_,c.i=$,c.w=B)}else{for($=c.w||0;$<d+g;$+=65535){var nt=$+65535;nt>=d&&(m[b/8|0]=g,nt=d),b=N(m,b+1,t.subarray($,nt))}c.i=d}return S(p,0,s+E(b)+h)},B=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,s=9;--s;)r=(1&r&&-306674912)^r>>>1;t[e]=r}return t}(),z=function(t,e,r,s,o){if(!o&&(o={l:1},e.dictionary)){var n=e.dictionary.subarray(-32768),a=new i(n.length+t.length);a.set(n),a.set(t,n.length),t=a,o.w=n.length}return L(t,null==e.level?6:e.level,null==e.mem?o.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):20:12+e.mem,r,s,o)},H=function(t,e){var r={};for(var s in t)r[s]=t[s];for(var s in e)r[s]=e[s];return r},V=function(t,e,r){for(var s=t(),i=t.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),n=0;n<s.length;++n){var a=s[n],l=o[n];if("function"==typeof a){e+=";"+l+"=";var h=a.toString();if(a.prototype)if(-1!=h.indexOf("[native code]")){var c=h.indexOf(" ",8)+1;e+=h.slice(c,h.indexOf("(",c))}else for(var d in e+=h,a.prototype)e+=";"+l+".prototype."+d+"="+a.prototype[d].toString();else e+=h}else r[l]=a}return e},j=[],G=function(){return[i,o,n,a,l,h,u,f,_,C,v,w,g,M,$,y,A,k,O,P,I,D,N,R,E,S,L,z,U,X]},X=function(t){return postMessage(t,[t.buffer])},W=function(t,e,r,i,o,n){var a=function(t,e,r,i){if(!j[r]){for(var o="",n={},a=t.length-1,l=0;l<a;++l)o=V(t[l],o,n);j[r]={c:V(t[a],o,n),e:n}}var h=H({},j[r].e);return function(t,e,r,i,o){var n=new Worker(s[e]||(s[e]=URL.createObjectURL(new Blob([t+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return n.onmessage=function(t){var e=t.data,r=e.$e$;if(r){var s=new Error(r[0]);s.code=r[1],s.stack=r[2],o(s,null)}else o(null,e)},n.postMessage(r,i),n}(j[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,h,function(t){var e=[];for(var r in t)t[r].buffer&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e}(h),i)}(r,i,o,(function(t,e){a.terminate(),n(t,e)}));return a.postMessage([t,e],e.consume?[t.buffer]:[]),function(){a.terminate()}},Q=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8};function U(t,e){return z(t,e||{},0,0)}var q=function(t,e,r,s){for(var o in t){var n=t[o],a=e+o,l=s;Array.isArray(n)&&(l=H(s,n[1]),n=n[0]),n instanceof i?r[a]=[n,l]:(r[a+="/"]=[new i(0),l],q(n,a,r,s))}},J="undefined"!=typeof TextEncoder&&new TextEncoder,K="undefined"!=typeof TextDecoder&&new TextDecoder;try{K.decode($,{stream:!0})}catch(t){}function Y(t,e){if(e){for(var r=new i(t.length),s=0;s<t.length;++s)r[s]=t.charCodeAt(s);return r}if(J)return J.encode(t);var o=t.length,n=new i(t.length+(t.length>>1)),a=0,l=function(t){n[a++]=t};for(s=0;s<o;++s){if(a+5>n.length){var h=new i(a+8+(o-s<<1));h.set(n),n=h}var c=t.charCodeAt(s);c<128||e?l(c):c<2048?(l(192|c>>6),l(128|63&c)):c>55295&&c<57344?(l(240|(c=65536+(1047552&c)|1023&t.charCodeAt(++s))>>18),l(128|c>>12&63),l(128|c>>6&63),l(128|63&c)):(l(224|c>>12),l(128|c>>6&63),l(128|63&c))}return S(n,0,a)}var Z=function(t){var e=0;if(t)for(var r in t){var s=t[r].length;s>65535&&F(9),e+=s+4}return e},tt=function(t,e,r,s,i,o,n,a){var l=s.length,h=r.extra,c=a&&a.length,d=Z(h);Q(t,e,null!=n?33639248:67324752),e+=4,null!=n&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(o<0&&8),t[e++]=i&&8,t[e++]=255&r.compression,t[e++]=r.compression>>8;var p=new Date(null==r.mtime?Date.now():r.mtime),u=p.getFullYear()-1980;if((u<0||u>119)&&F(10),Q(t,e,u<<25|p.getMonth()+1<<21|p.getDate()<<16|p.getHours()<<11|p.getMinutes()<<5|p.getSeconds()>>1),e+=4,-1!=o&&(Q(t,e,r.crc),Q(t,e+4,o<0?-o-2:o),Q(t,e+8,r.size)),Q(t,e+12,l),Q(t,e+14,d),e+=16,null!=n&&(Q(t,e,c),Q(t,e+6,r.attrs),Q(t,e+10,n),e+=14),t.set(s,e),e+=l,d)for(var m in h){var f=h[m],g=f.length;Q(t,e,+m),Q(t,e+2,g),t.set(f,e+4),e+=4+g}return c&&(t.set(a,e),e+=c),e};function et(t,e,r){r||(r=e,e={}),"function"!=typeof r&&F(7);var s={};q(t,"",s,e);var o=Object.keys(s),n=o.length,a=0,l=0,h=n,c=new Array(n),d=[],p=function(){for(var t=0;t<d.length;++t)d[t]()},u=function(t,e){rt((function(){r(t,e)}))};rt((function(){u=r}));var m=function(){var t=new i(l+22),e=a,r=l-a;l=0;for(var s=0;s<h;++s){var o=c[s];try{var n=o.c.length;tt(t,l,o,o.f,o.u,n);var d=30+o.f.length+Z(o.extra),p=l+d;t.set(o.c,p),tt(t,a,o,o.f,o.u,n,l,o.m),a+=16+d+(o.m?o.m.length:0),l=p+n}catch(t){return u(t,null)}}(function(t,e,r,s,i){Q(t,e,101010256),Q(t,e+8,r),Q(t,e+10,r),Q(t,e+12,s),Q(t,e+16,i)})(t,a,c.length,r,e),u(null,t)};n||m();for(var f=function(t){var e=o[t],r=s[e],i=r[0],h=r[1],f=function(){var t=-1;return{p:function(e){for(var r=t,s=0;s<e.length;++s)r=B[255&r^e[s]]^r>>>8;t=r},d:function(){return~t}}}(),g=i.length;f.p(i);var b=Y(e),x=b.length,y=h.comment,C=y&&Y(y),w=C&&C.length,_=Z(h.extra),v=0==h.level?0:8,E=function(r,s){if(r)p(),u(r,null);else{var i=s.length;c[t]=H(h,{size:g,crc:f.d(),c:s,f:b,m:C,u:x!=e.length||C&&y.length!=w,compression:v}),a+=30+x+_+i,l+=76+2*(x+_)+(w||0)+i,--n||m()}};if(x>65535&&E(F(11,0,1),null),v)if(g<16e4)try{E(null,U(i,h))}catch(t){E(t,null)}else d.push(function(t,e,r){return r||(r=e,e={}),"function"!=typeof r&&F(7),W(t,e,[G],(function(t){return X(U(t.data[0],t.data[1]))}),0,r)}(i,h,E));else E(null,i)},g=0;g<h;++g)f(g);return p}var rt="function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout?setTimeout:function(t){t()},st=Object.defineProperty,it=(t,e,r)=>((t,e,r)=>e in t?st(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r);function ot(t){const e=typeof t;return null!=t&&("object"===e||"function"===e)}function nt(t){if("object"!=typeof t||null===t||"[object Object]"!==Object.prototype.toString.call(t))return!1;const e=Object.getPrototypeOf(t);if(null===e)return!0;const r=Object.prototype.hasOwnProperty.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(t)}function at(t){return null!=t&&"string"==typeof t.valueOf()}const lt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ht=t=>("string"!=typeof t&&(t=`${t}`),t.replace(/[&<>"']/g,(t=>lt[t])));class ct{constructor(t,e){it(this,"documentElement"),this.documentElement=this.createElement(e),this.documentElement.setAttribute("xmlns",t)}createElement(t){return new pt({nodeName:t})}createTextNode(t){return new dt(t)}toString(){return this.documentElement.toString()}}it(ct,"Node",{Create:t=>{switch(t.type){case"XML":return new pt(t);case"TEXT":return new dt(t.nodeValue);default:return null}}});class dt{constructor(t){it(this,"nodeValue"),this.nodeValue=t}toJSON(){return{nodeValue:this.nodeValue,type:"TEXT"}}toString(){return ht(this.nodeValue)}}class pt{constructor(t){if(it(this,"nodeName",""),it(this,"children"),it(this,"nodeValue"),it(this,"attributes"),it(this,"firstChild"),this.nodeName=t.nodeName,this.children=[],this.nodeValue=t.nodeValue||"",this.attributes={},t.children)for(let e=0,r=t.children.length;e<r;e++)this.appendChild(ct.Node.Create(t.children[e]));if(t.attributes)for(const e in t.attributes)t.attributes.hasOwnProperty(e)&&this.setAttribute(e,t.attributes[e])}toString(){let t=`<${this.nodeName}`;for(const e in this.attributes)this.attributes.hasOwnProperty(e)&&(t=`${t} ${e}="${ht(this.attributes[e])}"`);let e="";for(let t=0,r=this.children.length;t<r;t++)e+=this.children[t].toString();return t+=e?`>${e}</${this.nodeName}>`:"/>",t}toJSON(){const t=[];for(let e=0,r=this.children.length;e<r;e++)t.push(this.children[e].toJSON());return{nodeName:this.nodeName,children:t,nodeValue:this.nodeValue,attributes:this.attributes,type:"XML"}}setAttribute(t,e){if(null===e)return delete this.attributes[t],void delete this[t];this.attributes[t]=e,this[t]=e}appendChild(t){this.children.push(t),this.firstChild=this.children[0]}cloneNode(t){return new pt(this.toJSON())}}const ut=class t{static uniqueId(e){return t._idSpaces[e]||(t._idSpaces[e]=1),t._idSpaces[e]++}static createXmlDoc(t,e){return new ct(t||null,e)}static createElement(t,e,r){const s=t.createElement(e);let i=(r=r||[]).length;for(;i--;)s.setAttribute(r[i][0],r[i][1]);return s}static setAttributesOnDoc(t,e){for(let[r,s]of Object.entries(e))nt(s)&&(null!==s.v&&void 0!==s.v?s.type===Boolean&&(s=s.v?"1":"0"):s=null),null!=s&&t.setAttribute(r,s)}static positionToLetterRef(e,r){let s,i=1,o=e,n="";if(t.LETTER_REFS[e])return t.LETTER_REFS[e].concat(r);for(;o>0;)o-=Math.pow(26,i-1),s=o%Math.pow(26,i),o-=s,s/=Math.pow(26,i-1),n="ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(s)+n,i+=1;return t.LETTER_REFS[e]=n,n.concat(String(r))}};it(ut,"_idSpaces",{}),it(ut,"LETTER_REFS",{}),it(ut,"schemas",{worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"});let mt=ut;const ft={};function gt(t="$lodash$"){ft[t]||(ft[t]=0);const e=++ft[t];return"$lodash$"===t?`${e}`:`${t}${e}`}const bt={};class xt{constructor(){it(this,"relations",{}),it(this,"lastId",1),gt("rId")}importData(t){this.relations=t.relations,this.lastId=t.lastId}exportData(){return{relations:this.relations,lastId:this.lastId}}addRelation(t,e){return this.relations[t.id]={id:gt("rId"),schema:mt.schemas[e],object:t},this.relations[t.id].id}getRelationshipId(t){return this.relations[t.id]?this.relations[t.id].id:null}toXML(){const t=mt.createXmlDoc(mt.schemas.relationshipPackage,"Relationships"),e=t.documentElement;for(const[r,s]of Object.entries(this.relations)){const i=mt.createElement(t,"Relationship",[["Id",s.id],["Type",s.schema],["Target",s.object.target||bt[r]]]);s.object.targetMode&&i.setAttribute("TargetMode",s.object.targetMode),e.appendChild(i)}return t}}class yt{constructor(){it(this,"state",null),it(this,"xSplit",null),it(this,"ySplit",null),it(this,"activePane","bottomRight"),it(this,"topLeftCell",null),it(this,"_freezePane")}freezePane(t,e,r){this._freezePane={xSplit:t,ySplit:e,cell:r}}exportXML(t){const e=t.createElement("pane");return null!==this.state&&(e.setAttribute("xSplit",this._freezePane.xSplit),e.setAttribute("ySplit",this._freezePane.ySplit),e.setAttribute("topLeftCell",this._freezePane.cell),e.setAttribute("activePane","bottomRight"),e.setAttribute("state","frozen")),e}}class Ct{constructor(){it(this,"strings",{}),it(this,"stringArray",[]),it(this,"id",gt("SharedStrings"))}addString(t){return this.strings[t]=this.stringArray.length,this.stringArray[this.stringArray.length]=t,this.strings[t]}exportData(){return this.strings}toXML(){const t=mt.createXmlDoc(mt.schemas.spreadsheetml,"sst"),e=t.documentElement;this.stringArray.reverse();let r=this.stringArray.length;e.setAttribute("count",r),e.setAttribute("uniqueCount",r);const s=t.createElement("si"),i=t.createElement("t");i.appendChild(t.createTextNode("--placeholder--")),s.appendChild(i);const o=this.stringArray;for(;r--;){const t=s.cloneNode(!0);"string"==typeof o[r]&&o[r].match(/\s+/)&&t.firstChild.setAttribute("xml:space","preserve"),t.firstChild.firstChild.nodeValue=o[r],e.appendChild(t)}return t}}class wt{constructor(t){it(this,"pane"),it(this,"showZeros",null),it(this,"defaultGridColor",null),it(this,"colorId",null),it(this,"rightToLeft",null),it(this,"showFormulas",null),it(this,"showGridLines",null),it(this,"showOutlineSymbols",null),it(this,"showRowColHeaders",null),it(this,"showRuler",null),it(this,"showWhiteSpace",null),it(this,"tabSelected",null),it(this,"topLeftCell",null),it(this,"viewType",null),it(this,"windowProtection",null),it(this,"zoomScale",null),it(this,"zoomScaleNormal",null),it(this,"zoomScalePageLayoutView",null),it(this,"zoomScaleSheetLayoutView",null);const e=t||{};this.pane=e.pane||new yt}freezePane(t,e,r){this.pane.state="frozen",this.pane.xSplit=t,this.pane.ySplit=e,this.pane.topLeftCell=r}exportXML(t){const e=t.createElement("sheetViews"),r=t.createElement("sheetView");return mt.setAttributesOnDoc(r,{workbookViewId:0,showZeros:{v:this.showZeros,type:Boolean},defaultGridColor:{v:this.defaultGridColor,type:Boolean},colorId:this.colorId,rightToLeft:{v:this.rightToLeft,type:Boolean},showFormulas:{v:this.showFormulas,type:Boolean},showGridLines:{v:this.showGridLines,type:Boolean},showOutlineSymbols:{v:this.showOutlineSymbols,type:Boolean},showRowColHeaders:{v:this.showRowColHeaders,type:Boolean},showRuler:{v:this.showRuler,type:Boolean},showWhiteSpace:{v:this.showWhiteSpace,type:Boolean},tabSelected:{v:this.tabSelected,type:Boolean},viewType:this.viewType,windowProtection:{v:this.windowProtection,type:Boolean},zoomScale:{v:this.zoomScale,type:Boolean},zoomScaleNormal:this.zoomScaleNormal,zoomScalePageLayoutView:this.zoomScalePageLayoutView,zoomScaleSheetLayoutView:this.zoomScaleSheetLayoutView}),r.appendChild(this.pane.exportXML(t)),e.appendChild(r),e}}class _t{constructor(){it(this,"id",gt("StyleSheet")),it(this,"cellStyles",[{name:"Normal",xfId:"0",builtinId:"0"}]),it(this,"defaultTableStyle",!1),it(this,"differentialStyles",[{}]),it(this,"masterCellFormats",[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfid:0}]),it(this,"masterCellStyles",[{numFmtId:0,fontId:0,fillId:0,borderId:0}]),it(this,"fonts",[{}]),it(this,"numberFormatters",[]),it(this,"fills",[{},{type:"pattern",patternType:"gray125",fgColor:"FF333333",bgColor:"FF333333"}]),it(this,"borders",[{top:{},left:{},right:{},bottom:{},diagonal:{}}]),it(this,"tableStyles",[])}createSimpleFormatter(t){const e={id:this.masterCellFormats.length};return"date"===t&&(e.numFmtId=14),this.masterCellFormats.push(e),e}createFill(t){const e=this.fills.length,r=t;return r.id=e,this.fills.push(r),r}createNumberFormatter(t){const e={id:this.numberFormatters.length+100,formatCode:t};return this.numberFormatters.push(e),e}createFormat(t){const e={id:this.masterCellFormats.length};if(t.protection&&(e.protection=t.protection),t.font&&ot(t.font))e.fontId=this.createFontStyle(t.font).id;else if(t.font){if(Number.isNaN(Number.parseInt(t.font,10)))throw new Error("Passing a non-numeric font id is not supported");e.fontId=t.font}if(t.format&&at(t.format))e.numFmtId=this.createNumberFormatter(t.format).id;else if(t.format){if(Number.isNaN(Number.parseInt(t.format,10)))throw new Error("Invalid number formatter id");e.numFmtId=t.format}if(t.border&&ot(t.border))e.borderId=this.createBorderFormatter(t.border).id;else if(t.border){if(Number.isNaN(Number.parseInt(t.border,10)))throw new Error("Passing a non-numeric border id is not supported");e.borderId=t.border}if(t.fill&&ot(t.fill))e.fillId=this.createFill(t.fill).id;else if(t.fill){if(Number.isNaN(Number.parseInt(t.fill,10)))throw new Error("Passing a non-numeric fill id is not supported");e.fillId=t.fill}return t.alignment&&ot(t.alignment)&&(e.alignment=(r=t.alignment,["horizontal","justifyLastLine","readingOrder","relativeIndent","shrinkToFit","textRotation","vertical","wrapText"].reduce(((t,e)=>(null!=r&&r.hasOwnProperty(e)&&(t[e]=r[e]),t)),{}))),this.masterCellFormats.push(e),e;var r}createDifferentialStyle(t){const e=this.differentialStyles.length,r={id:e};return t.font&&ot(t.font)&&(r.font=t.font),t.border&&ot(t.border)&&(r.border=Object.assign({top:{},left:{},right:{},bottom:{},diagonal:{}},t.border)),t.fill&&ot(t.fill)&&(r.fill=t.fill),t.alignment&&ot(t.alignment)&&(r.alignment=t.alignment),t.format&&at(t.format)&&(r.numFmt=t.format),this.differentialStyles[e]=r,r}createTableStyle(t){this.tableStyles.push(t)}createBorderFormatter(t){return t={top:{},left:{},right:{},bottom:{},diagonal:{},id:this.borders.length,...t},this.borders.push(t),t}createFontStyle(t){const e={id:this.fonts.length};return t.bold&&(e.bold=!0),t.italic&&(e.italic=!0),t.superscript&&(e.vertAlign="superscript"),t.subscript&&(e.vertAlign="subscript"),t.underline&&("string"==typeof t.underline&&["double","singleAccounting","doubleAccounting"].includes(t.underline)?e.underline=t.underline:e.underline=!0),t.strike&&(e.strike=!0),t.outline&&(e.outline=!0),t.shadow&&(e.shadow=!0),t.size&&(e.size=t.size),t.color&&(e.color=t.color),t.fontName&&(e.fontName=t.fontName),this.fonts.push(e),e}exportBorders(t){const e=t.createElement("borders");e.setAttribute("count",this.borders.length);for(let r=0,s=this.borders.length;r<s;r++)e.appendChild(this.exportBorder(t,this.borders[r]));return e}exportBorder(t,e){const r=t.createElement("border"),s=r=>{const s=t.createElement(r);return e[r].style&&s.setAttribute("style",e[r].style),e[r].color&&s.appendChild(this.exportColor(t,e[r].color)),s};return r.appendChild(s("left")),r.appendChild(s("right")),r.appendChild(s("top")),r.appendChild(s("bottom")),r.appendChild(s("diagonal")),r}exportColor(t,e){const r=t.createElement("color");return at(e)?(r.setAttribute("rgb",e),r):(void 0!==e.tint&&r.setAttribute("tint",e.tint),void 0!==e.auto&&r.setAttribute("auto",String(!!e.auto)),void 0!==e.theme&&r.setAttribute("theme",e.theme),r)}exportMasterCellFormats(t){const e=mt.createElement(t,"cellXfs",[["count",this.masterCellFormats.length]]);for(let r=0,s=this.masterCellFormats.length;r<s;r++){const s=this.masterCellFormats[r];e.appendChild(this.exportCellFormatElement(t,s))}return e}exportMasterCellStyles(t){const e=mt.createElement(t,"cellStyleXfs",[["count",this.masterCellStyles.length]]);for(let r=0,s=this.masterCellStyles.length;r<s;r++){const s=this.masterCellStyles[r];e.appendChild(this.exportCellFormatElement(t,s))}return e}exportCellFormatElement(t,e){const r=t.createElement("xf"),s=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","xfId"],i=Object.keys(e).filter((t=>-1!==s.indexOf(t)));if(e.alignment){const s=e.alignment;r.appendChild(this.exportAlignment(t,s))}e.protection&&(r.appendChild(this.exportProtection(t,e.protection)),r.setAttribute("applyProtection","1"));let o=i.length;for(;o--;)r.setAttribute(i[o],e[i[o]]);return e.fillId&&r.setAttribute("applyFill","1"),e.fontId&&r.setAttribute("applyFont","1"),e.borderId&&r.setAttribute("applyBorder","1"),e.alignment&&r.setAttribute("applyAlignment","1"),e.numFmtId&&r.setAttribute("applyNumberFormat","1"),void 0!==e.numFmtId&&void 0===e.xfId&&r.setAttribute("xfId","0"),r}exportAlignment(t,e){const r=t.createElement("alignment"),s=Object.keys(e);for(let t=0,i=s.length;t<i;t++)r.setAttribute(s[t],e[s[t]]);return r}exportFonts(t){const e=t.createElement("fonts");e.setAttribute("count",String(this.fonts.length));for(let r=0,s=this.fonts.length;r<s;r++){const s=this.fonts[r];e.appendChild(this.exportFont(t,s))}return e}exportFont(t,e){const r=t.createElement("font");if(e.size){const s=t.createElement("sz");s.setAttribute("val",e.size),r.appendChild(s)}if(e.fontName){const s=t.createElement("name");s.setAttribute("val",e.fontName),r.appendChild(s)}if(e.bold&&r.appendChild(t.createElement("b")),e.italic&&r.appendChild(t.createElement("i")),e.vertAlign){const s=t.createElement("vertAlign");s.setAttribute("val",e.vertAlign),r.appendChild(s)}if(e.underline){const s=t.createElement("u");!0!==e.underline&&s.setAttribute("val",e.underline),r.appendChild(s)}return e.strike&&r.appendChild(t.createElement("strike")),e.shadow&&r.appendChild(t.createElement("shadow")),e.outline&&r.appendChild(t.createElement("outline")),e.color&&r.appendChild(this.exportColor(t,e.color)),r}exportFills(t){const e=t.createElement("fills");e.setAttribute("count",String(this.fills.length));for(let r=0,s=this.fills.length;r<s;r++){const s=this.fills[r];e.appendChild(this.exportFill(t,s))}return e}exportFill(t,e){let r;const s=t.createElement("fill");return"pattern"===e.type?(r=this.exportPatternFill(t,e),s.appendChild(r)):"gradient"===e.type&&(r=this.exportGradientFill(t,e),s.appendChild(r)),s}exportGradientFill(t,e){const r=t.createElement("gradientFill");e.degree?r.setAttribute("degree",e.degree):e.left&&(r.setAttribute("left",e.left),r.setAttribute("right",e.right),r.setAttribute("top",e.top),r.setAttribute("bottom",e.bottom));const s=t.createElement("stop");s.setAttribute("position",e.start.pureAt||0);const i=t.createElement("color");"string"==typeof e.start||e.start.color?i.setAttribute("rgb",e.start.color||e.start):e.start.theme&&i.setAttribute("theme",e.start.theme);const o=t.createElement("stop"),n=t.createElement("color");return o.setAttribute("position",e.end.pureAt||1),"string"==typeof e.start||e.end.color?n.setAttribute("rgb",e.end.color||e.end):e.end.theme&&n.setAttribute("theme",e.end.theme),s.appendChild(i),o.appendChild(n),r.appendChild(s),r.appendChild(o),r}exportPatternFill(t,e){const r=mt.createElement(t,"patternFill",[["patternType",e.patternType]]);e.bgColor||(e.bgColor="FFFFFFFF"),e.fgColor||(e.fgColor="FFFFFFFF");const s=t.createElement("bgColor");at(e.bgColor)?s.setAttribute("rgb",e.bgColor):e.bgColor.theme?s.setAttribute("theme",e.bgColor.theme):s.setAttribute("rgb",e.bgColor.rbg);const i=t.createElement("fgColor");return at(e.fgColor)?i.setAttribute("rgb",e.fgColor):e.fgColor.theme?i.setAttribute("theme",e.fgColor.theme):i.setAttribute("rgb",e.fgColor.rbg),r.appendChild(i),r.appendChild(s),r}exportNumberFormatters(t){const e=t.createElement("numFmts");e.setAttribute("count",String(this.numberFormatters.length));for(let r=0,s=this.numberFormatters.length;r<s;r++){const s=this.numberFormatters[r];e.appendChild(this.exportNumberFormatter(t,s))}return e}exportNumberFormatter(t,e){const r=t.createElement("numFmt");return r.setAttribute("numFmtId",e.id),r.setAttribute("formatCode",e.formatCode),r}exportCellStyles(t){const e=t.createElement("cellStyles");e.setAttribute("count",String(this.cellStyles.length));for(let r=0,s=this.cellStyles.length;r<s;r++){const s=this.cellStyles[r];delete s.id;const i=mt.createElement(t,"cellStyle");e.appendChild(i);const o=Object.keys(s);let n=o.length;for(;n--;)i.setAttribute(o[n],s[o[n]])}return e}exportDifferentialStyles(t){const e=t.createElement("dxfs");e.setAttribute("count",String(this.differentialStyles.length));for(let r=0,s=this.differentialStyles.length;r<s;r++){const s=this.differentialStyles[r];e.appendChild(this.exportDFX(t,s))}return e}exportDFX(t,e){const r=t.createElement("dxf");return e.font&&r.appendChild(this.exportFont(t,e.font)),e.fill&&r.appendChild(this.exportFill(t,e.fill)),e.border&&r.appendChild(this.exportBorder(t,e.border)),e.numFmt&&r.appendChild(this.exportNumberFormatter(t,e.numFmt)),e.alignment&&r.appendChild(this.exportAlignment(t,e.alignment)),r}exportTableStyles(t){const e=t.createElement("tableStyles");e.setAttribute("count",String(this.tableStyles.length)),this.defaultTableStyle&&e.setAttribute("defaultTableStyle",String(this.defaultTableStyle));for(let r=0,s=this.tableStyles.length;r<s;r++)e.appendChild(this.exportTableStyle(t,this.tableStyles[r]));return e}exportTableStyle(t,e){const r=t.createElement("tableStyle");r.setAttribute("name",e.name),r.setAttribute("pivot",String(0));let s=0;return Object.entries(e).forEach((([e,i])=>{if("name"===e)return;s++;const o=t.createElement("tableStyleElement");o.setAttribute("type",e),o.setAttribute("dxfId",i),r.appendChild(o)})),r.setAttribute("count",String(s)),r}exportProtection(t,e){const r=t.createElement("protection");for(const t in e)t in e&&r.setAttribute(t,e[t]);return r}toXML(){const t=mt.createXmlDoc(mt.schemas.spreadsheetml,"styleSheet"),e=t.documentElement;return e.appendChild(this.exportNumberFormatters(t)),e.appendChild(this.exportFonts(t)),e.appendChild(this.exportFills(t)),e.appendChild(this.exportBorders(t)),e.appendChild(this.exportMasterCellStyles(t)),e.appendChild(this.exportMasterCellFormats(t)),e.appendChild(this.exportCellStyles(t)),e.appendChild(this.exportDifferentialStyles(t)),this.tableStyles.length&&e.appendChild(this.exportTableStyles(t)),t}}class vt{constructor(t){it(this,"name",""),it(this,"id",gt("Worksheet")),it(this,"_timezoneOffset"),it(this,"relations",null),it(this,"columnFormats",[]),it(this,"data",[]),it(this,"mergedCells",[]),it(this,"columns",[]),it(this,"sheetProtection",!1),it(this,"_headers",[]),it(this,"_footers",[]),it(this,"_tables",[]),it(this,"_drawings",[]),it(this,"_orientation"),it(this,"_margin"),it(this,"_rowInstructions",{}),it(this,"_freezePane",{}),it(this,"sharedStrings",null),it(this,"hyperlinks",[]),it(this,"sheetView"),it(this,"showZeros",null),this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,this.sheetView=t.sheetView||new wt,this.initialize(t)}initialize(t){t=t||{},this.name=t.name,this.id=gt("Worksheet"),this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,t.columns&&this.setColumns(t.columns),this.relations=new xt}exportData(){return{relations:this.relations.exportData(),columnFormats:this.columnFormats,data:this.data,columns:this.columns,mergedCells:this.mergedCells,_headers:this._headers,_footers:this._footers,_tables:this._tables,_rowInstructions:this._rowInstructions,_freezePane:this._freezePane,name:this.name,id:this.id}}importData(t){this.relations.importData(t.relations),delete t.relations,Object.assign(this,t)}setSharedStringCollection(t){this.sharedStrings=t}addTable(t){this._tables.push(t),this.relations.addRelation(t,"table")}addDrawings(t){this._drawings.push(t),this.relations.addRelation(t,"drawingRelationship")}setRowInstructions(t,e){this._rowInstructions[t]=e}setHeader(t){if(!Array.isArray(t))throw"Invalid argument type - setHeader expects an array of three instructions";this._headers=t}setFooter(t){if(!Array.isArray(t))throw"Invalid argument type - setFooter expects an array of three instructions";this._footers=t}compilePageDetailPackage(t){return t=t||"",["&L",this.compilePageDetailPiece(t[0]||""),"&C",this.compilePageDetailPiece(t[1]||""),"&R",this.compilePageDetailPiece(t[2]||"")].join("")}compilePageDetailPiece(t){if(at(t))return'&"-,Regular"'.concat(t);if(ot(t)&&!Array.isArray(t)){let e="";if(t.font||t.bold){const r=t.bold?"Bold":"Regular";e+=`&"${t.font||"-"}`,e+=`,${r}"`}else e+='&"-,Regular"';return t.underline&&(e+="&U"),t.fontSize&&(e+=`&${t.fontSize}`),e+=t.text,e}return Array.isArray(t)?t.reduce(((t,e)=>t.concat(this.compilePageDetailPiece(e))),""):void 0}exportHeader(t){const e=t.createElement("oddHeader");return e.appendChild(t.createTextNode(this.compilePageDetailPackage(this._headers))),e}exportFooter(t){const e=t.createElement("oddFooter");return e.appendChild(t.createTextNode(this.compilePageDetailPackage(this._footers))),e}_buildCache(t){const e=t.createElement("c"),r=t.createElement("v");r.appendChild(t.createTextNode("--temp--")),e.appendChild(r);const s=t.createElement("c"),i=t.createElement("f");i.appendChild(t.createTextNode("--temp--")),s.appendChild(i);const o=t.createElement("c");o.setAttribute("t","s");const n=t.createElement("v");return n.appendChild(t.createTextNode("--temp--")),o.appendChild(n),{number:e,date:e,string:o,formula:s}}collectSharedStrings(){const t=this.data,e={};for(let r=0,s=t.length;r<s;r++){const s=t[r],i=s.length;for(let t=0;t<i;t++){let r=s[t];const i=(null==r?void 0:r.metadata)||{};r&&"object"==typeof r&&(r=r.value),i.type||"number"==typeof r&&(i.type="number"),("text"===i.type||!i.type)&&typeof e[r]>"u"&&(e[r]=!0)}}return Object.keys(e)}toXML(){var t,e,r;const s=this.data,i=this.columns||[],o=mt.createXmlDoc(mt.schemas.spreadsheetml,"worksheet"),n=o.documentElement;let a,l,h;n.setAttribute("xmlns:r",mt.schemas.relationships),n.setAttribute("xmlns:mc",mt.schemas.markupCompat);let c=0;const d=mt.createElement(o,"sheetData"),p=this._buildCache(o);for(h=0,l=s.length;h<l;h++){const n=s[h],a=n.length;c=a>c?a:c;const l=o.createElement("row");for(let s=0;s<a;s++){i[s]=i[s]||{};let o,a=n[s];const c=(null==a?void 0:a.metadata)||{};switch(a&&"object"==typeof a&&(a=a.value),c.type||"number"==typeof a&&(c.type="number"),c.type){case"number":o=p.number.cloneNode(!0),o.firstChild.firstChild.nodeValue=a;break;case"date":o=p.date.cloneNode(!0),a instanceof Date&&(a=a.getTime()),o.firstChild.firstChild.nodeValue=25569+(a-this._timezoneOffset)/864e5;break;case"formula":o=p.formula.cloneNode(!0),o.firstChild.firstChild.nodeValue=a;break;default:{let r;r=typeof(null==(t=this.sharedStrings)?void 0:t.strings[a])<"u"?this.sharedStrings.strings[a]:null==(e=this.sharedStrings)?void 0:e.addString(a),o=p.string.cloneNode(!0),o.firstChild.firstChild.nodeValue=r;break}}c.style?o.setAttribute("s",c.style):void 0!==(null==(r=this._rowInstructions[h])?void 0:r.style)&&o.setAttribute("s",this._rowInstructions[h].style),o.setAttribute("r",mt.positionToLetterRef(s+1,String(h+1))),l.appendChild(o)}if(l.setAttribute("r",h+1),this._rowInstructions[h]){const t=this._rowInstructions[h];void 0!==t.height&&(l.setAttribute("customHeight","1"),l.setAttribute("ht",t.height)),void 0!==t.style&&(l.setAttribute("customFormat","1"),l.setAttribute("s",t.style))}d.appendChild(l)}if(0!==c?n.appendChild(mt.createElement(o,"dimension",[["ref",`${mt.positionToLetterRef(1,1)}:${mt.positionToLetterRef(c,String(s.length))}`]])):n.appendChild(mt.createElement(o,"dimension",[["ref",mt.positionToLetterRef(1,1)]])),n.appendChild(this.sheetView.exportXML(o)),this.columns.length&&n.appendChild(this.exportColumns(o)),n.appendChild(d),this.sheetProtection&&n.appendChild(this.sheetProtection.exportXML(o)),this.hyperlinks.length>0){const t=o.createElement("hyperlinks"),e=this.hyperlinks;for(a=0,l=e.length;a<l;a++){const r=o.createElement("hyperlink"),s=e[a];r.setAttribute("ref",String(s.cell)),s.id=mt.uniqueId("hyperlink"),this.relations.addRelation({id:s.id,target:s.location,targetMode:s.targetMode||"External"},"hyperlink"),r.setAttribute("r:id",this.relations.getRelationshipId(s)),t.appendChild(r)}n.appendChild(t)}if(this.mergedCells.length>0){const t=o.createElement("mergeCells");for(a=0,l=this.mergedCells.length;a<l;a++){const e=o.createElement("mergeCell");e.setAttribute("ref",`${this.mergedCells[a][0]}:${this.mergedCells[a][1]}`),t.appendChild(e)}n.appendChild(t)}if(this.exportPageSettings(o,n),this._headers.length>0||this._footers.length>0){const t=o.createElement("headerFooter");this._headers.length>0&&t.appendChild(this.exportHeader(o)),this._footers.length>0&&t.appendChild(this.exportFooter(o)),n.appendChild(t)}for(a=0,l=this._drawings.length;a<l;a++){const t=o.createElement("drawing");t.setAttribute("r:id",this.relations.getRelationshipId(this._drawings[a])),n.appendChild(t)}if(this._tables.length>0){const t=o.createElement("tableParts");for(t.setAttribute("count",this._tables.length),a=0,l=this._tables.length;a<l;a++){const e=o.createElement("tablePart");e.setAttribute("r:id",this.relations.getRelationshipId(this._tables[a])),t.appendChild(e)}n.appendChild(t)}return o}exportColumns(t){const e=mt.createElement(t,"cols");for(let r=0,s=this.columns.length;r<s;r++){const s=this.columns[r],i=mt.createElement(t,"col",[["min",s.min||r+1],["max",s.max||r+1]]);s.hidden&&i.setAttribute("hidden",String(1)),s.bestFit&&i.setAttribute("bestFit",String(1)),(s.customWidth||s.width)&&i.setAttribute("customWidth",String(1)),s.width?i.setAttribute("width",s.width):i.setAttribute("width",String(9.140625)),e.appendChild(i)}return e}exportPageSettings(t,e){if(this._margin){let r=.7;const s=this._margin.left?this._margin.left:r,i=this._margin.right?this._margin.right:r,o=this._margin.top?this._margin.top:r,n=this._margin.bottom?this._margin.bottom:r;r=.3;const a=this._margin.header?this._margin.header:r,l=this._margin.footer?this._margin.footer:r;e.appendChild(mt.createElement(t,"pageMargins",[["top",o],["bottom",n],["left",s],["right",i],["header",a],["footer",l]]))}this._orientation&&e.appendChild(mt.createElement(t,"pageSetup",[["orientation",this._orientation]]))}setPageOrientation(t){this._orientation=t}setPageMargin(t){this._margin=t}setColumns(t){this.columns=t}setData(t){this.data=t}mergeCells(t,e){this.mergedCells.push([t,e])}freezePane(t,e,r){this.sheetView.freezePane(t,e,r)}setColumnFormats(t){this.columnFormats=t}}class Et{constructor(){it(this,"id",gt("Workbook")),it(this,"styleSheet",new _t),it(this,"sharedStrings",new Ct),it(this,"relations",new xt),it(this,"worksheets",[]),it(this,"tables",[]),it(this,"drawings",[]),it(this,"media",{}),it(this,"printTitles"),this.initialize()}initialize(){this.id=gt("Workbook"),this.styleSheet=new _t,this.sharedStrings=new Ct,this.relations=new xt,this.relations.addRelation(this.styleSheet,"stylesheet"),this.relations.addRelation(this.sharedStrings,"sharedStrings")}createWorksheet(t){return t=Object.assign({},{name:"Sheet ".concat(String(this.worksheets.length+1))},t),new vt(t)}getStyleSheet(){return this.styleSheet}addTable(t){this.tables.push(t)}addDrawings(t){this.drawings.push(t)}setPrintTitleTop(t,e){null==this.printTitles&&(this.printTitles={}),null==this.printTitles[t]&&(this.printTitles[t]={}),this.printTitles[t].top=e}setPrintTitleLeft(t,e){null==this.printTitles&&(this.printTitles={}),null==this.printTitles[t]&&(this.printTitles[t]={}),this.printTitles[t].left=String.fromCharCode(64+e)}addMedia(t,e,r,s){const i=e.split("."),o=i[i.length-1];if(!s)switch(o.toLowerCase()){case"jpeg":case"jpg":s="image/jpeg";break;case"png":s="image/png";break;case"gif":s="image/gif";break;default:s=null}return this.media[e]||(this.media[e]={id:e,data:r,fileName:e,contentType:s,extension:o}),this.media[e]}addWorksheet(t){this.relations.addRelation(t,"worksheet"),t.setSharedStringCollection(this.sharedStrings),this.worksheets.push(t)}createContentTypes(){const t=mt.createXmlDoc(mt.schemas.contentTypes,"Types"),e=t.documentElement;let r,s;e.appendChild(mt.createElement(t,"Default",[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]])),e.appendChild(mt.createElement(t,"Default",[["Extension","xml"],["ContentType","application/xml"]]));const i={};for(const t in this.media)t in this.media&&(i[this.media[t].extension]=this.media[t].contentType);for(const r in i)r in i&&e.appendChild(mt.createElement(t,"Default",[["Extension",r],["ContentType",i[r]]]));for(e.appendChild(mt.createElement(t,"Override",[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]])),e.appendChild(mt.createElement(t,"Override",[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]])),e.appendChild(mt.createElement(t,"Override",[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]])),r=0,s=this.worksheets.length;r<s;r++)e.appendChild(mt.createElement(t,"Override",[["PartName",`/xl/worksheets/sheet${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]));for(r=0,s=this.tables.length;r<s;r++)e.appendChild(mt.createElement(t,"Override",[["PartName",`/xl/tables/table${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]));for(r=0,s=this.drawings.length;r<s;r++)e.appendChild(mt.createElement(t,"Override",[["PartName",`/xl/drawings/drawing${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]));return t}toXML(){const t=mt.createXmlDoc(mt.schemas.spreadsheetml,"workbook"),e=t.documentElement;e.setAttribute("xmlns:r",mt.schemas.relationships);const r=mt.createElement(t,"sheets");for(let e=0,s=this.worksheets.length;e<s;e++){const s=t.createElement("sheet");typeof console<"u"&&this.worksheets[e].name.length>31&&console.log(`Microsoft Excel requires work sheet names to be less than 32 characters long, work sheet name "${this.worksheets[e].name}" is ${this.worksheets[e].name.length} characters long`),s.setAttribute("name",this.worksheets[e].name),s.setAttribute("sheetId",e+1),s.setAttribute("r:id",this.relations.getRelationshipId(this.worksheets[e])),r.appendChild(s)}e.appendChild(r);const s=mt.createElement(t,"definedNames");let i=0;for(const e in this.printTitles)if(e in this.printTitles){const r=this.printTitles[e],o=t.createElement("definedName");o.setAttribute("name","_xlnm.Print_Titles"),o.setAttribute("localSheetId",i++);let n="";r.top&&(n+=`${e}!$1:$${r.top}`,r.left&&(n+=",")),r.left&&(n+=`${e}!$A:$${r.left}`),o.appendChild(t.createTextNode(n)),s.appendChild(o)}return e.appendChild(s),t}createWorkbookRelationship(){const t=mt.createXmlDoc(mt.schemas.relationshipPackage,"Relationships");return t.documentElement.appendChild(mt.createElement(t,"Relationship",[["Id","rId1"],["Type",mt.schemas.officeDocument],["Target","xl/workbook.xml"]])),t}_generateCorePaths(t){let e,r;for(bt[this.styleSheet.id]="styles.xml",bt[this.sharedStrings.id]="sharedStrings.xml",bt[this.id]="/xl/workbook.xml",e=0,r=this.tables.length;e<r;e++)t[`/xl/tables/table${e+1}.xml`]=this.tables[e].toXML(),bt[this.tables[e].id]=`/xl/tables/table${e+1}.xml`;for(const e in this.media)if(e in this.media){const r=this.media[e];t[`/xl/media/${e}`]=r.data,bt[e]=`/xl/media/${e}`}for(e=0,r=this.drawings.length;e<r;e++)t[`/xl/drawings/drawing${e+1}.xml`]=this.drawings[e].toXML(),bt[this.drawings[e].id]=`/xl/drawings/drawing${e+1}.xml`,t[`/xl/drawings/_rels/drawing${e+1}.xml.rels`]=this.drawings[e].relations.toXML()}_prepareFilesForPackaging(t){Object.assign(t,{"/[Content_Types].xml":this.createContentTypes(),"/_rels/.rels":this.createWorkbookRelationship(),"/xl/styles.xml":this.styleSheet.toXML(),"/xl/workbook.xml":this.toXML(),"/xl/sharedStrings.xml":this.sharedStrings.toXML(),"/xl/_rels/workbook.xml.rels":this.relations.toXML()});for(const[e,r]of Object.entries(t))if(-1!==e.indexOf(".xml")||-1!==e.indexOf(".rels")){t[e]=r instanceof ct?r.toString():r.xml||(new window.XMLSerializer).serializeToString(r);let s=t[e].replace(/xmlns=""/g,"");s=s.replace(/NS[\d]+:/g,""),s=s.replace(/xmlns:NS[\d]+=""/g,""),t[e]=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n${s}`}}generateFiles(){return new Promise((t=>{const e={};this._generateCorePaths(e);for(let t=0,r=this.worksheets.length;t<r;t++)e[`/xl/worksheets/sheet${t+1}.xml`]=this.worksheets[t].toXML(),bt[this.worksheets[t].id]=`worksheets/sheet${t+1}.xml`,e[`/xl/worksheets/_rels/sheet${t+1}.xml.rels`]=this.worksheets[t].relations.toXML();return this._prepareFilesForPackaging(e),t(e)}))}}function St(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-e.length%4)%4),s=atob(e+r);return Uint8Array.from(s,(t=>t.charCodeAt(0)))}var Tt=r(7097),Ft=r(6084);const At=(t,{excelFormatId:e})=>void 0!==e?{value:t,metadata:{style:e}}:t,kt=(t,{columnDef:e,excelFormatId:r,gridOptions:s})=>({value:"string"==typeof t&&/\d/g.test(t)?Ot(t,e,s):t,metadata:{style:r}});function Ot(t,e,r){let s=t;if("string"==typeof t&&t){const i=","===(0,Tt.Nv7)("decimalSeparator",e,r,Tt.YMJ.DEFAULT_NUMBER_DECIMAL_SEPARATOR)?parseFloat(t.replace(/[^0-9,-]+/g,"").replace(",",".")):parseFloat(t.replace(/[^\d.-]/g,""));s=isNaN(i)?t:i}return s}function Pt(t,e,r,s,i=!0){const o=(0,Tt.lB_)(r);let n,a=At;return o===Tt.PUO.number&&i&&(n=Nt(t,e,r,s,"cell").excelFormat.id,a=kt),{excelFormatId:n,getDataValueParser:a}}function It(t,e){return t?.[e.groupType]?.[e.columnDef.field]??0}function Dt(t){let e;switch(t){case Tt._tQ.currency:case Tt._tQ.dollar:case Tt._tQ.dollarColored:case Tt._tQ.dollarColoredBold:e="currency";break;case Tt._tQ.percent:case Tt._tQ.percentComplete:case Tt._tQ.percentCompleteBar:case Tt._tQ.percentCompleteBarWithText:case Tt._tQ.percentSymbol:e="percent";break;case Tt._tQ.decimal:default:e="decimal"}return e}function Nt(t,e,r,s,i){let o,n="",a=r.groupTotalsExcelExportOptions?.groupType||"";const l=(0,Tt.lB_)(r);if("group"===i)switch(r.groupTotalsFormatter){case Tt.tao.avgTotals:case Tt.tao.avgTotalsCurrency:case Tt.tao.avgTotalsDollar:case Tt.tao.avgTotalsPercentage:a="avg";break;case Tt.tao.minTotals:a="min";break;case Tt.tao.maxTotals:a="max";break;case Tt.tao.sumTotals:case Tt.tao.sumTotalsBold:case Tt.tao.sumTotalsColored:case Tt.tao.sumTotalsCurrency:case Tt.tao.sumTotalsCurrencyColored:case Tt.tao.sumTotalsDollar:case Tt.tao.sumTotalsDollarColoredBold:case Tt.tao.sumTotalsDollarColored:case Tt.tao.sumTotalsDollarBold:a="sum";break;default:o=e.numberFormat}else if(l===Tt.PUO.number)switch(r.formatter){case Tt._tQ.multiple:if(Array.isArray(r.params?.formatters))for(const n of r.params.formatters){const{excelFormat:a}=Nt(t,e,{...r,formatter:n},s,i);if(a!==e.numberFormat){o=a;break}}o||(o=e.numberFormat);break;case Tt._tQ.currency:case Tt._tQ.decimal:case Tt._tQ.dollar:case Tt._tQ.dollarColored:case Tt._tQ.dollarColoredBold:case Tt._tQ.percent:case Tt._tQ.percentComplete:case Tt._tQ.percentCompleteBar:case Tt._tQ.percentCompleteBarWithText:case Tt._tQ.percentSymbol:n=Mt(r,s,"cell");break;default:o=e.numberFormat}return o||!r.formatter&&!r.groupTotalsFormatter||(n=Mt(r,s,i,a),e.hasOwnProperty(n)||(e[n]=t.createFormat({format:n})),o=e[n]),{excelFormat:o,groupType:a}}function Rt(t){const[e,r,s,i,o,n,a,l]=t?.match(/^([^\d(-]*)([(]?)([^\d]*)([-]?[\w]]?[\d\s]*[.,\d]*[\d]*[^)\s%]?)([^\d.,)]*)([)]?)([^\d]*)$/i)||[],h=(o||"").replace(/1/g,"0").replace(/[2]/g,"#");return[$t(r??""),s??"",$t(i??""),h,$t(n??""),a??"",$t(l??"")].join("").replace(",",",")}function Mt(t,e,r,s=""){let i="",o="",n="";const{minDecimal:a,maxDecimal:l,thousandSeparator:h}=function(t,e,r){let s;if("group"===r)switch(t.groupTotalsFormatter){case Tt.tao.avgTotalsCurrency:case Tt.tao.avgTotalsDollar:case Tt.tao.sumTotalsCurrency:case Tt.tao.sumTotalsCurrencyColored:case Tt.tao.sumTotalsDollar:case Tt.tao.sumTotalsDollarBold:case Tt.tao.sumTotalsDollarColored:case Tt.tao.sumTotalsDollarColoredBold:s="currency";break;case Tt.tao.avgTotalsPercentage:s="percent";break;case Tt.tao.avgTotals:case Tt.tao.minTotals:case Tt.tao.maxTotals:case Tt.tao.sumTotals:case Tt.tao.sumTotalsColored:case Tt.tao.sumTotalsBold:default:s="decimal"}else if(t.formatter===Tt._tQ.multiple&&Array.isArray(t.params?.formatters)){s="decimal";for(const e of t.params.formatters)if(s=Dt(e),"decimal"!==s)break}else s=Dt(t.formatter);return(0,Tt.TT_)(t,e,s,r)}(t,e,r),c=parseFloat(`${h?"2220":"0"}.${function(t,e){return Lt("1",t)+Lt("2",e-t)}(a,l)}`);return"group"===r&&t.groupTotalsFormatter?(o=(0,Ft.stripTags)(t.groupTotalsFormatter({[s]:{[t.field]:c}},t,e)),n=(0,Ft.stripTags)(t.groupTotalsFormatter({[s]:{[t.field]:-c}},t,e))):t.formatter&&(o=(0,Ft.stripTags)(t.formatter(0,0,c,t,{},e)),n=(0,Ft.stripTags)(t.formatter(0,0,-c,t,{},e))),o&&n&&(i=Rt(o)+";"+Rt(n)),i}function $t(t){return t?`"${t}"`:t}function Lt(t,e){let r="";for(let s=0;s<e;s++)r+=t;return r}const Bt={filename:"export",format:Tt.ptE.xlsx};class zt{constructor(){this._fileFormat=Tt.ptE.xlsx,this._columnHeaders=[],this._hasColumnTitlePreHeader=!1,this._hasGroupedItems=!1,this._pubSubService=null,this._regularCellExcelFormats={},this._groupTotalExcelFormats={},this.className="ExcelExportService"}get _datasetIdPropName(){return this._gridOptions?.datasetIdPropertyName??"id"}get _dataView(){return this._grid?.getData()}get _gridOptions(){return this._grid?.getOptions()||{}}get stylesheet(){return this._stylesheet}get stylesheetFormats(){return this._stylesheetFormats}get groupTotalExcelFormats(){return this._groupTotalExcelFormats}get regularCellExcelFormats(){return this._regularCellExcelFormats}dispose(){this._pubSubService?.unsubscribeAll()}init(t,e){if(this._grid=t,this._pubSubService=e.get("PubSubService"),this._locales=this._gridOptions?.locales??Tt.YMJ.locales,this._translaterService=this._gridOptions?.translater,this._gridOptions.enableTranslate&&(!this._translaterService||!this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be passed in the "translater" Grid Options when "enableTranslate" is enabled. (example: this.gridOptions = { enableTranslate: true, translater: this.translaterService })')}exportToExcel(t){if(!this._grid||!this._dataView||!this._pubSubService)throw new Error('[Slickgrid-Universal] it seems that the SlickGrid & DataView objects and/or PubSubService are not initialized did you forget to enable the grid option flag "enableExcelExport"?');return this._pubSubService?.publish("onBeforeExportToExcel",!0),this._excelExportOptions=(0,Ft.extend)(!0,{},{...Bt,...this._gridOptions.excelExportOptions,...t}),this._fileFormat=this._excelExportOptions.format||Tt.ptE.xlsx,this._regularCellExcelFormats={},this._groupTotalExcelFormats={},new Promise((t=>{const e={name:this._excelExportOptions.sheetName||"Sheet1"};this._workbook=new Et,this._sheet=this._workbook.createWorksheet(e),this._stylesheet=this._workbook.getStyleSheet();const r=this._stylesheet.createFormat({font:{bold:!0}}),s=this._stylesheet.createFormat({format:"@"}),i=this._stylesheet.createFormat({format:"0"});this._stylesheetFormats={boldFormat:r,numberFormat:i,stringFormat:s},this._sheet.setColumnFormats([r]);const o=this.getDataOutput();window.setTimeout((async()=>{this._gridOptions?.excelExportOptions?.customExcelHeader&&this._gridOptions.excelExportOptions.customExcelHeader(this._workbook,this._sheet);const e=this._grid?.getColumns()||[];this._sheet.setColumns(this.getColumnStyles(e));const r=this._sheet.data;let s=r;Array.isArray(r)&&Array.isArray(o)&&(s=this._sheet.data.concat(o)),this._sheet.setData(s),this._workbook.addWorksheet(this._sheet);let i=this._excelExportOptions?.mimeType;void 0===i&&(i=this._fileFormat===Tt.ptE.xls?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const n=`${this._excelExportOptions.filename}.${this._fileFormat}`;(function(t,e,r){if("node"===(null==r?void 0:r.downloadType))throw new Error('[Excel-Builder-Vanilla] Please note that `downloadExcelFile()` is currently only supporting the "browser" download type at the moment.');const s=e.match(/.*\.xls$/)?"xls":"xlsx";return function(t,e,r){const s={};return new Promise(((e,i)=>{t.generateFiles().then((t=>{for(const[e,r]of Object.entries(t)){const t=e.substr(1);-1!==e.indexOf(".xml")||-1!==e.indexOf(".rel")?s[t]=Y(r):s[t]=St(r)}return et(s,(null==r?void 0:r.zipOptions)||{},((t,s)=>{if(t)i(t);else{const t=(null==r?void 0:r.fileFormat)??"xlsx";let i=null==r?void 0:r.mimeType;void 0===i&&(i="xls"===t?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),e(new Blob([s],{type:i}))}}))}))}))}(t,0,{...r,fileFormat:s}).then((t=>{!function(t,e){const r=document.createElement("a"),s=URL.createObjectURL(e);r&&document&&(r.textContent="download",r.href=s,r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s))}(e,t)}))})(this._workbook,n,{mimeType:i}).then((()=>{this._pubSubService?.publish("onAfterExportToExcel",{filename:n,mimeType:i}),t(!0)}))}))}))}getExcelColumnNameByIndex(t){const e="ZABCDEFGHIJKLMNOPQRSTUVWXY";let r=Math.floor(t/26);const s=Math.floor(t%26);return 0===s&&r--,t>26?this.getExcelColumnNameByIndex(r)+e[s]:e[s]+""}getDataOutput(){const t=this._grid?.getColumns()||[],e=[],r=this._gridOptions?.excelExportOptions,s=r?.columnHeaderStyle;let i=this._stylesheetFormats.boldFormat.id;if(s&&(i=this._stylesheet.createFormat(s).id),this._gridOptions.createPreHeaderPanel&&this._gridOptions.showPreHeaderPanel&&!this._gridOptions.enableDraggableGrouping){const r=this._stylesheet.createFormat({alignment:{horizontal:"center"},font:{bold:!0}});e.push(this.getColumnGroupedHeaderTitlesData(t,{style:r?.id})),this._hasColumnTitlePreHeader=!0}return e.push(this.getColumnHeaderData(t,{style:i})),this.pushAllGridRowDataToArray(e,t),e}getColumnStyles(t){const e=this._dataView.getGrouping(),r=[];return Array.isArray(e)&&e.length>0&&r.push({bestFit:!0,columnStyles:this._gridOptions?.excelExportOptions?.customColumnWidth??10}),t.forEach((t=>{const e=t.excludeFromExport??!1;(void 0===t.width||t.width>0)&&!e&&r.push({bestFit:!0,width:t.excelExportOptions?.width??this._gridOptions?.excelExportOptions?.customColumnWidth??10})})),r}getColumnGroupedHeaderTitlesData(t,e){let r=[];this._groupedColumnHeaders=this.getColumnGroupedHeaderTitles(t)||[],this._groupedColumnHeaders&&Array.isArray(this._groupedColumnHeaders)&&this._groupedColumnHeaders.length>0&&(r=this._groupedColumnHeaders.map((t=>({value:t.title,metadata:e}))));let s=0;const i=this._groupedColumnHeaders.length;for(let t=0;t<i;t++)if(t+1===i||t+1<i&&this._groupedColumnHeaders[t].title!==this._groupedColumnHeaders[t+1].title){const e=this.getExcelColumnNameByIndex(s+1),r=this.getExcelColumnNameByIndex(t+1);this._sheet.mergeCells(`${e}1`,`${r}1`),s=t+1}return r}getColumnHeaderData(t,e){let r=[];this._columnHeaders=this.getColumnHeaders(t)||[],this._columnHeaders&&Array.isArray(this._columnHeaders)&&this._columnHeaders.length>0&&(r=this._columnHeaders.map((t=>({value:(0,Ft.stripTags)(t.title),metadata:e}))));const s=this.getGroupColumnTitle();return s&&r.unshift({value:s,metadata:e}),r}getGroupColumnTitle(){let t=this._excelExportOptions.groupingColumnHeaderTitle;!t&&this._gridOptions.enableTranslate&&this._translaterService?.translate?t=this._translaterService.translate(`${(0,Tt.mVi)(this._gridOptions)}GROUP_BY`):t||(t=this._locales?.TEXT_GROUP_BY);const e=this._dataView.getGrouping();return Array.isArray(e)&&e.length>0?(this._hasGroupedItems=!0,t):(this._hasGroupedItems=!1,null)}getColumnGroupedHeaderTitles(t){const e=[];return Array.isArray(t)&&t.forEach((t=>{let r="";r=t.columnGroupKey&&this._gridOptions.enableTranslate&&this._translaterService?.translate?this._translaterService.translate(t.columnGroupKey):t.columnGroup||"";const s=t.excludeFromExport||!1;(void 0===t.width||t.width>0)&&!s&&e.push({key:t.field||t.id,title:r||""})})),e}getColumnHeaders(t){const e=[];return Array.isArray(t)&&t.forEach((t=>{let r="";r=(t.nameKey||t.nameKey)&&this._gridOptions.enableTranslate&&this._translaterService?.translate?this._translaterService.translate(t.nameKey||t.nameKey):(0,Ft.getHtmlStringOutput)(t.name||"","innerHTML")||(0,Ft.titleCase)(t.field);const s=t.excludeFromExport||!1;(void 0===t.width||t.width>0)&&!s&&e.push({key:(t.field||t.id)+"",title:r})})),e}pushAllGridRowDataToArray(t,e){const r=this._dataView.getLength();for(let s=0;s<r;s++){const r=this._dataView.getItem(s);r&&!r.hasOwnProperty("getItem")&&(null!==r[this._datasetIdPropName]&&void 0!==r[this._datasetIdPropName]?t.push(this.readRegularRowData(e,s,r,s)):this._hasGroupedItems&&void 0===r.__groupTotals?t.push([this.readGroupedRowTitle(r)]):r.__groupTotals&&t.push(this.readGroupedTotalRows(e,r,s)))}return t}readRegularRowData(t,e,r,s){let i=0;const o=[],n=t.length;let a=1,l=0;const h=this._dataView.getItemMetadata(e);for(let c=0;c<n;c++){const n=t[c];if(n.excludeFromExport)continue;this._hasGroupedItems&&0===i&&o.push("");let d=1;if(this._gridOptions.enableCellRowSpan){const t=this._grid.getParentRowSpanByCell(e,c,!1);if(t){if(t.start!==e){o.push("");continue}d=t.end-t.start+1}}let p,u=1;if(h?.columns){const e=h.columns,r=e[n.id]||e[c];!isNaN(a)&&+a>1||"*"===a&&c>0||(a=r?.colspan??1),"*"===a?u=t.length-c:(u=a,(n.id in e||c in e)&&(p=n.id,l=c))}if(d>1&&!isNaN(a)&&1==+a&&n.id===p){const t=e+(this._hasColumnTitlePreHeader?3:2),r=this.getExcelColumnNameByIndex(c+1),s=this.getExcelColumnNameByIndex(c+1);this._sheet.mergeCells(`${r}${t}`,`${s}${t+d-1}`)}if("*"===a&&c>0||!isNaN(a)&&+a>1&&n.id!==p){const t=e+(this._hasColumnTitlePreHeader?3:2);if("number"==typeof a&&u-1==1){const e=this.getExcelColumnNameByIndex(l+1),r=this.getExcelColumnNameByIndex(c+1);this._sheet.mergeCells(`${e}${t}`,`${r}${t+d-1}`),o.push("")}else if("*"===a&&1===u){const e=this.getExcelColumnNameByIndex(c+1);this._sheet.mergeCells(`A${t}`,`${e}${t+d-1}`)}else o.push("");"number"==typeof a&&!isNaN(a)&&+a>1&&(u=a--)}else{let t="";const a=(0,Tt.lB_)(n),l={...this._excelExportOptions};if(!1!==n.exportWithFormatter&&(0,Tt.vsW)(a)&&(l.exportWithFormatter=!0),t=(0,Tt.qgn)(e,c,n,r,this._grid,l),!this._regularCellExcelFormats.hasOwnProperty(n.id)){const t=n.excelExportOptions?.autoDetectCellFormat??this._excelExportOptions?.autoDetectCellFormat,e=Pt(this._stylesheet,this._stylesheetFormats,n,this._grid,t);n.excelExportOptions?.style&&(e.excelFormatId=this._stylesheet.createFormat(n.excelExportOptions.style).id),n.excelExportOptions?.valueParserCallback&&(e.getDataValueParser=n.excelExportOptions.valueParserCallback),this._regularCellExcelFormats[n.id]=e}"string"==typeof t&&(n.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(t=(0,Ft.stripTags)(t));const{excelFormatId:h,getDataValueParser:d}=this._regularCellExcelFormats[n.id];t=d(t,{columnDef:n,excelFormatId:h,stylesheet:this._stylesheet,gridOptions:this._gridOptions,dataRowIdx:s,dataContext:r}),o.push(t),i++}}return o}readGroupedRowTitle(t){const e=(0,Ft.stripTags)(t.title);if(this._excelExportOptions?.addGroupIndentation){const r=this._excelExportOptions?.groupCollapsedSymbol||"",s=this._excelExportOptions?.groupExpandedSymbol||"";return(t.collapsed?r:s)+" "+(0,Ft.addWhiteSpaces)(5*t.level)+e}return e}readGroupedTotalRows(t,e,r){const s=[this._excelExportOptions.groupingAggregatorRowText||""];return t.forEach((t=>{let i="";const o=(0,Tt.lB_)(t),n=t.excludeFromExport||!1;if(t.exportCustomGroupTotalsFormatter){const r=t.exportCustomGroupTotalsFormatter(e,t,this._grid);i=r instanceof HTMLElement?r.textContent||"":r}const a=t.excelExportOptions?.autoDetectCellFormat??this._excelExportOptions?.autoDetectCellFormat;if(o===Tt.PUO.number&&!1!==a){let s=this._groupTotalExcelFormats[t.id];s?.groupType||(s=Nt(this._stylesheet,this._stylesheetFormats,t,this._grid,"group"),t.groupTotalsExcelExportOptions?.style&&(s.excelFormat=this._stylesheet.createFormat(t.groupTotalsExcelExportOptions.style)),this._groupTotalExcelFormats[t.id]=s);const o=t.groupTotalsExcelExportOptions?.valueParserCallback??It;if(void 0!==e[s.groupType]?.[t.field]){const n=o(e,{columnDef:t,groupType:s.groupType,excelFormatId:s.excelFormat?.id,stylesheet:this._stylesheet,dataRowIdx:r});i="object"==typeof n&&n.hasOwnProperty("metadata")?n:i={value:n,metadata:{style:s.excelFormat?.id}}}}else if(t.groupTotalsFormatter){const r=t.groupTotalsFormatter(e,t,this._grid);i=r instanceof HTMLElement?r.textContent||"":r}"string"==typeof i&&(t.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(i=(0,Ft.stripTags)(i)),(void 0===t.width||t.width>0)&&!n&&s.push(i)})),s}}}}]);