"use strict";(self.webpackChunkaurelia_slickgrid_demo=self.webpackChunkaurelia_slickgrid_demo||[]).push([[504],{92504:(t,e,r)=>{r.d(e,{S:()=>Ht});var s={},i=Uint8Array,n=Uint16Array,o=Int32Array,l=new i([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new i([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new i([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(t,e){for(var r=new n(31),s=0;s<31;++s)r[s]=e+=1<<t[s-1];var i=new o(r[30]);for(s=1;s<30;++s)for(var l=r[s];l<r[s+1];++l)i[l]=l-r[s]<<5|s;return{b:r,r:i}},d=c(l,2),p=d.b,u=d.r;p[28]=258,u[258]=28;for(var m=c(a,0),f=(m.b,m.r),g=new n(32768),b=0;b<32768;++b){var x=(43690&b)>>1|(21845&b)<<1;x=(61680&(x=(52428&x)>>2|(13107&x)<<2))>>4|(3855&x)<<4,g[b]=((65280&x)>>8|(255&x)<<8)>>1}var y=function(t,e,r){for(var s=t.length,i=0,o=new n(e);i<s;++i)t[i]&&++o[t[i]-1];var l,a=new n(e);for(i=1;i<e;++i)a[i]=a[i-1]+o[i-1]<<1;if(r){l=new n(1<<e);var h=15-e;for(i=0;i<s;++i)if(t[i])for(var c=i<<4|t[i],d=e-t[i],p=a[t[i]-1]++<<d,u=p|(1<<d)-1;p<=u;++p)l[g[p]>>h]=c}else for(l=new n(s),i=0;i<s;++i)t[i]&&(l[i]=g[a[t[i]-1]++]>>15-t[i]);return l},C=new i(288);for(b=0;b<144;++b)C[b]=8;for(b=144;b<256;++b)C[b]=9;for(b=256;b<280;++b)C[b]=7;for(b=280;b<288;++b)C[b]=8;var w=new i(32);for(b=0;b<32;++b)w[b]=5;var _=y(C,9,0),v=y(w,5,0),E=function(t){return(t+7)/8|0},S=function(t,e,r){return(null==e||e<0)&&(e=0),(null==r||r>t.length)&&(r=t.length),new i(t.subarray(e,r))},T=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(t,e,r){var s=new Error(e||T[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,F),!r)throw s;return s},A=function(t,e,r){r<<=7&e;var s=e/8|0;t[s]|=r,t[s+1]|=r>>8},k=function(t,e,r){r<<=7&e;var s=e/8|0;t[s]|=r,t[s+1]|=r>>8,t[s+2]|=r>>16},O=function(t,e){for(var r=[],s=0;s<t.length;++s)t[s]&&r.push({s,f:t[s]});var o=r.length,l=r.slice();if(!o)return{t:L,l:0};if(1==o){var a=new i(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort((function(t,e){return t.f-e.f})),r.push({s:-1,f:25001});var h=r[0],c=r[1],d=0,p=1,u=2;for(r[0]={s:-1,f:h.f+c.f,l:h,r:c};p!=o-1;)h=r[r[d].f<r[u].f?d++:u++],c=r[d!=p&&r[d].f<r[u].f?d++:u++],r[p++]={s:-1,f:h.f+c.f,l:h,r:c};var m=l[0].s;for(s=1;s<o;++s)l[s].s>m&&(m=l[s].s);var f=new n(m+1),g=N(r[p-1],f,0);if(g>e){s=0;var b=0,x=g-e,y=1<<x;for(l.sort((function(t,e){return f[e.s]-f[t.s]||t.f-e.f}));s<o;++s){var C=l[s].s;if(!(f[C]>e))break;b+=y-(1<<g-f[C]),f[C]=e}for(b>>=x;b>0;){var w=l[s].s;f[w]<e?b-=1<<e-f[w]++-1:++s}for(;s>=0&&b;--s){var _=l[s].s;f[_]==e&&(--f[_],++b)}g=e}return{t:new i(f),l:g}},N=function(t,e,r){return-1==t.s?Math.max(N(t.l,e,r+1),N(t.r,e,r+1)):e[t.s]=r},P=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new n(++e),s=0,i=t[0],o=1,l=function(t){r[s++]=t},a=1;a<=e;++a)if(t[a]==i&&a!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)l(32754);o>2&&(l(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(l(i),--o;o>6;o-=6)l(8304);o>2&&(l(o-3<<5|8208),o=0)}for(;o--;)l(i);o=1,i=t[a]}return{c:r.subarray(0,s),n:e}},D=function(t,e){for(var r=0,s=0;s<e.length;++s)r+=t[s]*e[s];return r},I=function(t,e,r){var s=r.length,i=E(e+2);t[i]=255&s,t[i+1]=s>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var n=0;n<s;++n)t[i+n+4]=r[n];return 8*(i+4+s)},R=function(t,e,r,s,i,o,c,d,p,u,m){A(e,m++,r),++i[256];for(var f=O(i,15),g=f.t,b=f.l,x=O(o,15),E=x.t,S=x.l,T=P(g),F=T.c,N=T.n,R=P(E),M=R.c,L=R.n,$=new n(19),z=0;z<F.length;++z)++$[31&F[z]];for(z=0;z<M.length;++z)++$[31&M[z]];for(var B=O($,7),H=B.t,V=B.l,G=19;G>4&&!H[h[G-1]];--G);var j,X,W,U,q=u+5<<3,K=D(i,C)+D(o,w)+c,Z=D(i,g)+D(o,E)+c+14+3*G+D($,H)+2*$[16]+3*$[17]+7*$[18];if(p>=0&&q<=K&&q<=Z)return I(e,m,t.subarray(p,p+u));if(A(e,m,1+(Z<K)),m+=2,Z<K){j=y(g,b,0),X=g,W=y(E,S,0),U=E;var J=y(H,V,0);for(A(e,m,N-257),A(e,m+5,L-1),A(e,m+10,G-4),m+=14,z=0;z<G;++z)A(e,m+3*z,H[h[z]]);m+=3*G;for(var Y=[F,M],Q=0;Q<2;++Q){var tt=Y[Q];for(z=0;z<tt.length;++z){var et=31&tt[z];A(e,m,J[et]),m+=H[et],et>15&&(A(e,m,tt[z]>>5&127),m+=tt[z]>>12)}}}else j=_,X=C,W=v,U=w;for(z=0;z<d;++z){var rt=s[z];if(rt>255){k(e,m,j[257+(et=rt>>18&31)]),m+=X[et+257],et>7&&(A(e,m,rt>>23&31),m+=l[et]);var st=31&rt;k(e,m,W[st]),m+=U[st],st>3&&(k(e,m,rt>>5&8191),m+=a[st])}else k(e,m,j[rt]),m+=X[rt]}return k(e,m,j[256]),m+X[256]},M=new o([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),L=new i(0),$=function(t,e,r,s,h,c){var d=c.z||t.length,p=new i(s+d+5*(1+Math.ceil(d/7e3))+h),m=p.subarray(s,p.length-h),g=c.l,b=7&(c.r||0);if(e){b&&(m[0]=c.r>>3);for(var x=M[e-1],y=x>>13,C=8191&x,w=(1<<r)-1,_=c.p||new n(32768),v=c.h||new n(w+1),T=Math.ceil(r/3),F=2*T,A=function(e){return(t[e]^t[e+1]<<T^t[e+2]<<F)&w},k=new o(25e3),O=new n(288),N=new n(32),P=0,D=0,L=c.i||0,$=0,z=c.w||0,B=0;L+2<d;++L){var H=A(L),V=32767&L,G=v[H];if(_[V]=G,v[H]=V,z<=L){var j=d-L;if((P>7e3||$>24576)&&(j>423||!g)){b=R(t,m,0,k,O,N,D,$,B,L-B,b),$=P=D=0,B=L;for(var X=0;X<286;++X)O[X]=0;for(X=0;X<30;++X)N[X]=0}var W=2,U=0,q=C,K=V-G&32767;if(j>2&&H==A(L-K))for(var Z=Math.min(y,j)-1,J=Math.min(32767,L),Y=Math.min(258,j);K<=J&&--q&&V!=G;){if(t[L+W]==t[L+W-K]){for(var Q=0;Q<Y&&t[L+Q]==t[L+Q-K];++Q);if(Q>W){if(W=Q,U=K,Q>Z)break;var tt=Math.min(K,Q-2),et=0;for(X=0;X<tt;++X){var rt=L-K+X&32767,st=rt-_[rt]&32767;st>et&&(et=st,G=rt)}}}K+=(V=G)-(G=_[V])&32767}if(U){k[$++]=268435456|u[W]<<18|f[U];var it=31&u[W],nt=31&f[U];D+=l[it]+a[nt],++O[257+it],++N[nt],z=L+W,++P}else k[$++]=t[L],++O[t[L]]}}for(L=Math.max(L,z);L<d;++L)k[$++]=t[L],++O[t[L]];b=R(t,m,g,k,O,N,D,$,B,L-B,b),g||(c.r=7&b|m[b/8|0]<<3,b-=7,c.h=v,c.p=_,c.i=L,c.w=z)}else{for(L=c.w||0;L<d+g;L+=65535){var ot=L+65535;ot>=d&&(m[b/8|0]=g,ot=d),b=I(m,b+1,t.subarray(L,ot))}c.i=d}return S(p,0,s+E(b)+h)},z=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,s=9;--s;)r=(1&r&&-306674912)^r>>>1;t[e]=r}return t}(),B=function(){var t=-1;return{p:function(e){for(var r=t,s=0;s<e.length;++s)r=z[255&r^e[s]]^r>>>8;t=r},d:function(){return~t}}},H=function(t,e,r,s,n){if(!n&&(n={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),l=new i(o.length+t.length);l.set(o),l.set(t,o.length),t=l,n.w=o.length}return $(t,null==e.level?6:e.level,null==e.mem?n.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):20:12+e.mem,r,s,n)},V=function(t,e){var r={};for(var s in t)r[s]=t[s];for(var s in e)r[s]=e[s];return r},G=function(t,e,r){for(var s=t(),i=t.toString(),n=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<s.length;++o){var l=s[o],a=n[o];if("function"==typeof l){e+=";"+a+"=";var h=l.toString();if(l.prototype)if(-1!=h.indexOf("[native code]")){var c=h.indexOf(" ",8)+1;e+=h.slice(c,h.indexOf("(",c))}else for(var d in e+=h,l.prototype)e+=";"+a+".prototype."+d+"="+l.prototype[d].toString();else e+=h}else r[a]=l}return e},j=[],X=function(){return[i,n,o,l,a,h,u,f,_,C,v,w,g,M,L,y,A,k,O,N,P,D,I,R,E,S,$,H,K,W]},W=function(t){return postMessage(t,[t.buffer])},U=function(t,e,r,i,n,o){var l=function(t,e,r,i){if(!j[r]){for(var n="",o={},l=t.length-1,a=0;a<l;++a)n=G(t[a],n,o);j[r]={c:G(t[l],n,o),e:o}}var h=V({},j[r].e);return function(t,e,r,i,n){var o=new Worker(s[e]||(s[e]=URL.createObjectURL(new Blob([t+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return o.onmessage=function(t){var e=t.data,r=e.$e$;if(r){var s=new Error(r[0]);s.code=r[1],s.stack=r[2],n(s,null)}else n(null,e)},o.postMessage(r,i),o}(j[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,h,function(t){var e=[];for(var r in t)t[r].buffer&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e}(h),i)}(r,i,n,(function(t,e){l.terminate(),o(t,e)}));return l.postMessage([t,e],e.consume?[t.buffer]:[]),function(){l.terminate()}},q=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8};function K(t,e){return H(t,e||{},0,0)}var Z=function(t,e,r,s){for(var n in t){var o=t[n],l=e+n,a=s;Array.isArray(o)&&(a=V(s,o[1]),o=o[0]),o instanceof i?r[l]=[o,a]:(r[l+="/"]=[new i(0),a],Z(o,l,r,s))}},J="undefined"!=typeof TextEncoder&&new TextEncoder,Y="undefined"!=typeof TextDecoder&&new TextDecoder;try{Y.decode(L,{stream:!0})}catch(t){}function Q(t,e){if(e){for(var r=new i(t.length),s=0;s<t.length;++s)r[s]=t.charCodeAt(s);return r}if(J)return J.encode(t);var n=t.length,o=new i(t.length+(t.length>>1)),l=0,a=function(t){o[l++]=t};for(s=0;s<n;++s){if(l+5>o.length){var h=new i(l+8+(n-s<<1));h.set(o),o=h}var c=t.charCodeAt(s);c<128||e?a(c):c<2048?(a(192|c>>6),a(128|63&c)):c>55295&&c<57344?(a(240|(c=65536+(1047552&c)|1023&t.charCodeAt(++s))>>18),a(128|c>>12&63),a(128|c>>6&63),a(128|63&c)):(a(224|c>>12),a(128|c>>6&63),a(128|63&c))}return S(o,0,l)}var tt=function(t){var e=0;if(t)for(var r in t){var s=t[r].length;s>65535&&F(9),e+=s+4}return e},et=function(t,e,r,s,i,n,o,l){var a=s.length,h=r.extra,c=l&&l.length,d=tt(h);q(t,e,null!=o?33639248:67324752),e+=4,null!=o&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(n<0&&8),t[e++]=i&&8,t[e++]=255&r.compression,t[e++]=r.compression>>8;var p=new Date(null==r.mtime?Date.now():r.mtime),u=p.getFullYear()-1980;if((u<0||u>119)&&F(10),q(t,e,u<<25|p.getMonth()+1<<21|p.getDate()<<16|p.getHours()<<11|p.getMinutes()<<5|p.getSeconds()>>1),e+=4,-1!=n&&(q(t,e,r.crc),q(t,e+4,n<0?-n-2:n),q(t,e+8,r.size)),q(t,e+12,a),q(t,e+14,d),e+=16,null!=o&&(q(t,e,c),q(t,e+6,r.attrs),q(t,e+10,o),e+=14),t.set(s,e),e+=a,d)for(var m in h){var f=h[m],g=f.length;q(t,e,+m),q(t,e+2,g),t.set(f,e+4),e+=4+g}return c&&(t.set(l,e),e+=c),e},rt=function(t,e,r,s,i){q(t,e,101010256),q(t,e+8,r),q(t,e+10,r),q(t,e+12,s),q(t,e+16,i)};var st="function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout?setTimeout:function(t){t()},it=Object.defineProperty,nt=(t,e,r)=>(((t,e,r)=>{e in t?it(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r})(t,"symbol"!=typeof e?e+"":e,r),r);const ot={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},lt=t=>("string"!=typeof t&&(t=`${t}`),t.replace(/[&<>"']/g,(t=>ot[t])));function at(t){const e=typeof t;return null!=t&&("object"===e||"function"===e)}function ht(t){if("object"!=typeof t||null===t||"[object Object]"!==Object.prototype.toString.call(t))return!1;const e=Object.getPrototypeOf(t);if(null===e)return!0;const r=Object.prototype.hasOwnProperty.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(t)}function ct(t){return null!=t&&"string"==typeof t.valueOf()}const dt={};function pt(t="$lodash$"){dt[t]||(dt[t]=0);const e=++dt[t];return"$lodash$"===t?`${e}`:`${t}${e}`}class ut{constructor(t,e){nt(this,"documentElement"),this.documentElement=this.createElement(e),this.documentElement.setAttribute("xmlns",t)}createElement(t){return new ft({nodeName:t})}createTextNode(t){return new mt(t)}toString(){return this.documentElement.toString()}}nt(ut,"Node",{Create:t=>{switch(t.type){case"XML":return new ft(t);case"TEXT":return new mt(t.nodeValue);default:return null}}});class mt{constructor(t){nt(this,"nodeValue"),this.nodeValue=t}toJSON(){return{nodeValue:this.nodeValue,type:"TEXT"}}toString(){return lt(this.nodeValue)}}class ft{constructor(t){if(nt(this,"nodeName",""),nt(this,"children"),nt(this,"nodeValue"),nt(this,"attributes"),nt(this,"firstChild"),this.nodeName=t.nodeName,this.children=[],this.nodeValue=t.nodeValue||"",this.attributes={},t.children)for(let e=0,r=t.children.length;e<r;e++)this.appendChild(ut.Node.Create(t.children[e]));if(t.attributes)for(const e in t.attributes)t.attributes.hasOwnProperty(e)&&this.setAttribute(e,t.attributes[e])}toString(){let t=`<${this.nodeName}`;for(const e in this.attributes)this.attributes.hasOwnProperty(e)&&(t=`${t} ${e}="${lt(this.attributes[e])}"`);let e="";for(let t=0,r=this.children.length;t<r;t++)e+=this.children[t].toString();return t+=e?`>${e}</${this.nodeName}>`:"/>",t}toJSON(){const t=[];for(let e=0,r=this.children.length;e<r;e++)t.push(this.children[e].toJSON());return{nodeName:this.nodeName,children:t,nodeValue:this.nodeValue,attributes:this.attributes,type:"XML"}}setAttribute(t,e){if(null===e)return delete this.attributes[t],void delete this[t];this.attributes[t]=e,this[t]=e}appendChild(t){this.children.push(t),this.firstChild=this.children[0]}cloneNode(t){return new ft(this.toJSON())}}const gt=class t{static uniqueId(e){return t._idSpaces[e]||(t._idSpaces[e]=1),t._idSpaces[e]++}static createXmlDoc(t,e){return new ut(t||null,e)}static createElement(t,e,r){const s=t.createElement(e);let i=(r=r||[]).length;for(;i--;)s.setAttribute(r[i][0],r[i][1]);return s}static setAttributesOnDoc(t,e){for(let[r,s]of Object.entries(e))ht(s)&&(null!==s.v&&void 0!==s.v?s.type===Boolean&&(s=s.v?"1":"0"):s=null),null!=s&&t.setAttribute(r,s)}static positionToLetterRef(e,r){let s,i=1,n=e,o="";if(t.LETTER_REFS[e])return t.LETTER_REFS[e].concat(r);for(;n>0;)n-=Math.pow(26,i-1),s=n%Math.pow(26,i),n-=s,s/=Math.pow(26,i-1),o="ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(s)+o,i+=1;return t.LETTER_REFS[e]=o,o.concat(String(r))}};nt(gt,"_idSpaces",{}),nt(gt,"LETTER_REFS",{}),nt(gt,"schemas",{worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"});let bt=gt;const xt={};class yt{constructor(){nt(this,"relations",{}),nt(this,"lastId",1),pt("rId")}importData(t){this.relations=t.relations,this.lastId=t.lastId}exportData(){return{relations:this.relations,lastId:this.lastId}}addRelation(t,e){return this.relations[t.id]={id:pt("rId"),schema:bt.schemas[e],object:t},this.relations[t.id].id}getRelationshipId(t){return this.relations[t.id]?this.relations[t.id].id:null}toXML(){const t=bt.createXmlDoc(bt.schemas.relationshipPackage,"Relationships"),e=t.documentElement;for(const[r,s]of Object.entries(this.relations)){const i=bt.createElement(t,"Relationship",[["Id",s.id],["Type",s.schema],["Target",s.object.target||xt[r]]]);s.object.targetMode&&i.setAttribute("TargetMode",s.object.targetMode),e.appendChild(i)}return t}}class Ct{constructor(){nt(this,"state",null),nt(this,"xSplit",null),nt(this,"ySplit",null),nt(this,"activePane","bottomRight"),nt(this,"topLeftCell",null),nt(this,"_freezePane")}freezePane(t,e,r){this._freezePane={xSplit:t,ySplit:e,cell:r}}exportXML(t){const e=t.createElement("pane");return null!==this.state&&(e.setAttribute("xSplit",this._freezePane.xSplit),e.setAttribute("ySplit",this._freezePane.ySplit),e.setAttribute("topLeftCell",this._freezePane.cell),e.setAttribute("activePane","bottomRight"),e.setAttribute("state","frozen")),e}}class wt{constructor(){nt(this,"strings",{}),nt(this,"stringArray",[]),nt(this,"id",pt("SharedStrings"))}addString(t){return this.strings[t]=this.stringArray.length,this.stringArray[this.stringArray.length]=t,this.strings[t]}exportData(){return this.strings}toXML(){const t=bt.createXmlDoc(bt.schemas.spreadsheetml,"sst"),e=t.documentElement;this.stringArray.reverse();let r=this.stringArray.length;e.setAttribute("count",r),e.setAttribute("uniqueCount",r);const s=t.createElement("si"),i=t.createElement("t");i.appendChild(t.createTextNode("--placeholder--")),s.appendChild(i);const n=this.stringArray;for(;r--;){const t=s.cloneNode(!0);"string"==typeof n[r]&&n[r].match(/\s+/)&&t.firstChild.setAttribute("xml:space","preserve"),t.firstChild.firstChild.nodeValue=n[r],e.appendChild(t)}return t}}class _t{constructor(t){nt(this,"pane"),nt(this,"showZeros",null),nt(this,"defaultGridColor",null),nt(this,"colorId",null),nt(this,"rightToLeft",null),nt(this,"showFormulas",null),nt(this,"showGridLines",null),nt(this,"showOutlineSymbols",null),nt(this,"showRowColHeaders",null),nt(this,"showRuler",null),nt(this,"showWhiteSpace",null),nt(this,"tabSelected",null),nt(this,"topLeftCell",null),nt(this,"viewType",null),nt(this,"windowProtection",null),nt(this,"zoomScale",null),nt(this,"zoomScaleNormal",null),nt(this,"zoomScalePageLayoutView",null),nt(this,"zoomScaleSheetLayoutView",null);const e=t||{};this.pane=e.pane||new Ct}freezePane(t,e,r){this.pane.state="frozen",this.pane.xSplit=t,this.pane.ySplit=e,this.pane.topLeftCell=r}exportXML(t){const e=t.createElement("sheetViews"),r=t.createElement("sheetView");return bt.setAttributesOnDoc(r,{workbookViewId:0,showZeros:{v:this.showZeros,type:Boolean},defaultGridColor:{v:this.defaultGridColor,type:Boolean},colorId:this.colorId,rightToLeft:{v:this.rightToLeft,type:Boolean},showFormulas:{v:this.showFormulas,type:Boolean},showGridLines:{v:this.showGridLines,type:Boolean},showOutlineSymbols:{v:this.showOutlineSymbols,type:Boolean},showRowColHeaders:{v:this.showRowColHeaders,type:Boolean},showRuler:{v:this.showRuler,type:Boolean},showWhiteSpace:{v:this.showWhiteSpace,type:Boolean},tabSelected:{v:this.tabSelected,type:Boolean},viewType:this.viewType,windowProtection:{v:this.windowProtection,type:Boolean},zoomScale:{v:this.zoomScale,type:Boolean},zoomScaleNormal:this.zoomScaleNormal,zoomScalePageLayoutView:this.zoomScalePageLayoutView,zoomScaleSheetLayoutView:this.zoomScaleSheetLayoutView}),r.appendChild(this.pane.exportXML(t)),e.appendChild(r),e}}class vt{constructor(){nt(this,"id",pt("StyleSheet")),nt(this,"cellStyles",[{name:"Normal",xfId:"0",builtinId:"0"}]),nt(this,"defaultTableStyle",!1),nt(this,"differentialStyles",[{}]),nt(this,"masterCellFormats",[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfid:0}]),nt(this,"masterCellStyles",[{numFmtId:0,fontId:0,fillId:0,borderId:0}]),nt(this,"fonts",[{}]),nt(this,"numberFormatters",[]),nt(this,"fills",[{},{type:"pattern",patternType:"gray125",fgColor:"FF333333",bgColor:"FF333333"}]),nt(this,"borders",[{top:{},left:{},right:{},bottom:{},diagonal:{}}]),nt(this,"tableStyles",[])}createSimpleFormatter(t){const e={id:this.masterCellFormats.length};return"date"===t&&(e.numFmtId=14),this.masterCellFormats.push(e),e}createFill(t){const e=this.fills.length,r=t;return r.id=e,this.fills.push(r),r}createNumberFormatter(t){const e={id:this.numberFormatters.length+100,formatCode:t};return this.numberFormatters.push(e),e}createFormat(t){const e={id:this.masterCellFormats.length};if(t.protection&&(e.protection=t.protection),t.font&&at(t.font))e.fontId=this.createFontStyle(t.font).id;else if(t.font){if(Number.isNaN(parseInt(t.font,10)))throw new Error("Passing a non-numeric font id is not supported");e.fontId=t.font}if(t.format&&ct(t.format))e.numFmtId=this.createNumberFormatter(t.format).id;else if(t.format){if(Number.isNaN(parseInt(t.format,10)))throw new Error("Invalid number formatter id");e.numFmtId=t.format}if(t.border&&at(t.border))e.borderId=this.createBorderFormatter(t.border).id;else if(t.border){if(Number.isNaN(parseInt(t.border,10)))throw new Error("Passing a non-numeric border id is not supported");e.borderId=t.border}if(t.fill&&at(t.fill))e.fillId=this.createFill(t.fill).id;else if(t.fill){if(Number.isNaN(parseInt(t.fill,10)))throw new Error("Passing a non-numeric fill id is not supported");e.fillId=t.fill}return t.alignment&&at(t.alignment)&&(e.alignment=(r=t.alignment,["horizontal","justifyLastLine","readingOrder","relativeIndent","shrinkToFit","textRotation","vertical","wrapText"].reduce(((t,e)=>(null!=r&&r.hasOwnProperty(e)&&(t[e]=r[e]),t)),{}))),this.masterCellFormats.push(e),e;var r}createDifferentialStyle(t){const e=this.differentialStyles.length,r={id:e};return t.font&&at(t.font)&&(r.font=t.font),t.border&&at(t.border)&&(r.border=Object.assign({top:{},left:{},right:{},bottom:{},diagonal:{}},t.border)),t.fill&&at(t.fill)&&(r.fill=t.fill),t.alignment&&at(t.alignment)&&(r.alignment=t.alignment),t.format&&ct(t.format)&&(r.numFmt=t.format),this.differentialStyles[e]=r,r}createTableStyle(t){this.tableStyles.push(t)}createBorderFormatter(t){return t={top:{},left:{},right:{},bottom:{},diagonal:{},id:this.borders.length,...t},this.borders.push(t),t}createFontStyle(t){const e={id:this.fonts.length};return t.bold&&(e.bold=!0),t.italic&&(e.italic=!0),t.superscript&&(e.vertAlign="superscript"),t.subscript&&(e.vertAlign="subscript"),t.underline&&("string"==typeof t.underline&&["double","singleAccounting","doubleAccounting"].includes(t.underline)?e.underline=t.underline:e.underline=!0),t.strike&&(e.strike=!0),t.outline&&(e.outline=!0),t.shadow&&(e.shadow=!0),t.size&&(e.size=t.size),t.color&&(e.color=t.color),t.fontName&&(e.fontName=t.fontName),this.fonts.push(e),e}exportBorders(t){const e=t.createElement("borders");e.setAttribute("count",this.borders.length);for(let r=0,s=this.borders.length;r<s;r++)e.appendChild(this.exportBorder(t,this.borders[r]));return e}exportBorder(t,e){const r=t.createElement("border"),s=r=>{const s=t.createElement(r);return e[r].style&&s.setAttribute("style",e[r].style),e[r].color&&s.appendChild(this.exportColor(t,e[r].color)),s};return r.appendChild(s("left")),r.appendChild(s("right")),r.appendChild(s("top")),r.appendChild(s("bottom")),r.appendChild(s("diagonal")),r}exportColor(t,e){const r=t.createElement("color");return ct(e)?(r.setAttribute("rgb",e),r):(void 0!==e.tint&&r.setAttribute("tint",e.tint),void 0!==e.auto&&r.setAttribute("auto",String(!!e.auto)),void 0!==e.theme&&r.setAttribute("theme",e.theme),r)}exportMasterCellFormats(t){const e=bt.createElement(t,"cellXfs",[["count",this.masterCellFormats.length]]);for(let r=0,s=this.masterCellFormats.length;r<s;r++){const s=this.masterCellFormats[r];e.appendChild(this.exportCellFormatElement(t,s))}return e}exportMasterCellStyles(t){const e=bt.createElement(t,"cellStyleXfs",[["count",this.masterCellStyles.length]]);for(let r=0,s=this.masterCellStyles.length;r<s;r++){const s=this.masterCellStyles[r];e.appendChild(this.exportCellFormatElement(t,s))}return e}exportCellFormatElement(t,e){const r=t.createElement("xf"),s=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","xfId"],i=Object.keys(e).filter((t=>-1!==s.indexOf(t)));if(e.alignment){const s=e.alignment;r.appendChild(this.exportAlignment(t,s))}e.protection&&(r.appendChild(this.exportProtection(t,e.protection)),r.setAttribute("applyProtection","1"));let n=i.length;for(;n--;)r.setAttribute(i[n],e[i[n]]);return e.fillId&&r.setAttribute("applyFill","1"),e.fontId&&r.setAttribute("applyFont","1"),e.borderId&&r.setAttribute("applyBorder","1"),e.alignment&&r.setAttribute("applyAlignment","1"),e.numFmtId&&r.setAttribute("applyNumberFormat","1"),void 0!==e.numFmtId&&void 0===e.xfId&&r.setAttribute("xfId","0"),r}exportAlignment(t,e){const r=t.createElement("alignment"),s=Object.keys(e);for(let t=0,i=s.length;t<i;t++)r.setAttribute(s[t],e[s[t]]);return r}exportFonts(t){const e=t.createElement("fonts");e.setAttribute("count",String(this.fonts.length));for(let r=0,s=this.fonts.length;r<s;r++){const s=this.fonts[r];e.appendChild(this.exportFont(t,s))}return e}exportFont(t,e){const r=t.createElement("font");if(e.size){const s=t.createElement("sz");s.setAttribute("val",e.size),r.appendChild(s)}if(e.fontName){const s=t.createElement("name");s.setAttribute("val",e.fontName),r.appendChild(s)}if(e.bold&&r.appendChild(t.createElement("b")),e.italic&&r.appendChild(t.createElement("i")),e.vertAlign){const s=t.createElement("vertAlign");s.setAttribute("val",e.vertAlign),r.appendChild(s)}if(e.underline){const s=t.createElement("u");!0!==e.underline&&s.setAttribute("val",e.underline),r.appendChild(s)}return e.strike&&r.appendChild(t.createElement("strike")),e.shadow&&r.appendChild(t.createElement("shadow")),e.outline&&r.appendChild(t.createElement("outline")),e.color&&r.appendChild(this.exportColor(t,e.color)),r}exportFills(t){const e=t.createElement("fills");e.setAttribute("count",String(this.fills.length));for(let r=0,s=this.fills.length;r<s;r++){const s=this.fills[r];e.appendChild(this.exportFill(t,s))}return e}exportFill(t,e){let r;const s=t.createElement("fill");return"pattern"===e.type?(r=this.exportPatternFill(t,e),s.appendChild(r)):"gradient"===e.type&&(r=this.exportGradientFill(t,e),s.appendChild(r)),s}exportGradientFill(t,e){const r=t.createElement("gradientFill");e.degree?r.setAttribute("degree",e.degree):e.left&&(r.setAttribute("left",e.left),r.setAttribute("right",e.right),r.setAttribute("top",e.top),r.setAttribute("bottom",e.bottom));const s=t.createElement("stop");s.setAttribute("position",e.start.pureAt||0);const i=t.createElement("color");"string"==typeof e.start||e.start.color?i.setAttribute("rgb",e.start.color||e.start):e.start.theme&&i.setAttribute("theme",e.start.theme);const n=t.createElement("stop"),o=t.createElement("color");return n.setAttribute("position",e.end.pureAt||1),"string"==typeof e.start||e.end.color?o.setAttribute("rgb",e.end.color||e.end):e.end.theme&&o.setAttribute("theme",e.end.theme),s.appendChild(i),n.appendChild(o),r.appendChild(s),r.appendChild(n),r}exportPatternFill(t,e){const r=bt.createElement(t,"patternFill",[["patternType",e.patternType]]);e.bgColor||(e.bgColor="FFFFFFFF"),e.fgColor||(e.fgColor="FFFFFFFF");const s=t.createElement("bgColor");ct(e.bgColor)?s.setAttribute("rgb",e.bgColor):e.bgColor.theme?s.setAttribute("theme",e.bgColor.theme):s.setAttribute("rgb",e.bgColor.rbg);const i=t.createElement("fgColor");return ct(e.fgColor)?i.setAttribute("rgb",e.fgColor):e.fgColor.theme?i.setAttribute("theme",e.fgColor.theme):i.setAttribute("rgb",e.fgColor.rbg),r.appendChild(i),r.appendChild(s),r}exportNumberFormatters(t){const e=t.createElement("numFmts");e.setAttribute("count",String(this.numberFormatters.length));for(let r=0,s=this.numberFormatters.length;r<s;r++){const s=this.numberFormatters[r];e.appendChild(this.exportNumberFormatter(t,s))}return e}exportNumberFormatter(t,e){const r=t.createElement("numFmt");return r.setAttribute("numFmtId",e.id),r.setAttribute("formatCode",e.formatCode),r}exportCellStyles(t){const e=t.createElement("cellStyles");e.setAttribute("count",String(this.cellStyles.length));for(let r=0,s=this.cellStyles.length;r<s;r++){const s=this.cellStyles[r];delete s.id;const i=bt.createElement(t,"cellStyle");e.appendChild(i);const n=Object.keys(s);let o=n.length;for(;o--;)i.setAttribute(n[o],s[n[o]])}return e}exportDifferentialStyles(t){const e=t.createElement("dxfs");e.setAttribute("count",String(this.differentialStyles.length));for(let r=0,s=this.differentialStyles.length;r<s;r++){const s=this.differentialStyles[r];e.appendChild(this.exportDFX(t,s))}return e}exportDFX(t,e){const r=t.createElement("dxf");return e.font&&r.appendChild(this.exportFont(t,e.font)),e.fill&&r.appendChild(this.exportFill(t,e.fill)),e.border&&r.appendChild(this.exportBorder(t,e.border)),e.numFmt&&r.appendChild(this.exportNumberFormatter(t,e.numFmt)),e.alignment&&r.appendChild(this.exportAlignment(t,e.alignment)),r}exportTableStyles(t){const e=t.createElement("tableStyles");e.setAttribute("count",String(this.tableStyles.length)),this.defaultTableStyle&&e.setAttribute("defaultTableStyle",String(this.defaultTableStyle));for(let r=0,s=this.tableStyles.length;r<s;r++)e.appendChild(this.exportTableStyle(t,this.tableStyles[r]));return e}exportTableStyle(t,e){const r=t.createElement("tableStyle");r.setAttribute("name",e.name),r.setAttribute("pivot",String(0));let s=0;return Object.entries(e).forEach((([e,i])=>{if("name"===e)return;s++;const n=t.createElement("tableStyleElement");n.setAttribute("type",e),n.setAttribute("dxfId",i),r.appendChild(n)})),r.setAttribute("count",String(s)),r}exportProtection(t,e){const r=t.createElement("protection");for(const t in e)e.hasOwn(t)&&r.setAttribute(t,e[t]);return r}toXML(){const t=bt.createXmlDoc(bt.schemas.spreadsheetml,"styleSheet"),e=t.documentElement;return e.appendChild(this.exportNumberFormatters(t)),e.appendChild(this.exportFonts(t)),e.appendChild(this.exportFills(t)),e.appendChild(this.exportBorders(t)),e.appendChild(this.exportMasterCellStyles(t)),e.appendChild(this.exportMasterCellFormats(t)),e.appendChild(this.exportCellStyles(t)),e.appendChild(this.exportDifferentialStyles(t)),this.tableStyles.length&&e.appendChild(this.exportTableStyles(t)),t}}class Et{constructor(t){nt(this,"name",""),nt(this,"id",pt("Worksheet")),nt(this,"_timezoneOffset"),nt(this,"relations",null),nt(this,"columnFormats",[]),nt(this,"data",[]),nt(this,"mergedCells",[]),nt(this,"columns",[]),nt(this,"sheetProtection",!1),nt(this,"_headers",[]),nt(this,"_footers",[]),nt(this,"_tables",[]),nt(this,"_drawings",[]),nt(this,"_orientation"),nt(this,"_margin"),nt(this,"_rowInstructions",{}),nt(this,"_freezePane",{}),nt(this,"sharedStrings",null),nt(this,"hyperlinks",[]),nt(this,"sheetView"),nt(this,"showZeros",null),this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,this.sheetView=t.sheetView||new _t,this.initialize(t)}initialize(t){t=t||{},this.name=t.name,this.id=pt("Worksheet"),this._timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,t.columns&&this.setColumns(t.columns),this.relations=new yt}exportData(){return{relations:this.relations.exportData(),columnFormats:this.columnFormats,data:this.data,columns:this.columns,mergedCells:this.mergedCells,_headers:this._headers,_footers:this._footers,_tables:this._tables,_rowInstructions:this._rowInstructions,_freezePane:this._freezePane,name:this.name,id:this.id}}importData(t){this.relations.importData(t.relations),delete t.relations,Object.assign(this,t)}setSharedStringCollection(t){this.sharedStrings=t}addTable(t){this._tables.push(t),this.relations.addRelation(t,"table")}addDrawings(t){this._drawings.push(t),this.relations.addRelation(t,"drawingRelationship")}setRowInstructions(t,e){this._rowInstructions[t]=e}setHeader(t){if(!Array.isArray(t))throw"Invalid argument type - setHeader expects an array of three instructions";this._headers=t}setFooter(t){if(!Array.isArray(t))throw"Invalid argument type - setFooter expects an array of three instructions";this._footers=t}compilePageDetailPackage(t){return t=t||"",["&L",this.compilePageDetailPiece(t[0]||""),"&C",this.compilePageDetailPiece(t[1]||""),"&R",this.compilePageDetailPiece(t[2]||"")].join("")}compilePageDetailPiece(t){if(ct(t))return'&"-,Regular"'.concat(t);if(at(t)&&!Array.isArray(t)){let e="";if(t.font||t.bold){const r=t.bold?"Bold":"Regular";e+=`&"${t.font||"-"}`,e+=`,${r}"`}else e+='&"-,Regular"';return t.underline&&(e+="&U"),t.fontSize&&(e+=`&${t.fontSize}`),e+=t.text,e}return Array.isArray(t)?t.reduce(((t,e)=>t.concat(this.compilePageDetailPiece(e))),""):void 0}exportHeader(t){const e=t.createElement("oddHeader");return e.appendChild(t.createTextNode(this.compilePageDetailPackage(this._headers))),e}exportFooter(t){const e=t.createElement("oddFooter");return e.appendChild(t.createTextNode(this.compilePageDetailPackage(this._footers))),e}_buildCache(t){const e=t.createElement("c"),r=t.createElement("v");r.appendChild(t.createTextNode("--temp--")),e.appendChild(r);const s=t.createElement("c"),i=t.createElement("f");i.appendChild(t.createTextNode("--temp--")),s.appendChild(i);const n=t.createElement("c");n.setAttribute("t","s");const o=t.createElement("v");return o.appendChild(t.createTextNode("--temp--")),n.appendChild(o),{number:e,date:e,string:n,formula:s}}collectSharedStrings(){const t=this.data,e={};for(let r=0,s=t.length;r<s;r++){const s=t[r],i=s.length;for(let t=0;t<i;t++){let r=s[t];const i=(null==r?void 0:r.metadata)||{};r&&"object"==typeof r&&(r=r.value),i.type||"number"==typeof r&&(i.type="number"),("text"===i.type||!i.type)&&typeof e[r]>"u"&&(e[r]=!0)}}return Object.keys(e)}toXML(){var t,e,r;const s=this.data,i=this.columns||[],n=bt.createXmlDoc(bt.schemas.spreadsheetml,"worksheet"),o=n.documentElement;let l,a,h;o.setAttribute("xmlns:r",bt.schemas.relationships),o.setAttribute("xmlns:mc",bt.schemas.markupCompat);let c=0;const d=bt.createElement(n,"sheetData"),p=this._buildCache(n);for(h=0,a=s.length;h<a;h++){const o=s[h],l=o.length;c=l>c?l:c;const a=n.createElement("row");for(let s=0;s<l;s++){i[s]=i[s]||{};let n,l=o[s];const c=(null==l?void 0:l.metadata)||{};switch(l&&"object"==typeof l&&(l=l.value),c.type||"number"==typeof l&&(c.type="number"),c.type){case"number":n=p.number.cloneNode(!0),n.firstChild.firstChild.nodeValue=l;break;case"date":n=p.date.cloneNode(!0),l instanceof Date&&(l=l.getTime()),n.firstChild.firstChild.nodeValue=25569+(l-this._timezoneOffset)/864e5;break;case"formula":n=p.formula.cloneNode(!0),n.firstChild.firstChild.nodeValue=l;break;default:{let r;r=typeof(null==(t=this.sharedStrings)?void 0:t.strings[l])<"u"?this.sharedStrings.strings[l]:null==(e=this.sharedStrings)?void 0:e.addString(l),n=p.string.cloneNode(!0),n.firstChild.firstChild.nodeValue=r;break}}c.style?n.setAttribute("s",c.style):void 0!==(null==(r=this._rowInstructions[h])?void 0:r.style)&&n.setAttribute("s",this._rowInstructions[h].style),n.setAttribute("r",bt.positionToLetterRef(s+1,String(h+1))),a.appendChild(n)}if(a.setAttribute("r",h+1),this._rowInstructions[h]){const t=this._rowInstructions[h];void 0!==t.height&&(a.setAttribute("customHeight","1"),a.setAttribute("ht",t.height)),void 0!==t.style&&(a.setAttribute("customFormat","1"),a.setAttribute("s",t.style))}d.appendChild(a)}if(0!==c?o.appendChild(bt.createElement(n,"dimension",[["ref",`${bt.positionToLetterRef(1,1)}:${bt.positionToLetterRef(c,String(s.length))}`]])):o.appendChild(bt.createElement(n,"dimension",[["ref",bt.positionToLetterRef(1,1)]])),o.appendChild(this.sheetView.exportXML(n)),this.columns.length&&o.appendChild(this.exportColumns(n)),o.appendChild(d),this.sheetProtection&&o.appendChild(this.sheetProtection.exportXML(n)),this.hyperlinks.length>0){const t=n.createElement("hyperlinks"),e=this.hyperlinks;for(l=0,a=e.length;l<a;l++){const r=n.createElement("hyperlink"),s=e[l];r.setAttribute("ref",String(s.cell)),s.id=bt.uniqueId("hyperlink"),this.relations.addRelation({id:s.id,target:s.location,targetMode:s.targetMode||"External"},"hyperlink"),r.setAttribute("r:id",this.relations.getRelationshipId(s)),t.appendChild(r)}o.appendChild(t)}if(this.mergedCells.length>0){const t=n.createElement("mergeCells");for(l=0,a=this.mergedCells.length;l<a;l++){const e=n.createElement("mergeCell");e.setAttribute("ref",`${this.mergedCells[l][0]}:${this.mergedCells[l][1]}`),t.appendChild(e)}o.appendChild(t)}if(this.exportPageSettings(n,o),this._headers.length>0||this._footers.length>0){const t=n.createElement("headerFooter");this._headers.length>0&&t.appendChild(this.exportHeader(n)),this._footers.length>0&&t.appendChild(this.exportFooter(n)),o.appendChild(t)}for(l=0,a=this._drawings.length;l<a;l++){const t=n.createElement("drawing");t.setAttribute("r:id",this.relations.getRelationshipId(this._drawings[l])),o.appendChild(t)}if(this._tables.length>0){const t=n.createElement("tableParts");for(t.setAttribute("count",this._tables.length),l=0,a=this._tables.length;l<a;l++){const e=n.createElement("tablePart");e.setAttribute("r:id",this.relations.getRelationshipId(this._tables[l])),t.appendChild(e)}o.appendChild(t)}return n}exportColumns(t){const e=bt.createElement(t,"cols");for(let r=0,s=this.columns.length;r<s;r++){const s=this.columns[r],i=bt.createElement(t,"col",[["min",s.min||r+1],["max",s.max||r+1]]);s.hidden&&i.setAttribute("hidden",String(1)),s.bestFit&&i.setAttribute("bestFit",String(1)),(s.customWidth||s.width)&&i.setAttribute("customWidth",String(1)),s.width?i.setAttribute("width",s.width):i.setAttribute("width",String(9.140625)),e.appendChild(i)}return e}exportPageSettings(t,e){if(this._margin){let r=.7;const s=this._margin.left?this._margin.left:r,i=this._margin.right?this._margin.right:r,n=this._margin.top?this._margin.top:r,o=this._margin.bottom?this._margin.bottom:r;r=.3;const l=this._margin.header?this._margin.header:r,a=this._margin.footer?this._margin.footer:r;e.appendChild(bt.createElement(t,"pageMargins",[["top",n],["bottom",o],["left",s],["right",i],["header",l],["footer",a]]))}this._orientation&&e.appendChild(bt.createElement(t,"pageSetup",[["orientation",this._orientation]]))}setPageOrientation(t){this._orientation=t}setPageMargin(t){this._margin=t}setColumns(t){this.columns=t}setData(t){this.data=t}mergeCells(t,e){this.mergedCells.push([t,e])}freezePane(t,e,r){this.sheetView.freezePane(t,e,r)}setColumnFormats(t){this.columnFormats=t}}class St{constructor(){nt(this,"id",pt("Workbook")),nt(this,"styleSheet",new vt),nt(this,"sharedStrings",new wt),nt(this,"relations",new yt),nt(this,"worksheets",[]),nt(this,"tables",[]),nt(this,"drawings",[]),nt(this,"media",{}),nt(this,"printTitles"),this.initialize()}initialize(){this.id=pt("Workbook"),this.styleSheet=new vt,this.sharedStrings=new wt,this.relations=new yt,this.relations.addRelation(this.styleSheet,"stylesheet"),this.relations.addRelation(this.sharedStrings,"sharedStrings")}createWorksheet(t){return t=Object.assign({},{name:"Sheet ".concat(String(this.worksheets.length+1))},t),new Et(t)}getStyleSheet(){return this.styleSheet}addTable(t){this.tables.push(t)}addDrawings(t){this.drawings.push(t)}setPrintTitleTop(t,e){null==this.printTitles&&(this.printTitles={}),null==this.printTitles[t]&&(this.printTitles[t]={}),this.printTitles[t].top=e}setPrintTitleLeft(t,e){null==this.printTitles&&(this.printTitles={}),null==this.printTitles[t]&&(this.printTitles[t]={}),this.printTitles[t].left=String.fromCharCode(64+e)}addMedia(t,e,r,s){const i=e.split("."),n=i[i.length-1];if(!s)switch(n.toLowerCase()){case"jpeg":case"jpg":s="image/jpeg";break;case"png":s="image/png";break;case"gif":s="image/gif";break;default:s=null}return this.media[e]||(this.media[e]={id:e,data:r,fileName:e,contentType:s,extension:n}),this.media[e]}addWorksheet(t){this.relations.addRelation(t,"worksheet"),t.setSharedStringCollection(this.sharedStrings),this.worksheets.push(t)}createContentTypes(){const t=bt.createXmlDoc(bt.schemas.contentTypes,"Types"),e=t.documentElement;let r,s;e.appendChild(bt.createElement(t,"Default",[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]])),e.appendChild(bt.createElement(t,"Default",[["Extension","xml"],["ContentType","application/xml"]]));const i={};for(const t in this.media)this.media.hasOwn(t)&&(i[this.media[t].extension]=this.media[t].contentType);for(const r in i)i.hasOwn(r)&&e.appendChild(bt.createElement(t,"Default",[["Extension",r],["ContentType",i[r]]]));for(e.appendChild(bt.createElement(t,"Override",[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]])),e.appendChild(bt.createElement(t,"Override",[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]])),e.appendChild(bt.createElement(t,"Override",[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]])),r=0,s=this.worksheets.length;r<s;r++)e.appendChild(bt.createElement(t,"Override",[["PartName",`/xl/worksheets/sheet${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]));for(r=0,s=this.tables.length;r<s;r++)e.appendChild(bt.createElement(t,"Override",[["PartName",`/xl/tables/table${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]));for(r=0,s=this.drawings.length;r<s;r++)e.appendChild(bt.createElement(t,"Override",[["PartName",`/xl/drawings/drawing${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]));return t}toXML(){const t=bt.createXmlDoc(bt.schemas.spreadsheetml,"workbook"),e=t.documentElement;e.setAttribute("xmlns:r",bt.schemas.relationships);const r=bt.createElement(t,"sheets");for(let e=0,s=this.worksheets.length;e<s;e++){const s=t.createElement("sheet");typeof console<"u"&&this.worksheets[e].name.length>31&&console.log(`Microsoft Excel requires work sheet names to be less than 32 characters long, work sheet name "${this.worksheets[e].name}" is ${this.worksheets[e].name.length} characters long`),s.setAttribute("name",this.worksheets[e].name),s.setAttribute("sheetId",e+1),s.setAttribute("r:id",this.relations.getRelationshipId(this.worksheets[e])),r.appendChild(s)}e.appendChild(r);const s=bt.createElement(t,"definedNames");let i=0;for(const e in this.printTitles){if(!this.printTitles.hasOwn(e))continue;const r=this.printTitles[e],n=t.createElement("definedName");n.setAttribute("name","_xlnm.Print_Titles"),n.setAttribute("localSheetId",i++);let o="";r.top&&(o+=`${e}!$1:$${r.top}`,r.left&&(o+=",")),r.left&&(o+=`${e}!$A:$${r.left}`),n.appendChild(t.createTextNode(o)),s.appendChild(n)}return e.appendChild(s),t}createWorkbookRelationship(){const t=bt.createXmlDoc(bt.schemas.relationshipPackage,"Relationships");return t.documentElement.appendChild(bt.createElement(t,"Relationship",[["Id","rId1"],["Type",bt.schemas.officeDocument],["Target","xl/workbook.xml"]])),t}_generateCorePaths(t){let e,r;for(xt[this.styleSheet.id]="styles.xml",xt[this.sharedStrings.id]="sharedStrings.xml",xt[this.id]="/xl/workbook.xml",e=0,r=this.tables.length;e<r;e++)t[`/xl/tables/table${e+1}.xml`]=this.tables[e].toXML(),xt[this.tables[e].id]=`/xl/tables/table${e+1}.xml`;for(const e in this.media)if(this.media.hasOwn(e)){const r=this.media[e];t[`/xl/media/${e}`]=r.data,xt[e]=`/xl/media/${e}`}for(e=0,r=this.drawings.length;e<r;e++)t[`/xl/drawings/drawing${e+1}.xml`]=this.drawings[e].toXML(),xt[this.drawings[e].id]=`/xl/drawings/drawing${e+1}.xml`,t[`/xl/drawings/_rels/drawing${e+1}.xml.rels`]=this.drawings[e].relations.toXML()}_prepareFilesForPackaging(t){Object.assign(t,{"/[Content_Types].xml":this.createContentTypes(),"/_rels/.rels":this.createWorkbookRelationship(),"/xl/styles.xml":this.styleSheet.toXML(),"/xl/workbook.xml":this.toXML(),"/xl/sharedStrings.xml":this.sharedStrings.toXML(),"/xl/_rels/workbook.xml.rels":this.relations.toXML()});for(const[e,r]of Object.entries(t))if(-1!==e.indexOf(".xml")||-1!==e.indexOf(".rels")){t[e]=r instanceof ut?r.toString():r.xml||(new window.XMLSerializer).serializeToString(r);let s=t[e].replace(/xmlns=""/g,"");s=s.replace(/NS[\d]+:/g,""),s=s.replace(/xmlns:NS[\d]+=""/g,""),t[e]=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n${s}`}}generateFiles(){return new Promise((t=>{const e={};this._generateCorePaths(e);for(let t=0,r=this.worksheets.length;t<r;t++)e[`/xl/worksheets/sheet${t+1}.xml`]=this.worksheets[t].toXML(),xt[this.worksheets[t].id]=`worksheets/sheet${t+1}.xml`,e[`/xl/worksheets/_rels/sheet${t+1}.xml.rels`]=this.worksheets[t].relations.toXML();return this._prepareFilesForPackaging(e),t(e)}))}}function Tt(t,e,r){if("node"===(null==r?void 0:r.downloadType))throw new Error('[Excel-Builder-Vanilla] Please note that `downloadExcelFile()` is currently only supporting the "browser" download type at the moment.');const s=e.match(/.*\.xls$/)?"xls":"xlsx";return function(t,e,r){const s={};return new Promise(((e,n)=>{t.generateFiles().then((t=>{for(const[e,r]of Object.entries(t))s[e.substr(1)]=Q(r);return function(t,e,r){r||(r=e,e={}),"function"!=typeof r&&F(7);var s={};Z(t,"",s,e);var n=Object.keys(s),o=n.length,l=0,a=0,h=o,c=new Array(o),d=[],p=function(){for(var t=0;t<d.length;++t)d[t]()},u=function(t,e){st((function(){r(t,e)}))};st((function(){u=r}));var m=function(){var t=new i(a+22),e=l,r=a-l;a=0;for(var s=0;s<h;++s){var n=c[s];try{var o=n.c.length;et(t,a,n,n.f,n.u,o);var d=30+n.f.length+tt(n.extra),p=a+d;t.set(n.c,p),et(t,l,n,n.f,n.u,o,a,n.m),l+=16+d+(n.m?n.m.length:0),a=p+o}catch(t){return u(t,null)}}rt(t,l,c.length,r,e),u(null,t)};o||m();for(var f=function(t){var e=n[t],r=s[e],i=r[0],h=r[1],f=B(),g=i.length;f.p(i);var b=Q(e),x=b.length,y=h.comment,C=y&&Q(y),w=C&&C.length,_=tt(h.extra),v=0==h.level?0:8,E=function(r,s){if(r)p(),u(r,null);else{var i=s.length;c[t]=V(h,{size:g,crc:f.d(),c:s,f:b,m:C,u:x!=e.length||C&&y.length!=w,compression:v}),l+=30+x+_+i,a+=76+2*(x+_)+(w||0)+i,--o||m()}};if(x>65535&&E(F(11,0,1),null),v)if(g<16e4)try{E(null,K(i,h))}catch(t){E(t,null)}else d.push(function(t,e,r){return r||(r=e,e={}),"function"!=typeof r&&F(7),U(t,e,[X],(function(t){return W(K(t.data[0],t.data[1]))}),0,r)}(i,h,E));else E(null,i)},g=0;g<h;++g)f(g);return p}(s,(null==r?void 0:r.zipOptions)||{},((t,s)=>{if(t)n(t);else{{const t=(null==r?void 0:r.fileFormat)??"xlsx";let i=null==r?void 0:r.mimeType;void 0===i&&(i="xls"===t?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),e(new Blob([s],{type:i}))}}}))}))}))}(t,0,{...r,fileFormat:s}).then((t=>{!function(t,e){const r=document.createElement("a"),s=URL.createObjectURL(e);r&&document&&(r.textContent="download",r.href=s,r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s))}(e,t)}))}var Ft=r(32420),At=r(48512);const kt=t=>t,Ot=(t,e,r,s,i)=>({value:"string"==typeof t&&/\d/g.test(t)?Nt(t,e,i):t,metadata:{style:r}});function Nt(t,e,r){let s=t;if("string"==typeof t&&t){const i=","===(0,Ft.Yd3)("decimalSeparator",e,r,Ft.Mvx.DEFAULT_NUMBER_DECIMAL_SEPARATOR)?parseFloat(t.replace(/[^0-9\,\-]+/g,"").replace(",",".")):parseFloat(t.replace(/[^\d\.\-]/g,""));s=isNaN(i)?t:i}return s}function Pt(t,e,r,s,i=!0){const n=(0,Ft.Wgq)(r);let o,l=kt;return n===Ft.sV2.number&&i&&(o=Rt(t,e,r,s,"cell").stylesheetFormatter.id,l=Ot),{stylesheetFormatterId:o,getDataValueParser:l}}function Dt(t,e,r){return t?.[r]?.[e.field]??0}function It(t){let e;switch(t){case Ft.cnr.currency:case Ft.cnr.dollar:case Ft.cnr.dollarColored:case Ft.cnr.dollarColoredBold:e="currency";break;case Ft.cnr.percent:case Ft.cnr.percentComplete:case Ft.cnr.percentCompleteBar:case Ft.cnr.percentCompleteBarWithText:case Ft.cnr.percentSymbol:e="percent";break;case Ft.cnr.decimal:default:e="decimal"}return e}function Rt(t,e,r,s,i){let n,o="",l="";const a=(0,Ft.Wgq)(r);if("group"===i)switch(r.groupTotalsFormatter){case Ft._2N.avgTotals:case Ft._2N.avgTotalsCurrency:case Ft._2N.avgTotalsDollar:case Ft._2N.avgTotalsPercentage:l="avg";break;case Ft._2N.minTotals:l="min";break;case Ft._2N.maxTotals:l="max";break;case Ft._2N.sumTotals:case Ft._2N.sumTotalsBold:case Ft._2N.sumTotalsColored:case Ft._2N.sumTotalsCurrency:case Ft._2N.sumTotalsCurrencyColored:case Ft._2N.sumTotalsDollar:case Ft._2N.sumTotalsDollarColoredBold:case Ft._2N.sumTotalsDollarColored:case Ft._2N.sumTotalsDollarBold:l="sum";break;default:n=e.numberFormatter}else if(a===Ft.sV2.number)switch(r.formatter){case Ft.cnr.multiple:if(Array.isArray(r.params?.formatters))for(const o of r.params.formatters){const{stylesheetFormatter:l}=Rt(t,e,{...r,formatter:o},s,i);if(l!==e.numberFormatter){n=l;break}}n||(n=e.numberFormatter);break;case Ft.cnr.currency:case Ft.cnr.decimal:case Ft.cnr.dollar:case Ft.cnr.dollarColored:case Ft.cnr.dollarColoredBold:case Ft.cnr.percent:case Ft.cnr.percentComplete:case Ft.cnr.percentCompleteBar:case Ft.cnr.percentCompleteBarWithText:case Ft.cnr.percentSymbol:o=Lt(r,s,"cell");break;default:n=e.numberFormatter}return n||!r.formatter&&!r.groupTotalsFormatter||(o=Lt(r,s,i,l),e.hasOwnProperty(o)||(e[o]=t.createFormat({format:o})),n=e[o]),{stylesheetFormatter:n,groupType:l}}function Mt(t){const[e,r,s,i,n,o,l,a]=t?.match(/^([^\d\(\-]*)([\(]?)([^\d]*)([\-]?[\w]]?[\d\s]*[.,\d]*[\d]*[^)\s\%]?)([^\d.,)]*)([\)]?)([^\d]*)$/i)||[],h=(n||"").replace(/1/g,"0").replace(/[2]/g,"#");return[$t(r??""),s??"",$t(i??""),h,$t(o??""),l??"",$t(a??"")].join("").replace(",",",")}function Lt(t,e,r,s=""){let i="",n="",o="";const{minDecimal:l,maxDecimal:a,thousandSeparator:h}=function(t,e,r){let s;if("group"===r)switch(t.groupTotalsFormatter){case Ft._2N.avgTotalsCurrency:case Ft._2N.avgTotalsDollar:case Ft._2N.sumTotalsCurrency:case Ft._2N.sumTotalsCurrencyColored:case Ft._2N.sumTotalsDollar:case Ft._2N.sumTotalsDollarBold:case Ft._2N.sumTotalsDollarColored:case Ft._2N.sumTotalsDollarColoredBold:s="currency";break;case Ft._2N.avgTotalsPercentage:s="percent";break;case Ft._2N.avgTotals:case Ft._2N.minTotals:case Ft._2N.maxTotals:case Ft._2N.sumTotals:case Ft._2N.sumTotalsColored:case Ft._2N.sumTotalsBold:default:s="decimal"}else if(t.formatter===Ft.cnr.multiple&&Array.isArray(t.params?.formatters)){s="decimal";for(const e of t.params.formatters)if(s=It(e),"decimal"!==s)break}else s=It(t.formatter);return(0,Ft.GQs)(t,e,s,r)}(t,e,r),c=parseFloat(`${h?"2220":"0"}.${function(t,e){return zt("1",t)+zt("2",e-t)}(l,a)}`);return"group"===r&&t.groupTotalsFormatter?(n=(0,At.stripTags)(t.groupTotalsFormatter({[s]:{[t.field]:c}},t,e)),o=(0,At.stripTags)(t.groupTotalsFormatter({[s]:{[t.field]:-c}},t,e))):t.formatter&&(n=(0,At.stripTags)(t.formatter(0,0,c,t,{},e)),o=(0,At.stripTags)(t.formatter(0,0,-c,t,{},e))),n&&o&&(i=Mt(n)+";"+Mt(o)),i}function $t(t){return t?`"${t}"`:t}function zt(t,e){let r="";for(let s=0;s<e;s++)r+=t;return r}const Bt={filename:"export",format:Ft.OkA.xlsx};class Ht{constructor(){this._fileFormat=Ft.OkA.xlsx,this._columnHeaders=[],this._hasColumnTitlePreHeader=!1,this._hasGroupedItems=!1,this._pubSubService=null,this._regularCellExcelFormats={},this._groupTotalExcelFormats={},this.className="ExcelExportService"}get _datasetIdPropName(){return this._gridOptions?.datasetIdPropertyName??"id"}get _dataView(){return this._grid?.getData()}get _gridOptions(){return this._grid?.getOptions()||{}}get stylesheet(){return this._stylesheet}get stylesheetFormats(){return this._stylesheetFormats}get groupTotalExcelFormats(){return this._groupTotalExcelFormats}get regularCellExcelFormats(){return this._regularCellExcelFormats}dispose(){this._pubSubService?.unsubscribeAll()}init(t,e){if(this._grid=t,this._pubSubService=e.get("PubSubService"),this._locales=this._gridOptions?.locales??Ft.Mvx.locales,this._translaterService=this._gridOptions?.translater,this._gridOptions.enableTranslate&&(!this._translaterService||!this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be passed in the "translater" Grid Options when "enableTranslate" is enabled. (example: this.gridOptions = { enableTranslate: true, translater: this.translaterService })')}exportToExcel(t){if(!this._grid||!this._dataView||!this._pubSubService)throw new Error('[Slickgrid-Universal] it seems that the SlickGrid & DataView objects and/or PubSubService are not initialized did you forget to enable the grid option flag "enableExcelExport"?');return this._pubSubService?.publish("onBeforeExportToExcel",!0),this._excelExportOptions=(0,At.deepCopy)({...Bt,...this._gridOptions.excelExportOptions,...t}),this._fileFormat=this._excelExportOptions.format||Ft.OkA.xlsx,this._regularCellExcelFormats={},this._groupTotalExcelFormats={},new Promise((t=>{const e={name:this._excelExportOptions.sheetName||"Sheet1"};this._workbook=new St,this._sheet=this._workbook.createWorksheet(e),this._stylesheet=this._workbook.getStyleSheet();const r=this._stylesheet.createFormat({font:{bold:!0}}),s=this._stylesheet.createFormat({format:"@"}),i=this._stylesheet.createFormat({format:"0"});this._stylesheetFormats={boldFormatter:r,numberFormatter:i,stringFormatter:s},this._sheet.setColumnFormats([r]);const n=this.getDataOutput();setTimeout((async()=>{this._gridOptions?.excelExportOptions?.customExcelHeader&&this._gridOptions.excelExportOptions.customExcelHeader(this._workbook,this._sheet);const e=this._grid?.getColumns()||[];this._sheet.setColumns(this.getColumnStyles(e));const r=this._sheet.data;let s=r;Array.isArray(r)&&Array.isArray(n)&&(s=this._sheet.data.concat(n)),this._sheet.setData(s),this._workbook.addWorksheet(this._sheet);let i=this._excelExportOptions?.mimeType;void 0===i&&(i=this._fileFormat===Ft.OkA.xls?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const o=`${this._excelExportOptions.filename}.${this._fileFormat}`;Tt(this._workbook,o,{mimeType:i}).then((()=>{this._pubSubService?.publish("onAfterExportToExcel",{filename:o,mimeType:i}),t(!0)}))}))}))}getExcelColumnNameByIndex(t){const e="ZABCDEFGHIJKLMNOPQRSTUVWXY";let r=Math.floor(t/26);const s=Math.floor(t%26);return 0===s&&r--,t>26?this.getExcelColumnNameByIndex(r)+e[s]:e[s]+""}getDataOutput(){const t=this._grid?.getColumns()||[],e=[],r=this._gridOptions?.excelExportOptions,s=r?.columnHeaderStyle;let i=this._stylesheetFormats.boldFormatter.id;if(s&&(i=this._stylesheet.createFormat(s).id),this._gridOptions.createPreHeaderPanel&&this._gridOptions.showPreHeaderPanel&&!this._gridOptions.enableDraggableGrouping){const r=this._stylesheet.createFormat({alignment:{horizontal:"center"},font:{bold:!0}});e.push(this.getColumnGroupedHeaderTitlesData(t,{style:r?.id})),this._hasColumnTitlePreHeader=!0}return e.push(this.getColumnHeaderData(t,{style:i})),this.pushAllGridRowDataToArray(e,t),e}getColumnStyles(t){const e=this._dataView.getGrouping(),r=[];return Array.isArray(e)&&e.length>0&&r.push({bestFit:!0,columnStyles:this._gridOptions?.excelExportOptions?.customColumnWidth??10}),t.forEach((t=>{const e=t.excludeFromExport??!1;(void 0===t.width||t.width>0)&&!e&&r.push({bestFit:!0,width:t.excelExportOptions?.width??this._gridOptions?.excelExportOptions?.customColumnWidth??10})})),r}getColumnGroupedHeaderTitlesData(t,e){let r=[];this._groupedColumnHeaders=this.getColumnGroupedHeaderTitles(t)||[],this._groupedColumnHeaders&&Array.isArray(this._groupedColumnHeaders)&&this._groupedColumnHeaders.length>0&&(r=this._groupedColumnHeaders.map((t=>({value:t.title,metadata:e}))));let s=0;const i=this._groupedColumnHeaders.length;for(let t=0;t<i;t++)if(t+1===i||t+1<i&&this._groupedColumnHeaders[t].title!==this._groupedColumnHeaders[t+1].title){const e=this.getExcelColumnNameByIndex(s+1),r=this.getExcelColumnNameByIndex(t+1);this._sheet.mergeCells(`${e}1`,`${r}1`),s=t+1}return r}getColumnHeaderData(t,e){let r=[];this._columnHeaders=this.getColumnHeaders(t)||[],this._columnHeaders&&Array.isArray(this._columnHeaders)&&this._columnHeaders.length>0&&(r=this._columnHeaders.map((t=>({value:(0,At.stripTags)(t.title),metadata:e}))));const s=this.getGroupColumnTitle();return s&&r.unshift({value:s,metadata:e}),r}getGroupColumnTitle(){let t=this._excelExportOptions.groupingColumnHeaderTitle;!t&&this._gridOptions.enableTranslate&&this._translaterService?.translate?t=this._translaterService.translate(`${(0,Ft.sDZ)(this._gridOptions)}GROUP_BY`):t||(t=this._locales&&this._locales.TEXT_GROUP_BY);const e=this._dataView.getGrouping();return Array.isArray(e)&&e.length>0?(this._hasGroupedItems=!0,t):(this._hasGroupedItems=!1,null)}getColumnGroupedHeaderTitles(t){const e=[];return t&&Array.isArray(t)&&t.forEach((t=>{let r="";r=t.columnGroupKey&&this._gridOptions.enableTranslate&&this._translaterService?.translate?this._translaterService.translate(t.columnGroupKey):t.columnGroup||"";const s=t.excludeFromExport||!1;(void 0===t.width||t.width>0)&&!s&&e.push({key:t.field||t.id,title:r||""})})),e}getColumnHeaders(t){const e=[];return t&&Array.isArray(t)&&t.forEach((t=>{let r="";r=(t.nameKey||t.nameKey)&&this._gridOptions.enableTranslate&&this._translaterService?.translate?this._translaterService.translate(t.nameKey||t.nameKey):(0,At.getHtmlStringOutput)(t.name||"","innerHTML")||(0,At.titleCase)(t.field);const s=t.excludeFromExport||!1;(void 0===t.width||t.width>0)&&!s&&e.push({key:(t.field||t.id)+"",title:r})})),e}pushAllGridRowDataToArray(t,e){const r=this._dataView.getLength();for(let s=0;s<r;s++){const r=this._dataView.getItem(s);r&&!r.hasOwnProperty("getItem")&&(null!==r[this._datasetIdPropName]&&void 0!==r[this._datasetIdPropName]?t.push(this.readRegularRowData(e,s,r)):this._hasGroupedItems&&void 0===r.__groupTotals?t.push([this.readGroupedRowTitle(r)]):r.__groupTotals&&t.push(this.readGroupedTotalRows(e,r)))}return t}readRegularRowData(t,e,r){let s=0;const i=[],n=t.length;let o=1,l=0;const a=this._dataView.getItemMetadata(e);for(let h=0;h<n;h++){const n=t[h];if(n.excludeFromExport)continue;this._hasGroupedItems&&0===s&&i.push("");let c,d=1;if(a?.columns){const e=a.columns,r=e[n.id]||e[h];!isNaN(o)&&+o>1||"*"===o&&h>0||(o=r?.colspan??1),"*"===o?d=t.length-h:(d=o,n.id in e&&(c=n.id,l=h))}if("*"===o&&h>0||!isNaN(o)&&+o>1&&n.id!==c){const t=e+(this._hasColumnTitlePreHeader?3:2);if("number"==typeof o&&d-1==1){const e=this.getExcelColumnNameByIndex(l+1),r=this.getExcelColumnNameByIndex(h+1);this._sheet.mergeCells(`${e}${t}`,`${r}${t}`),i.push("")}else if("*"===o&&1===d){const e=this.getExcelColumnNameByIndex(h+1);this._sheet.mergeCells(`A${t}`,`${e}${t}`)}else i.push("");"number"==typeof o&&!isNaN(o)&&+o>1&&(d=o--)}else{let t="";const o=(0,Ft.Wgq)(n),l={...this._excelExportOptions};if(!1!==n.exportWithFormatter&&(0,Ft.Sqw)(o)&&(l.exportWithFormatter=!0),t=(0,Ft._ig)(e,h,n,r,this._grid,l),!this._regularCellExcelFormats.hasOwnProperty(n.id)){const t=n.excelExportOptions?.autoDetectCellFormat??this._excelExportOptions?.autoDetectCellFormat,e=Pt(this._stylesheet,this._stylesheetFormats,n,this._grid,t);n.excelExportOptions?.style&&(e.stylesheetFormatterId=this._stylesheet.createFormat(n.excelExportOptions.style).id),n.excelExportOptions?.valueParserCallback&&(e.getDataValueParser=n.excelExportOptions.valueParserCallback),this._regularCellExcelFormats[n.id]=e}"string"==typeof t&&(n.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(t=(0,At.stripTags)(t));const{stylesheetFormatterId:a,getDataValueParser:c}=this._regularCellExcelFormats[n.id];t=c(t,n,a,this._stylesheet,this._gridOptions),i.push(t),s++}}return i}readGroupedRowTitle(t){const e=(0,At.stripTags)(t.title);if(this._excelExportOptions&&this._excelExportOptions.addGroupIndentation){const r=this._excelExportOptions&&this._excelExportOptions.groupCollapsedSymbol||"",s=this._excelExportOptions&&this._excelExportOptions.groupExpandedSymbol||"";return(t.collapsed?r:s)+" "+(0,At.addWhiteSpaces)(5*t.level)+e}return e}readGroupedTotalRows(t,e){const r=[this._excelExportOptions.groupingAggregatorRowText||""];return t.forEach((t=>{let s="";const i=(0,Ft.Wgq)(t),n=t.excludeFromExport||!1;if(t.exportCustomGroupTotalsFormatter){const r=t.exportCustomGroupTotalsFormatter(e,t,this._grid);s=r instanceof HTMLElement?r.textContent||"":r}const o=t.excelExportOptions?.autoDetectCellFormat??this._excelExportOptions?.autoDetectCellFormat;if(i===Ft.sV2.number&&!1!==o){let r=this._groupTotalExcelFormats[t.id];r?.groupType||(r=Rt(this._stylesheet,this._stylesheetFormats,t,this._grid,"group"),t.groupTotalsExcelExportOptions?.style&&(r.stylesheetFormatter=this._stylesheet.createFormat(t.groupTotalsExcelExportOptions.style)),this._groupTotalExcelFormats[t.id]=r);const i=t.groupTotalsExcelExportOptions?.valueParserCallback??Dt;void 0!==e[r.groupType]?.[t.field]&&(s={value:i(e,t,r.groupType,this._stylesheet),metadata:{style:r.stylesheetFormatter?.id}})}else if(t.groupTotalsFormatter){const r=t.groupTotalsFormatter(e,t,this._grid);s=r instanceof HTMLElement?r.textContent||"":r}"string"==typeof s&&(t.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(s=(0,At.stripTags)(s)),(void 0===t.width||t.width>0)&&!n&&r.push(s)})),r}}}}]);