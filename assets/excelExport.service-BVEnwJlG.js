import{as as fe,a as Me,F as P,s as Z,at as bt,au as yt,j as at,h as pe,k as Ct,m as vt,o as wt,p as Et,av as Ft,q as St,u as _t}from"./index-Bz3uuwsZ.js";import{G as _}from"./groupingFormatters.index-B6oGpPhz.js";var qe={},Tt=function(i,e,t,r,s){var a=new Worker(qe[e]||(qe[e]=URL.createObjectURL(new Blob([i+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return a.onmessage=function(o){var n=o.data,l=n.$e$;if(l){var c=new Error(l[0]);c.code=l[1],c.stack=l[2],s(c,null)}else s(null,n)},a.postMessage(t,r),a},L=Uint8Array,z=Uint16Array,ye=Int32Array,Ce=new L([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ve=new L([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ke=new L([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ot=function(i,e){for(var t=new z(31),r=0;r<31;++r)t[r]=e+=1<<i[r-1];for(var s=new ye(t[30]),r=1;r<30;++r)for(var a=t[r];a<t[r+1];++a)s[a]=a-t[r]<<5|r;return{b:t,r:s}},nt=ot(Ce,2),At=nt.b,ge=nt.r;At[28]=258,ge[258]=28;var kt=ot(ve,0),Oe=kt.r,xe=new z(32768);for(var T=0;T<32768;++T){var K=(T&43690)>>1|(T&21845)<<1;K=(K&52428)>>2|(K&13107)<<2,K=(K&61680)>>4|(K&3855)<<4,xe[T]=((K&65280)>>8|(K&255)<<8)>>1}var oe=function(i,e,t){for(var r=i.length,s=0,a=new z(e);s<r;++s)i[s]&&++a[i[s]-1];var o=new z(e);for(s=1;s<e;++s)o[s]=o[s-1]+a[s-1]<<1;var n;if(t){n=new z(1<<e);var l=15-e;for(s=0;s<r;++s)if(i[s])for(var c=s<<4|i[s],h=e-i[s],x=o[i[s]-1]++<<h,C=x|(1<<h)-1;x<=C;++x)n[xe[x]>>l]=c}else for(n=new z(r),s=0;s<r;++s)i[s]&&(n[s]=xe[o[i[s]-1]++]>>15-i[s]);return n},Y=new L(288);for(var T=0;T<144;++T)Y[T]=8;for(var T=144;T<256;++T)Y[T]=9;for(var T=256;T<280;++T)Y[T]=7;for(var T=280;T<288;++T)Y[T]=8;var he=new L(32);for(var T=0;T<32;++T)he[T]=5;var lt=oe(Y,9,0),ht=oe(he,5,0),Be=function(i){return(i+7)/8|0},$e=function(i,e,t){return(e==null||e<0)&&(e=0),(t==null||t>i.length)&&(t=i.length),new L(i.subarray(e,t))},Ot=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ne=function(i,e,t){var r=new Error(e||Ot[i]);if(r.code=i,Error.captureStackTrace&&Error.captureStackTrace(r,ne),!t)throw r;return r},X=function(i,e,t){t<<=e&7;var r=e/8|0;i[r]|=t,i[r+1]|=t>>8},se=function(i,e,t){t<<=e&7;var r=e/8|0;i[r]|=t,i[r+1]|=t>>8,i[r+2]|=t>>16},ue=function(i,e){for(var t=[],r=0;r<i.length;++r)i[r]&&t.push({s:r,f:i[r]});var s=t.length,a=t.slice();if(!s)return{t:He,l:0};if(s==1){var o=new L(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(S,A){return S.f-A.f}),t.push({s:-1,f:25001});var n=t[0],l=t[1],c=0,h=1,x=2;for(t[0]={s:-1,f:n.f+l.f,l:n,r:l};h!=s-1;)n=t[t[c].f<t[x].f?c++:x++],l=t[c!=h&&t[c].f<t[x].f?c++:x++],t[h++]={s:-1,f:n.f+l.f,l:n,r:l};for(var C=a[0].s,r=1;r<s;++r)a[r].s>C&&(C=a[r].s);var w=new z(C+1),y=be(t[h-1],w,0);if(y>e){var r=0,f=0,u=y-e,b=1<<u;for(a.sort(function(A,k){return w[k.s]-w[A.s]||A.f-k.f});r<s;++r){var m=a[r].s;if(w[m]>e)f+=b-(1<<y-w[m]),w[m]=e;else break}for(f>>=u;f>0;){var E=a[r].s;w[E]<e?f-=1<<e-w[E]++-1:++r}for(;r>=0&&f;--r){var p=a[r].s;w[p]==e&&(--w[p],++f)}y=e}return{t:new L(w),l:y}},be=function(i,e,t){return i.s==-1?Math.max(be(i.l,e,t+1),be(i.r,e,t+1)):e[i.s]=t},Pe=function(i){for(var e=i.length;e&&!i[--e];);for(var t=new z(++e),r=0,s=i[0],a=1,o=function(l){t[r++]=l},n=1;n<=e;++n)if(i[n]==s&&n!=e)++a;else{if(!s&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(s),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(s);a=1,s=i[n]}return{c:t.subarray(0,r),n:e}},ie=function(i,e){for(var t=0,r=0;r<e.length;++r)t+=i[r]*e[r];return t},ze=function(i,e,t){var r=t.length,s=Be(e+2);i[s]=r&255,i[s+1]=r>>8,i[s+2]=i[s]^255,i[s+3]=i[s+1]^255;for(var a=0;a<r;++a)i[s+a+4]=t[a];return(s+4+r)*8},Ne=function(i,e,t,r,s,a,o,n,l,c,h){X(e,h++,t),++s[256];for(var x=ue(s,15),C=x.t,w=x.l,y=ue(a,15),f=y.t,u=y.l,b=Pe(C),m=b.c,E=b.n,p=Pe(f),S=p.c,A=p.n,k=new z(19),F=0;F<m.length;++F)++k[m[F]&31];for(var F=0;F<S.length;++F)++k[S[F]&31];for(var v=ue(k,7),O=v.t,j=v.l,M=19;M>4&&!O[ke[M-1]];--M);var W=c+5<<3,I=ie(s,Y)+ie(a,he)+o,B=ie(s,C)+ie(a,f)+o+14+3*M+ie(k,O)+2*k[16]+3*k[17]+7*k[18];if(l>=0&&W<=I&&W<=B)return ze(e,h,i.subarray(l,l+c));var H,N,G,q;if(X(e,h,1+(B<I)),h+=2,B<I){H=oe(C,w,0),N=C,G=oe(f,u,0),q=f;var Fe=oe(O,j,0);X(e,h,E-257),X(e,h+5,A-1),X(e,h+10,M-4),h+=14;for(var F=0;F<M;++F)X(e,h+3*F,O[ke[F]]);h+=3*M;for(var D=[m,S],le=0;le<2;++le)for(var te=D[le],F=0;F<te.length;++F){var V=te[F]&31;X(e,h,Fe[V]),h+=O[V],V>15&&(X(e,h,te[F]>>5&127),h+=te[F]>>12)}}else H=lt,N=Y,G=ht,q=he;for(var F=0;F<n;++F){var $=r[F];if($>255){var V=$>>18&31;se(e,h,H[V+257]),h+=N[V+257],V>7&&(X(e,h,$>>23&31),h+=Ce[V]);var re=$&31;se(e,h,G[re]),h+=q[re],re>3&&(se(e,h,$>>5&8191),h+=ve[re])}else se(e,h,H[$]),h+=N[$]}return se(e,h,H[256]),h+N[256]},ct=new ye([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),He=new L(0),dt=function(i,e,t,r,s,a){var o=a.z||i.length,n=new L(r+o+5*(1+Math.ceil(o/7e3))+s),l=n.subarray(r,n.length-s),c=a.l,h=(a.r||0)&7;if(e){h&&(l[0]=a.r>>3);for(var x=ct[e-1],C=x>>13,w=x&8191,y=(1<<t)-1,f=a.p||new z(32768),u=a.h||new z(y+1),b=Math.ceil(t/3),m=2*b,E=function(Te){return(i[Te]^i[Te+1]<<b^i[Te+2]<<m)&y},p=new ye(25e3),S=new z(288),A=new z(32),k=0,F=0,v=a.i||0,O=0,j=a.w||0,M=0;v+2<o;++v){var W=E(v),I=v&32767,B=u[W];if(f[I]=B,u[W]=I,j<=v){var H=o-v;if((k>7e3||O>24576)&&(H>423||!c)){h=Ne(i,l,0,p,S,A,F,O,M,v-M,h),O=k=F=0,M=v;for(var N=0;N<286;++N)S[N]=0;for(var N=0;N<30;++N)A[N]=0}var G=2,q=0,Fe=w,D=I-B&32767;if(H>2&&W==E(v-D))for(var le=Math.min(C,H)-1,te=Math.min(32767,v),V=Math.min(258,H);D<=te&&--Fe&&I!=B;){if(i[v+G]==i[v+G-D]){for(var $=0;$<V&&i[v+$]==i[v+$-D];++$);if($>G){if(G=$,q=D,$>le)break;for(var re=Math.min(D,$-2),Xe=0,N=0;N<re;++N){var Se=v-D+N&32767,xt=f[Se],je=Se-xt&32767;je>Xe&&(Xe=je,B=Se)}}}I=B,B=f[I],D+=I-B&32767}if(q){p[O++]=268435456|ge[G]<<18|Oe[q];var We=ge[G]&31,Ue=Oe[q]&31;F+=Ce[We]+ve[Ue],++S[257+We],++A[Ue],j=v+G,++k}else p[O++]=i[v],++S[i[v]]}}for(v=Math.max(v,j);v<o;++v)p[O++]=i[v],++S[i[v]];h=Ne(i,l,c,p,S,A,F,O,M,v-M,h),c||(a.r=h&7|l[h/8|0]<<3,h-=7,a.h=u,a.p=f,a.i=v,a.w=j)}else{for(var v=a.w||0;v<o+c;v+=65535){var _e=v+65535;_e>=o&&(l[h/8|0]=c,_e=o),h=ze(l,h+1,i.subarray(v,_e))}a.i=o}return $e(n,0,r+Be(h)+s)},Pt=function(){for(var i=new Int32Array(256),e=0;e<256;++e){for(var t=e,r=9;--r;)t=(t&1&&-306674912)^t>>>1;i[e]=t}return i}(),Nt=function(){var i=-1;return{p:function(e){for(var t=i,r=0;r<e.length;++r)t=Pt[t&255^e[r]]^t>>>8;i=t},d:function(){return~i}}},pt=function(i,e,t,r,s){if(!s&&(s={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new L(a.length+i.length);o.set(a),o.set(i,a.length),i=o,s.w=a.length}return dt(i,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):20:12+e.mem,t,r,s)},Ge=function(i,e){var t={};for(var r in i)t[r]=i[r];for(var r in e)t[r]=e[r];return t},Ke=function(i,e,t){for(var r=i(),s=i.toString(),a=s.slice(s.indexOf("[")+1,s.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<r.length;++o){var n=r[o],l=a[o];if(typeof n=="function"){e+=";"+l+"=";var c=n.toString();if(n.prototype)if(c.indexOf("[native code]")!=-1){var h=c.indexOf(" ",8)+1;e+=c.slice(h,c.indexOf("(",h))}else{e+=c;for(var x in n.prototype)e+=";"+l+".prototype."+x+"="+n.prototype[x].toString()}else e+=c}else t[l]=n}return e},ce=[],It=function(i){var e=[];for(var t in i)i[t].buffer&&e.push((i[t]=new i[t].constructor(i[t])).buffer);return e},Rt=function(i,e,t,r){if(!ce[t]){for(var s="",a={},o=i.length-1,n=0;n<o;++n)s=Ke(i[n],s,a);ce[t]={c:Ke(i[o],s,a),e:a}}var l=Ge({},ce[t].e);return Tt(ce[t].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,l,It(l),r)},Lt=function(){return[L,z,ye,Ce,ve,ke,ge,Oe,lt,Y,ht,he,xe,ct,He,oe,X,se,ue,be,Pe,ie,ze,Ne,Be,$e,dt,pt,De,ut]},ut=function(i){return postMessage(i,[i.buffer])},Mt=function(i,e,t,r,s,a){var o=Rt(t,r,s,function(n,l){o.terminate(),a(n,l)});return o.postMessage([i,e],e.consume?[i.buffer]:[]),function(){o.terminate()}},R=function(i,e,t){for(;t;++e)i[e]=t,t>>>=8};function Bt(i,e,t){return t||(t=e,e={}),typeof t!="function"&&ne(7),Mt(i,e,[Lt],function(r){return ut(De(r.data[0],r.data[1]))},0,t)}function De(i,e){return pt(i,e||{},0,0)}var mt=function(i,e,t,r){for(var s in i){var a=i[s],o=e+s,n=r;Array.isArray(a)&&(n=Ge(r,a[1]),a=a[0]),a instanceof L?t[o]=[a,n]:(t[o+="/"]=[new L(0),n],mt(a,o,t,r))}},Je=typeof TextEncoder<"u"&&new TextEncoder,$t=typeof TextDecoder<"u"&&new TextDecoder,zt=0;try{$t.decode(He,{stream:!0}),zt=1}catch{}function Ie(i,e){var t;if(Je)return Je.encode(i);for(var r=i.length,s=new L(i.length+(i.length>>1)),a=0,o=function(c){s[a++]=c},t=0;t<r;++t){if(a+5>s.length){var n=new L(a+8+(r-t<<1));n.set(s),s=n}var l=i.charCodeAt(t);l<128||e?o(l):l<2048?(o(192|l>>6),o(128|l&63)):l>55295&&l<57344?(l=65536+(l&1047552)|i.charCodeAt(++t)&1023,o(240|l>>18),o(128|l>>12&63),o(128|l>>6&63),o(128|l&63)):(o(224|l>>12),o(128|l>>6&63),o(128|l&63))}return $e(s,0,a)}var Re=function(i){var e=0;if(i)for(var t in i){var r=i[t].length;r>65535&&ne(9),e+=r+4}return e},Ze=function(i,e,t,r,s,a,o,n){var l=r.length,c=t.extra,h=n&&n.length,x=Re(c);R(i,e,o!=null?33639248:67324752),e+=4,o!=null&&(i[e++]=20,i[e++]=t.os),i[e]=20,e+=2,i[e++]=t.flag<<1|(a<0&&8),i[e++]=s&&8,i[e++]=t.compression&255,i[e++]=t.compression>>8;var C=new Date(t.mtime==null?Date.now():t.mtime),w=C.getFullYear()-1980;if((w<0||w>119)&&ne(10),R(i,e,w<<25|C.getMonth()+1<<21|C.getDate()<<16|C.getHours()<<11|C.getMinutes()<<5|C.getSeconds()>>1),e+=4,a!=-1&&(R(i,e,t.crc),R(i,e+4,a<0?-a-2:a),R(i,e+8,t.size)),R(i,e+12,l),R(i,e+14,x),e+=16,o!=null&&(R(i,e,h),R(i,e+6,t.attrs),R(i,e+10,o),e+=14),i.set(r,e),e+=l,x)for(var y in c){var f=c[y],u=f.length;R(i,e,+y),R(i,e+2,u),i.set(f,e+4),e+=4+u}return h&&(i.set(n,e),e+=h),e},Ht=function(i,e,t,r,s){R(i,e,101010256),R(i,e+8,t),R(i,e+10,t),R(i,e+12,r),R(i,e+16,s)};function Gt(i,e,t){t||(t=e,e={}),typeof t!="function"&&ne(7);var r={};mt(i,"",r,e);var s=Object.keys(r),a=s.length,o=0,n=0,l=a,c=new Array(a),h=[],x=function(){for(var u=0;u<h.length;++u)h[u]()},C=function(u,b){Ye(function(){t(u,b)})};Ye(function(){C=t});var w=function(){var u=new L(n+22),b=o,m=n-o;n=0;for(var E=0;E<l;++E){var p=c[E];try{var S=p.c.length;Ze(u,n,p,p.f,p.u,S);var A=30+p.f.length+Re(p.extra),k=n+A;u.set(p.c,k),Ze(u,o,p,p.f,p.u,S,n,p.m),o+=16+A+(p.m?p.m.length:0),n=k+S}catch(F){return C(F,null)}}Ht(u,o,c.length,m,b),C(null,u)};a||w();for(var y=function(u){var b=s[u],m=r[b],E=m[0],p=m[1],S=Nt(),A=E.length;S.p(E);var k=Ie(b),F=k.length,v=p.comment,O=v&&Ie(v),j=O&&O.length,M=Re(p.extra),W=p.level==0?0:8,I=function(B,H){if(B)x(),C(B,null);else{var N=H.length;c[u]=Ge(p,{size:A,crc:S.d(),c:H,f:k,m:O,u:F!=b.length||O&&v.length!=j,compression:W}),o+=30+F+M+N,n+=76+2*(F+M)+(j||0)+N,--a||w()}};if(F>65535&&I(ne(11,0,1),null),!W)I(null,E);else if(A<16e4)try{I(null,De(E,p))}catch(B){I(B,null)}else h.push(Bt(E,p,I))},f=0;f<l;++f)y(f);return x}var Ye=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(i){i()},Dt=Object.defineProperty,Vt=(i,e,t)=>e in i?Dt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,d=(i,e,t)=>Vt(i,typeof e!="symbol"?e+"":e,t);function U(i){const e=typeof i;return i!=null&&(e==="object"||e==="function")}function Xt(i){if(typeof i!="object"||i===null||Object.prototype.toString.call(i)!=="[object Object]")return!1;const e=Object.getPrototypeOf(i);if(e===null)return!0;const t=Object.prototype.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&Function.prototype.call(t)===Function.prototype.call(i)}function ae(i){return i!=null&&typeof i.valueOf()=="string"}const jt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ft=i=>(typeof i!="string"&&(i=`${i}`),i.replace(/[&<>"']/g,e=>jt[e]));class we{constructor(e,t){d(this,"documentElement"),this.documentElement=this.createElement(t),this.documentElement.setAttribute("xmlns",e)}createElement(e){return new Ee({nodeName:e})}createTextNode(e){return new gt(e)}toString(){return this.documentElement.toString()}}d(we,"Node",{Create:i=>{switch(i.type){case"XML":return new Ee(i);case"TEXT":return new gt(i.nodeValue);default:return null}}});class gt{constructor(e){d(this,"nodeValue"),this.nodeValue=e}toJSON(){return{nodeValue:this.nodeValue,type:"TEXT"}}toString(){return ft(this.nodeValue)}}class Ee{constructor(e){if(d(this,"nodeName",""),d(this,"children"),d(this,"nodeValue"),d(this,"attributes"),d(this,"firstChild"),this.nodeName=e.nodeName,this.children=[],this.nodeValue=e.nodeValue||"",this.attributes={},e.children)for(let t=0,r=e.children.length;t<r;t++)this.appendChild(we.Node.Create(e.children[t]));if(e.attributes)for(const t in e.attributes)e.attributes.hasOwnProperty(t)&&this.setAttribute(t,e.attributes[t])}toString(){let e=`<${this.nodeName}`;for(const r in this.attributes)this.attributes.hasOwnProperty(r)&&(e=`${e} ${r}="${ft(this.attributes[r])}"`);let t="";for(let r=0,s=this.children.length;r<s;r++)t+=this.children[r].toString();return t?e+=`>${t}</${this.nodeName}>`:e+="/>",e}toJSON(){const e=[];for(let t=0,r=this.children.length;t<r;t++)e.push(this.children[t].toJSON());return{nodeName:this.nodeName,children:e,nodeValue:this.nodeValue,attributes:this.attributes,type:"XML"}}setAttribute(e,t){if(t===null){delete this.attributes[e],delete this[e];return}this.attributes[e]=t,this[e]=t}appendChild(e){this.children.push(e),this.firstChild=this.children[0]}cloneNode(e){return new Ee(this.toJSON())}}const me=class ee{static uniqueId(e){return ee._idSpaces[e]||(ee._idSpaces[e]=1),ee._idSpaces[e]++}static createXmlDoc(e,t){return new we(e||null,t)}static createElement(e,t,r){const s=e.createElement(t);r=r||[];let a=r.length;for(;a--;)s.setAttribute(r[a][0],r[a][1]);return s}static setAttributesOnDoc(e,t){for(let[r,s]of Object.entries(t)){if(Xt(s))if(s.v!==null&&s.v!==void 0)switch(s.type){case Boolean:s=s.v?"1":"0";break}else s=null;s!=null&&e.setAttribute(r,s)}}static positionToLetterRef(e,t){let r=1,s,a=e,o="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";if(ee.LETTER_REFS[e])return ee.LETTER_REFS[e].concat(t);for(;a>0;)a-=Math.pow(26,r-1),s=a%Math.pow(26,r),a-=s,s=s/Math.pow(26,r-1),o=n.charAt(s)+o,r+=1;return ee.LETTER_REFS[e]=o,o.concat(String(t))}};d(me,"_idSpaces",{}),d(me,"LETTER_REFS",{}),d(me,"schemas",{worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"});let g=me;const Ae={};function Q(i="$lodash$"){Ae[i]||(Ae[i]=0);const e=++Ae[i];return i==="$lodash$"?`${e}`:`${i}${e}`}const J={};class Le{constructor(){d(this,"relations",{}),d(this,"lastId",1),Q("rId")}importData(e){this.relations=e.relations,this.lastId=e.lastId}exportData(){return{relations:this.relations,lastId:this.lastId}}addRelation(e,t){return this.relations[e.id]={id:Q("rId"),schema:g.schemas[t],object:e},this.relations[e.id].id}getRelationshipId(e){return this.relations[e.id]?this.relations[e.id].id:null}toXML(){const e=g.createXmlDoc(g.schemas.relationshipPackage,"Relationships"),t=e.documentElement;for(const[r,s]of Object.entries(this.relations)){const a=g.createElement(e,"Relationship",[["Id",s.id],["Type",s.schema],["Target",s.object.target||J[r]]]);s.object.targetMode&&a.setAttribute("TargetMode",s.object.targetMode),t.appendChild(a)}return e}}class Wt{constructor(){d(this,"state",null),d(this,"xSplit",null),d(this,"ySplit",null),d(this,"activePane","bottomRight"),d(this,"topLeftCell",null),d(this,"_freezePane")}freezePane(e,t,r){this._freezePane={xSplit:e,ySplit:t,cell:r}}exportXML(e){const t=e.createElement("pane");return this.state!==null&&(t.setAttribute("xSplit",this._freezePane.xSplit),t.setAttribute("ySplit",this._freezePane.ySplit),t.setAttribute("topLeftCell",this._freezePane.cell),t.setAttribute("activePane","bottomRight"),t.setAttribute("state","frozen")),t}}class Qe{constructor(){d(this,"strings",{}),d(this,"stringArray",[]),d(this,"id",Q("SharedStrings"))}addString(e){return this.strings[e]=this.stringArray.length,this.stringArray[this.stringArray.length]=e,this.strings[e]}exportData(){return this.strings}toXML(){const e=g.createXmlDoc(g.schemas.spreadsheetml,"sst"),t=e.documentElement;this.stringArray.reverse();let r=this.stringArray.length;t.setAttribute("count",r),t.setAttribute("uniqueCount",r);const s=e.createElement("si"),a=e.createElement("t");a.appendChild(e.createTextNode("--placeholder--")),s.appendChild(a);const o=this.stringArray;for(;r--;){const n=s.cloneNode(!0);typeof o[r]=="string"&&o[r].match(/\s+/)&&n.firstChild.setAttribute("xml:space","preserve"),n.firstChild.firstChild.nodeValue=o[r],t.appendChild(n)}return e}}class Ut{constructor(e){d(this,"pane"),d(this,"showZeros",null),d(this,"defaultGridColor",null),d(this,"colorId",null),d(this,"rightToLeft",null),d(this,"showFormulas",null),d(this,"showGridLines",null),d(this,"showOutlineSymbols",null),d(this,"showRowColHeaders",null),d(this,"showRuler",null),d(this,"showWhiteSpace",null),d(this,"tabSelected",null),d(this,"topLeftCell",null),d(this,"viewType",null),d(this,"windowProtection",null),d(this,"zoomScale",null),d(this,"zoomScaleNormal",null),d(this,"zoomScalePageLayoutView",null),d(this,"zoomScaleSheetLayoutView",null);const t=e||{};this.pane=t.pane||new Wt}freezePane(e,t,r){this.pane.state="frozen",this.pane.xSplit=e,this.pane.ySplit=t,this.pane.topLeftCell=r}exportXML(e){const t=e.createElement("sheetViews"),r=e.createElement("sheetView");return g.setAttributesOnDoc(r,{workbookViewId:0,showZeros:{v:this.showZeros,type:Boolean},defaultGridColor:{v:this.defaultGridColor,type:Boolean},colorId:this.colorId,rightToLeft:{v:this.rightToLeft,type:Boolean},showFormulas:{v:this.showFormulas,type:Boolean},showGridLines:{v:this.showGridLines,type:Boolean},showOutlineSymbols:{v:this.showOutlineSymbols,type:Boolean},showRowColHeaders:{v:this.showRowColHeaders,type:Boolean},showRuler:{v:this.showRuler,type:Boolean},showWhiteSpace:{v:this.showWhiteSpace,type:Boolean},tabSelected:{v:this.tabSelected,type:Boolean},viewType:this.viewType,windowProtection:{v:this.windowProtection,type:Boolean},zoomScale:{v:this.zoomScale,type:Boolean},zoomScaleNormal:this.zoomScaleNormal,zoomScalePageLayoutView:this.zoomScalePageLayoutView,zoomScaleSheetLayoutView:this.zoomScaleSheetLayoutView}),r.appendChild(this.pane.exportXML(e)),t.appendChild(r),t}}function qt(i,e){return e.reduce((t,r)=>(i!=null&&i.hasOwnProperty(r)&&(t[r]=i[r]),t),{})}class et{constructor(){d(this,"id",Q("StyleSheet")),d(this,"cellStyles",[{name:"Normal",xfId:"0",builtinId:"0"}]),d(this,"defaultTableStyle",!1),d(this,"differentialStyles",[{}]),d(this,"masterCellFormats",[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfid:0}]),d(this,"masterCellStyles",[{numFmtId:0,fontId:0,fillId:0,borderId:0}]),d(this,"fonts",[{}]),d(this,"numberFormatters",[]),d(this,"fills",[{},{type:"pattern",patternType:"gray125",fgColor:"FF333333",bgColor:"FF333333"}]),d(this,"borders",[{top:{},left:{},right:{},bottom:{},diagonal:{}}]),d(this,"tableStyles",[])}createSimpleFormatter(e){const t={id:this.masterCellFormats.length};switch(e){case"date":t.numFmtId=14;break}return this.masterCellFormats.push(t),t}createFill(e){const t=this.fills.length,r=e;return r.id=t,this.fills.push(r),r}createNumberFormatter(e){const t={id:this.numberFormatters.length+100,formatCode:e};return this.numberFormatters.push(t),t}createFormat(e){const t={id:this.masterCellFormats.length};if(e.protection&&(t.protection=e.protection),e.font&&U(e.font))t.fontId=this.createFontStyle(e.font).id;else if(e.font){if(Number.isNaN(Number.parseInt(e.font,10)))throw new Error("Passing a non-numeric font id is not supported");t.fontId=e.font}if(e.format&&ae(e.format))t.numFmtId=this.createNumberFormatter(e.format).id;else if(e.format){if(Number.isNaN(Number.parseInt(e.format,10)))throw new Error("Invalid number formatter id");t.numFmtId=e.format}if(e.border&&U(e.border))t.borderId=this.createBorderFormatter(e.border).id;else if(e.border){if(Number.isNaN(Number.parseInt(e.border,10)))throw new Error("Passing a non-numeric border id is not supported");t.borderId=e.border}if(e.fill&&U(e.fill))t.fillId=this.createFill(e.fill).id;else if(e.fill){if(Number.isNaN(Number.parseInt(e.fill,10)))throw new Error("Passing a non-numeric fill id is not supported");t.fillId=e.fill}return e.alignment&&U(e.alignment)&&(t.alignment=qt(e.alignment,["horizontal","justifyLastLine","readingOrder","relativeIndent","shrinkToFit","textRotation","vertical","wrapText"])),this.masterCellFormats.push(t),t}createDifferentialStyle(e){const t=this.differentialStyles.length,r={id:t};return e.font&&U(e.font)&&(r.font=e.font),e.border&&U(e.border)&&(r.border=Object.assign({top:{},left:{},right:{},bottom:{},diagonal:{}},e.border)),e.fill&&U(e.fill)&&(r.fill=e.fill),e.alignment&&U(e.alignment)&&(r.alignment=e.alignment),e.format&&ae(e.format)&&(r.numFmt=e.format),this.differentialStyles[t]=r,r}createTableStyle(e){this.tableStyles.push(e)}createBorderFormatter(e){return e={top:{},left:{},right:{},bottom:{},diagonal:{},id:this.borders.length,...e},this.borders.push(e),e}createFontStyle(e){const t={id:this.fonts.length};return e.bold&&(t.bold=!0),e.italic&&(t.italic=!0),e.superscript&&(t.vertAlign="superscript"),e.subscript&&(t.vertAlign="subscript"),e.underline&&(typeof e.underline=="string"&&["double","singleAccounting","doubleAccounting"].includes(e.underline)?t.underline=e.underline:t.underline=!0),e.strike&&(t.strike=!0),e.outline&&(t.outline=!0),e.shadow&&(t.shadow=!0),e.size&&(t.size=e.size),e.color&&(t.color=e.color),e.fontName&&(t.fontName=e.fontName),this.fonts.push(t),t}exportBorders(e){const t=e.createElement("borders");t.setAttribute("count",this.borders.length);for(let r=0,s=this.borders.length;r<s;r++)t.appendChild(this.exportBorder(e,this.borders[r]));return t}exportBorder(e,t){const r=e.createElement("border"),s=a=>{const o=e.createElement(a);return t[a].style&&o.setAttribute("style",t[a].style),t[a].color&&o.appendChild(this.exportColor(e,t[a].color)),o};return r.appendChild(s("left")),r.appendChild(s("right")),r.appendChild(s("top")),r.appendChild(s("bottom")),r.appendChild(s("diagonal")),r}exportColor(e,t){const r=e.createElement("color");return ae(t)?(r.setAttribute("rgb",t),r):(t.tint!==void 0&&r.setAttribute("tint",t.tint),t.auto!==void 0&&r.setAttribute("auto",String(!!t.auto)),t.theme!==void 0&&r.setAttribute("theme",t.theme),r)}exportMasterCellFormats(e){const t=g.createElement(e,"cellXfs",[["count",this.masterCellFormats.length]]);for(let r=0,s=this.masterCellFormats.length;r<s;r++){const a=this.masterCellFormats[r];t.appendChild(this.exportCellFormatElement(e,a))}return t}exportMasterCellStyles(e){const t=g.createElement(e,"cellStyleXfs",[["count",this.masterCellStyles.length]]);for(let r=0,s=this.masterCellStyles.length;r<s;r++){const a=this.masterCellStyles[r];t.appendChild(this.exportCellFormatElement(e,a))}return t}exportCellFormatElement(e,t){const r=e.createElement("xf"),s=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","xfId"],a=Object.keys(t).filter(n=>s.indexOf(n)!==-1);if(t.alignment){const n=t.alignment;r.appendChild(this.exportAlignment(e,n))}t.protection&&(r.appendChild(this.exportProtection(e,t.protection)),r.setAttribute("applyProtection","1"));let o=a.length;for(;o--;)r.setAttribute(a[o],t[a[o]]);return t.fillId&&r.setAttribute("applyFill","1"),t.fontId&&r.setAttribute("applyFont","1"),t.borderId&&r.setAttribute("applyBorder","1"),t.alignment&&r.setAttribute("applyAlignment","1"),t.numFmtId&&r.setAttribute("applyNumberFormat","1"),t.numFmtId!==void 0&&t.xfId===void 0&&r.setAttribute("xfId","0"),r}exportAlignment(e,t){const r=e.createElement("alignment"),s=Object.keys(t);for(let a=0,o=s.length;a<o;a++)r.setAttribute(s[a],t[s[a]]);return r}exportFonts(e){const t=e.createElement("fonts");t.setAttribute("count",String(this.fonts.length));for(let r=0,s=this.fonts.length;r<s;r++){const a=this.fonts[r];t.appendChild(this.exportFont(e,a))}return t}exportFont(e,t){const r=e.createElement("font");if(t.size){const s=e.createElement("sz");s.setAttribute("val",t.size),r.appendChild(s)}if(t.fontName){const s=e.createElement("name");s.setAttribute("val",t.fontName),r.appendChild(s)}if(t.bold&&r.appendChild(e.createElement("b")),t.italic&&r.appendChild(e.createElement("i")),t.vertAlign){const s=e.createElement("vertAlign");s.setAttribute("val",t.vertAlign),r.appendChild(s)}if(t.underline){const s=e.createElement("u");t.underline!==!0&&s.setAttribute("val",t.underline),r.appendChild(s)}return t.strike&&r.appendChild(e.createElement("strike")),t.shadow&&r.appendChild(e.createElement("shadow")),t.outline&&r.appendChild(e.createElement("outline")),t.color&&r.appendChild(this.exportColor(e,t.color)),r}exportFills(e){const t=e.createElement("fills");t.setAttribute("count",String(this.fills.length));for(let r=0,s=this.fills.length;r<s;r++){const a=this.fills[r];t.appendChild(this.exportFill(e,a))}return t}exportFill(e,t){let r;const s=e.createElement("fill");return t.type==="pattern"?(r=this.exportPatternFill(e,t),s.appendChild(r)):t.type==="gradient"&&(r=this.exportGradientFill(e,t),s.appendChild(r)),s}exportGradientFill(e,t){const r=e.createElement("gradientFill");t.degree?r.setAttribute("degree",t.degree):t.left&&(r.setAttribute("left",t.left),r.setAttribute("right",t.right),r.setAttribute("top",t.top),r.setAttribute("bottom",t.bottom));const s=e.createElement("stop");s.setAttribute("position",t.start.pureAt||0);const a=e.createElement("color");typeof t.start=="string"||t.start.color?a.setAttribute("rgb",t.start.color||t.start):t.start.theme&&a.setAttribute("theme",t.start.theme);const o=e.createElement("stop"),n=e.createElement("color");return o.setAttribute("position",t.end.pureAt||1),typeof t.start=="string"||t.end.color?n.setAttribute("rgb",t.end.color||t.end):t.end.theme&&n.setAttribute("theme",t.end.theme),s.appendChild(a),o.appendChild(n),r.appendChild(s),r.appendChild(o),r}exportPatternFill(e,t){const r=g.createElement(e,"patternFill",[["patternType",t.patternType]]);t.bgColor||(t.bgColor="FFFFFFFF"),t.fgColor||(t.fgColor="FFFFFFFF");const s=e.createElement("bgColor");ae(t.bgColor)?s.setAttribute("rgb",t.bgColor):t.bgColor.theme?s.setAttribute("theme",t.bgColor.theme):s.setAttribute("rgb",t.bgColor.rbg);const a=e.createElement("fgColor");return ae(t.fgColor)?a.setAttribute("rgb",t.fgColor):t.fgColor.theme?a.setAttribute("theme",t.fgColor.theme):a.setAttribute("rgb",t.fgColor.rbg),r.appendChild(a),r.appendChild(s),r}exportNumberFormatters(e){const t=e.createElement("numFmts");t.setAttribute("count",String(this.numberFormatters.length));for(let r=0,s=this.numberFormatters.length;r<s;r++){const a=this.numberFormatters[r];t.appendChild(this.exportNumberFormatter(e,a))}return t}exportNumberFormatter(e,t){const r=e.createElement("numFmt");return r.setAttribute("numFmtId",t.id),r.setAttribute("formatCode",t.formatCode),r}exportCellStyles(e){const t=e.createElement("cellStyles");t.setAttribute("count",String(this.cellStyles.length));for(let r=0,s=this.cellStyles.length;r<s;r++){const a=this.cellStyles[r];delete a.id;const o=g.createElement(e,"cellStyle");t.appendChild(o);const n=Object.keys(a);let l=n.length;for(;l--;)o.setAttribute(n[l],a[n[l]])}return t}exportDifferentialStyles(e){const t=e.createElement("dxfs");t.setAttribute("count",String(this.differentialStyles.length));for(let r=0,s=this.differentialStyles.length;r<s;r++){const a=this.differentialStyles[r];t.appendChild(this.exportDFX(e,a))}return t}exportDFX(e,t){const r=e.createElement("dxf");return t.font&&r.appendChild(this.exportFont(e,t.font)),t.fill&&r.appendChild(this.exportFill(e,t.fill)),t.border&&r.appendChild(this.exportBorder(e,t.border)),t.numFmt&&r.appendChild(this.exportNumberFormatter(e,t.numFmt)),t.alignment&&r.appendChild(this.exportAlignment(e,t.alignment)),r}exportTableStyles(e){const t=e.createElement("tableStyles");t.setAttribute("count",String(this.tableStyles.length)),this.defaultTableStyle&&t.setAttribute("defaultTableStyle",String(this.defaultTableStyle));for(let r=0,s=this.tableStyles.length;r<s;r++)t.appendChild(this.exportTableStyle(e,this.tableStyles[r]));return t}exportTableStyle(e,t){const r=e.createElement("tableStyle");r.setAttribute("name",t.name),r.setAttribute("pivot",String(0));let s=0;return Object.entries(t).forEach(([a,o])=>{if(a==="name")return;s++;const n=e.createElement("tableStyleElement");n.setAttribute("type",a),n.setAttribute("dxfId",o),r.appendChild(n)}),r.setAttribute("count",String(s)),r}exportProtection(e,t){const r=e.createElement("protection");for(const s in t)s in t&&r.setAttribute(s,t[s]);return r}toXML(){const e=g.createXmlDoc(g.schemas.spreadsheetml,"styleSheet"),t=e.documentElement;return t.appendChild(this.exportNumberFormatters(e)),t.appendChild(this.exportFonts(e)),t.appendChild(this.exportFills(e)),t.appendChild(this.exportBorders(e)),t.appendChild(this.exportMasterCellStyles(e)),t.appendChild(this.exportMasterCellFormats(e)),t.appendChild(this.exportCellStyles(e)),t.appendChild(this.exportDifferentialStyles(e)),this.tableStyles.length&&t.appendChild(this.exportTableStyles(e)),e}}class Kt{constructor(e){d(this,"name",""),d(this,"id",Q("Worksheet")),d(this,"_timezoneOffset"),d(this,"relations",null),d(this,"columnFormats",[]),d(this,"data",[]),d(this,"mergedCells",[]),d(this,"columns",[]),d(this,"sheetProtection",!1),d(this,"_headers",[]),d(this,"_footers",[]),d(this,"_tables",[]),d(this,"_drawings",[]),d(this,"_orientation"),d(this,"_margin"),d(this,"_rowInstructions",{}),d(this,"_freezePane",{}),d(this,"sharedStrings",null),d(this,"hyperlinks",[]),d(this,"sheetView"),d(this,"showZeros",null),this._timezoneOffset=new Date().getTimezoneOffset()*60*1e3,this.sheetView=e.sheetView||new Ut,this.initialize(e)}initialize(e){e=e||{},this.name=e.name,this.id=Q("Worksheet"),this._timezoneOffset=new Date().getTimezoneOffset()*60*1e3,e.columns&&this.setColumns(e.columns),this.relations=new Le}exportData(){return{relations:this.relations.exportData(),columnFormats:this.columnFormats,data:this.data,columns:this.columns,mergedCells:this.mergedCells,_headers:this._headers,_footers:this._footers,_tables:this._tables,_rowInstructions:this._rowInstructions,_freezePane:this._freezePane,name:this.name,id:this.id}}importData(e){this.relations.importData(e.relations),delete e.relations,Object.assign(this,e)}setSharedStringCollection(e){this.sharedStrings=e}addTable(e){this._tables.push(e),this.relations.addRelation(e,"table")}addDrawings(e){this._drawings.push(e),this.relations.addRelation(e,"drawingRelationship")}setRowInstructions(e,t){this._rowInstructions[e]=t}setHeader(e){if(!Array.isArray(e))throw"Invalid argument type - setHeader expects an array of three instructions";this._headers=e}setFooter(e){if(!Array.isArray(e))throw"Invalid argument type - setFooter expects an array of three instructions";this._footers=e}compilePageDetailPackage(e){return e=e||"",["&L",this.compilePageDetailPiece(e[0]||""),"&C",this.compilePageDetailPiece(e[1]||""),"&R",this.compilePageDetailPiece(e[2]||"")].join("")}compilePageDetailPiece(e){if(ae(e))return'&"-,Regular"'.concat(e);if(U(e)&&!Array.isArray(e)){let t="";if(e.font||e.bold){const r=e.bold?"Bold":"Regular";t+=`&"${e.font||"-"}`,t+=`,${r}"`}else t+='&"-,Regular"';return e.underline&&(t+="&U"),e.fontSize&&(t+=`&${e.fontSize}`),t+=e.text,t}if(Array.isArray(e))return e.reduce((t,r)=>t.concat(this.compilePageDetailPiece(r)),"")}exportHeader(e){const t=e.createElement("oddHeader");return t.appendChild(e.createTextNode(this.compilePageDetailPackage(this._headers))),t}exportFooter(e){const t=e.createElement("oddFooter");return t.appendChild(e.createTextNode(this.compilePageDetailPackage(this._footers))),t}_buildCache(e){const t=e.createElement("c"),r=e.createElement("v");r.appendChild(e.createTextNode("--temp--")),t.appendChild(r);const s=e.createElement("c"),a=e.createElement("f");a.appendChild(e.createTextNode("--temp--")),s.appendChild(a);const o=e.createElement("c");o.setAttribute("t","s");const n=e.createElement("v");return n.appendChild(e.createTextNode("--temp--")),o.appendChild(n),{number:t,date:t,string:o,formula:s}}collectSharedStrings(){const e=this.data,t={};for(let r=0,s=e.length;r<s;r++){const a=e[r],o=a.length;for(let n=0;n<o;n++){let l=a[n];const c=(l==null?void 0:l.metadata)||{};l&&typeof l=="object"&&(l=l.value),c.type||typeof l=="number"&&(c.type="number"),(c.type==="text"||!c.type)&&typeof t[l]>"u"&&(t[l]=!0)}}return Object.keys(t)}toXML(){var e,t,r;const s=this.data,a=this.columns||[],o=g.createXmlDoc(g.schemas.spreadsheetml,"worksheet"),n=o.documentElement;let l,c,h;n.setAttribute("xmlns:r",g.schemas.relationships),n.setAttribute("xmlns:mc",g.schemas.markupCompat);let x=0;const C=g.createElement(o,"sheetData"),w=this._buildCache(o);for(h=0,c=s.length;h<c;h++){const y=s[h],f=y.length;x=f>x?f:x;const u=o.createElement("row");for(let b=0;b<f;b++){a[b]=a[b]||{};let m=y[b],E;const p=(m==null?void 0:m.metadata)||{};switch(m&&typeof m=="object"&&(m=m.value),p.type||typeof m=="number"&&(p.type="number"),p.type){case"number":E=w.number.cloneNode(!0),E.firstChild.firstChild.nodeValue=m;break;case"date":E=w.date.cloneNode(!0),m instanceof Date&&(m=m.getTime()),E.firstChild.firstChild.nodeValue=25569+(m-this._timezoneOffset)/(60*60*24*1e3);break;case"formula":E=w.formula.cloneNode(!0),E.firstChild.firstChild.nodeValue=m;break;case"text":default:{let S;typeof((e=this.sharedStrings)==null?void 0:e.strings[m])<"u"?S=this.sharedStrings.strings[m]:S=(t=this.sharedStrings)==null?void 0:t.addString(m),E=w.string.cloneNode(!0),E.firstChild.firstChild.nodeValue=S;break}}p.style?E.setAttribute("s",p.style):((r=this._rowInstructions[h])==null?void 0:r.style)!==void 0&&E.setAttribute("s",this._rowInstructions[h].style),E.setAttribute("r",g.positionToLetterRef(b+1,String(h+1))),u.appendChild(E)}if(u.setAttribute("r",h+1),this._rowInstructions[h]){const b=this._rowInstructions[h];b.height!==void 0&&(u.setAttribute("customHeight","1"),u.setAttribute("ht",b.height)),b.style!==void 0&&(u.setAttribute("customFormat","1"),u.setAttribute("s",b.style))}C.appendChild(u)}if(x!==0?n.appendChild(g.createElement(o,"dimension",[["ref",`${g.positionToLetterRef(1,1)}:${g.positionToLetterRef(x,String(s.length))}`]])):n.appendChild(g.createElement(o,"dimension",[["ref",g.positionToLetterRef(1,1)]])),n.appendChild(this.sheetView.exportXML(o)),this.columns.length&&n.appendChild(this.exportColumns(o)),n.appendChild(C),this.sheetProtection&&n.appendChild(this.sheetProtection.exportXML(o)),this.hyperlinks.length>0){const y=o.createElement("hyperlinks"),f=this.hyperlinks;for(l=0,c=f.length;l<c;l++){const u=o.createElement("hyperlink"),b=f[l];u.setAttribute("ref",String(b.cell)),b.id=g.uniqueId("hyperlink"),this.relations.addRelation({id:b.id,target:b.location,targetMode:b.targetMode||"External"},"hyperlink"),u.setAttribute("r:id",this.relations.getRelationshipId(b)),y.appendChild(u)}n.appendChild(y)}if(this.mergedCells.length>0){const y=o.createElement("mergeCells");for(l=0,c=this.mergedCells.length;l<c;l++){const f=o.createElement("mergeCell");f.setAttribute("ref",`${this.mergedCells[l][0]}:${this.mergedCells[l][1]}`),y.appendChild(f)}n.appendChild(y)}if(this.exportPageSettings(o,n),this._headers.length>0||this._footers.length>0){const y=o.createElement("headerFooter");this._headers.length>0&&y.appendChild(this.exportHeader(o)),this._footers.length>0&&y.appendChild(this.exportFooter(o)),n.appendChild(y)}for(l=0,c=this._drawings.length;l<c;l++){const y=o.createElement("drawing");y.setAttribute("r:id",this.relations.getRelationshipId(this._drawings[l])),n.appendChild(y)}if(this._tables.length>0){const y=o.createElement("tableParts");for(y.setAttribute("count",this._tables.length),l=0,c=this._tables.length;l<c;l++){const f=o.createElement("tablePart");f.setAttribute("r:id",this.relations.getRelationshipId(this._tables[l])),y.appendChild(f)}n.appendChild(y)}return o}exportColumns(e){const t=g.createElement(e,"cols");for(let r=0,s=this.columns.length;r<s;r++){const a=this.columns[r],o=g.createElement(e,"col",[["min",a.min||r+1],["max",a.max||r+1]]);a.hidden&&o.setAttribute("hidden",String(1)),a.bestFit&&o.setAttribute("bestFit",String(1)),(a.customWidth||a.width)&&o.setAttribute("customWidth",String(1)),a.width?o.setAttribute("width",a.width):o.setAttribute("width",String(9.140625)),t.appendChild(o)}return t}exportPageSettings(e,t){if(this._margin){let r=.7;const s=this._margin.left?this._margin.left:r,a=this._margin.right?this._margin.right:r,o=this._margin.top?this._margin.top:r,n=this._margin.bottom?this._margin.bottom:r;r=.3;const l=this._margin.header?this._margin.header:r,c=this._margin.footer?this._margin.footer:r;t.appendChild(g.createElement(e,"pageMargins",[["top",o],["bottom",n],["left",s],["right",a],["header",l],["footer",c]]))}this._orientation&&t.appendChild(g.createElement(e,"pageSetup",[["orientation",this._orientation]]))}setPageOrientation(e){this._orientation=e}setPageMargin(e){this._margin=e}setColumns(e){this.columns=e}setData(e){this.data=e}mergeCells(e,t){this.mergedCells.push([e,t])}freezePane(e,t,r){this.sheetView.freezePane(e,t,r)}setColumnFormats(e){this.columnFormats=e}}class Jt{constructor(){d(this,"id",Q("Workbook")),d(this,"styleSheet",new et),d(this,"sharedStrings",new Qe),d(this,"relations",new Le),d(this,"worksheets",[]),d(this,"tables",[]),d(this,"drawings",[]),d(this,"media",{}),d(this,"printTitles"),this.initialize()}initialize(){this.id=Q("Workbook"),this.styleSheet=new et,this.sharedStrings=new Qe,this.relations=new Le,this.relations.addRelation(this.styleSheet,"stylesheet"),this.relations.addRelation(this.sharedStrings,"sharedStrings")}createWorksheet(e){return e=Object.assign({},{name:"Sheet ".concat(String(this.worksheets.length+1))},e),new Kt(e)}getStyleSheet(){return this.styleSheet}addTable(e){this.tables.push(e)}addDrawings(e){this.drawings.push(e)}setPrintTitleTop(e,t){this.printTitles==null&&(this.printTitles={}),this.printTitles[e]==null&&(this.printTitles[e]={}),this.printTitles[e].top=t}setPrintTitleLeft(e,t){this.printTitles==null&&(this.printTitles={}),this.printTitles[e]==null&&(this.printTitles[e]={}),this.printTitles[e].left=String.fromCharCode(64+t)}addMedia(e,t,r,s){const a=t.split("."),o=a[a.length-1];if(!s)switch(o.toLowerCase()){case"jpeg":case"jpg":s="image/jpeg";break;case"png":s="image/png";break;case"gif":s="image/gif";break;default:s=null;break}return this.media[t]||(this.media[t]={id:t,data:r,fileName:t,contentType:s,extension:o}),this.media[t]}addWorksheet(e){this.relations.addRelation(e,"worksheet"),e.setSharedStringCollection(this.sharedStrings),this.worksheets.push(e)}createContentTypes(){const e=g.createXmlDoc(g.schemas.contentTypes,"Types"),t=e.documentElement;let r,s;t.appendChild(g.createElement(e,"Default",[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]])),t.appendChild(g.createElement(e,"Default",[["Extension","xml"],["ContentType","application/xml"]]));const a={};for(const o in this.media)o in this.media&&(a[this.media[o].extension]=this.media[o].contentType);for(const o in a)o in a&&t.appendChild(g.createElement(e,"Default",[["Extension",o],["ContentType",a[o]]]));for(t.appendChild(g.createElement(e,"Override",[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]])),t.appendChild(g.createElement(e,"Override",[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]])),t.appendChild(g.createElement(e,"Override",[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]])),r=0,s=this.worksheets.length;r<s;r++)t.appendChild(g.createElement(e,"Override",[["PartName",`/xl/worksheets/sheet${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]));for(r=0,s=this.tables.length;r<s;r++)t.appendChild(g.createElement(e,"Override",[["PartName",`/xl/tables/table${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]));for(r=0,s=this.drawings.length;r<s;r++)t.appendChild(g.createElement(e,"Override",[["PartName",`/xl/drawings/drawing${r+1}.xml`],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]));return e}toXML(){const e=g.createXmlDoc(g.schemas.spreadsheetml,"workbook"),t=e.documentElement;t.setAttribute("xmlns:r",g.schemas.relationships);const r=31,s=g.createElement(e,"sheets");for(let n=0,l=this.worksheets.length;n<l;n++){const c=e.createElement("sheet");typeof console<"u"&&this.worksheets[n].name.length>r&&console.log(`Microsoft Excel requires work sheet names to be less than ${r+1} characters long, work sheet name "${this.worksheets[n].name}" is ${this.worksheets[n].name.length} characters long`),c.setAttribute("name",this.worksheets[n].name),c.setAttribute("sheetId",n+1),c.setAttribute("r:id",this.relations.getRelationshipId(this.worksheets[n])),s.appendChild(c)}t.appendChild(s);const a=g.createElement(e,"definedNames");let o=0;for(const n in this.printTitles)if(n in this.printTitles){const l=this.printTitles[n],c=e.createElement("definedName");c.setAttribute("name","_xlnm.Print_Titles"),c.setAttribute("localSheetId",o++);let h="";l.top&&(h+=`${n}!$1:$${l.top}`,l.left&&(h+=",")),l.left&&(h+=`${n}!$A:$${l.left}`),c.appendChild(e.createTextNode(h)),a.appendChild(c)}return t.appendChild(a),e}createWorkbookRelationship(){const e=g.createXmlDoc(g.schemas.relationshipPackage,"Relationships");return e.documentElement.appendChild(g.createElement(e,"Relationship",[["Id","rId1"],["Type",g.schemas.officeDocument],["Target","xl/workbook.xml"]])),e}_generateCorePaths(e){let t,r;for(J[this.styleSheet.id]="styles.xml",J[this.sharedStrings.id]="sharedStrings.xml",J[this.id]="/xl/workbook.xml",t=0,r=this.tables.length;t<r;t++)e[`/xl/tables/table${t+1}.xml`]=this.tables[t].toXML(),J[this.tables[t].id]=`/xl/tables/table${t+1}.xml`;for(const s in this.media)if(s in this.media){const a=this.media[s];e[`/xl/media/${s}`]=a.data,J[s]=`/xl/media/${s}`}for(t=0,r=this.drawings.length;t<r;t++)e[`/xl/drawings/drawing${t+1}.xml`]=this.drawings[t].toXML(),J[this.drawings[t].id]=`/xl/drawings/drawing${t+1}.xml`,e[`/xl/drawings/_rels/drawing${t+1}.xml.rels`]=this.drawings[t].relations.toXML()}_prepareFilesForPackaging(e){Object.assign(e,{"/[Content_Types].xml":this.createContentTypes(),"/_rels/.rels":this.createWorkbookRelationship(),"/xl/styles.xml":this.styleSheet.toXML(),"/xl/workbook.xml":this.toXML(),"/xl/sharedStrings.xml":this.sharedStrings.toXML(),"/xl/_rels/workbook.xml.rels":this.relations.toXML()});for(const[t,r]of Object.entries(e))if(t.indexOf(".xml")!==-1||t.indexOf(".rels")!==-1){r instanceof we?e[t]=r.toString():e[t]=r.xml||new window.XMLSerializer().serializeToString(r);let s=e[t].replace(/xmlns=""/g,"");s=s.replace(/NS[\d]+:/g,""),s=s.replace(/xmlns:NS[\d]+=""/g,""),e[t]=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
${s}`}}generateFiles(){return new Promise(e=>{const t={};this._generateCorePaths(t);for(let r=0,s=this.worksheets.length;r<s;r++)t[`/xl/worksheets/sheet${r+1}.xml`]=this.worksheets[r].toXML(),J[this.worksheets[r].id]=`worksheets/sheet${r+1}.xml`,t[`/xl/worksheets/_rels/sheet${r+1}.xml.rels`]=this.worksheets[r].relations.toXML();return this._prepareFilesForPackaging(t),e(t)})}}function Zt(i){const e=i.replace(/-/g,"+").replace(/_/g,"/"),t="=".repeat((4-e.length%4)%4),r=e+t,s=atob(r);return Uint8Array.from(s,a=>a.charCodeAt(0))}function Yt(i,e,t){const r={};return new Promise((s,a)=>{i.generateFiles().then(o=>{for(const[n,l]of Object.entries(o)){const c=n.substr(1);n.indexOf(".xml")!==-1||n.indexOf(".rel")!==-1?r[c]=Ie(l):r[c]=Zt(l)}return Gt(r,(t==null?void 0:t.zipOptions)||{},(n,l)=>{if(n){a(n);return}{const c=(t==null?void 0:t.fileFormat)??"xlsx";let h=t==null?void 0:t.mimeType;h===void 0&&(h=c==="xls"?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),s(new Blob([l],{type:h}))}})})})}function Qt(i,e,t){if((t==null?void 0:t.downloadType)==="node")throw new Error('[Excel-Builder-Vanilla] Please note that `downloadExcelFile()` is currently only supporting the "browser" download type at the moment.');const r=e.match(/.*\.xls$/)?"xls":"xlsx";return Yt(i,"Blob",{...t,fileFormat:r}).then(s=>{er(e,s)})}function er(i,e){const t=document.createElement("a"),r=URL.createObjectURL(e);t&&document&&(t.textContent="download",t.href=r,t.setAttribute("download",i),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(r))}const tr=(i,{excelFormatId:e})=>e!==void 0?{value:i,metadata:{style:e}}:i,rr=(i,{columnDef:e,excelFormatId:t,gridOptions:r})=>({value:typeof i=="string"&&/\d/g.test(i)?sr(i,e,r):i,metadata:{style:t}});function sr(i,e,t){let r=i;if(typeof i=="string"&&i){const s=yt("decimalSeparator",e,t,at.DEFAULT_NUMBER_DECIMAL_SEPARATOR),a=parseFloat(s===","?i.replace(/[^0-9,-]+/g,"").replace(",","."):i.replace(/[^\d.-]/g,""));r=isNaN(a)?i:a}return r}function ir(i,e,t,r,s=!0){const a=fe(t);let o,n=tr;return a===Me.number&&s&&(o=Ve(i,e,t,r,"cell").excelFormat.id,n=rr),{excelFormatId:o,getDataValueParser:n}}function ar(i,e){var t;return((t=i==null?void 0:i[e.groupType])==null?void 0:t[e.columnDef.field])??0}function or(i,e,t){var s;let r;if(t==="group")switch(i.groupTotalsFormatter){case _.avgTotalsCurrency:case _.avgTotalsDollar:case _.sumTotalsCurrency:case _.sumTotalsCurrencyColored:case _.sumTotalsDollar:case _.sumTotalsDollarBold:case _.sumTotalsDollarColored:case _.sumTotalsDollarColoredBold:r="currency";break;case _.avgTotalsPercentage:r="percent";break;case _.avgTotals:case _.minTotals:case _.maxTotals:case _.sumTotals:case _.sumTotalsColored:case _.sumTotalsBold:default:r="decimal";break}else if(i.formatter===P.multiple&&Array.isArray((s=i.params)==null?void 0:s.formatters)){r="decimal";for(const a of i.params.formatters)if(r=tt(a),r!=="decimal")break}else r=tt(i.formatter);return bt(i,e,r,t)}function tt(i){let e;switch(i){case P.currency:case P.dollar:case P.dollarColored:case P.dollarColoredBold:e="currency";break;case P.percent:case P.percentComplete:case P.percentCompleteBar:case P.percentCompleteBarWithText:case P.percentSymbol:e="percent";break;case P.decimal:default:e="decimal";break}return e}function Ve(i,e,t,r,s){var c,h;let a="",o=((c=t.groupTotalsExcelExportOptions)==null?void 0:c.groupType)||"",n;const l=fe(t);if(s==="group")switch(t.groupTotalsFormatter){case _.avgTotals:case _.avgTotalsCurrency:case _.avgTotalsDollar:case _.avgTotalsPercentage:o="avg";break;case _.minTotals:o="min";break;case _.maxTotals:o="max";break;case _.sumTotals:case _.sumTotalsBold:case _.sumTotalsColored:case _.sumTotalsCurrency:case _.sumTotalsCurrencyColored:case _.sumTotalsDollar:case _.sumTotalsDollarColoredBold:case _.sumTotalsDollarColored:case _.sumTotalsDollarBold:o="sum";break;default:n=e.numberFormat;break}else switch(l){case Me.number:switch(t.formatter){case P.multiple:if(Array.isArray((h=t.params)==null?void 0:h.formatters))for(const x of t.params.formatters){const{excelFormat:C}=Ve(i,e,{...t,formatter:x},r,s);if(C!==e.numberFormat){n=C;break}}n||(n=e.numberFormat);break;case P.currency:case P.decimal:case P.dollar:case P.dollarColored:case P.dollarColoredBold:case P.percent:case P.percentComplete:case P.percentCompleteBar:case P.percentCompleteBarWithText:case P.percentSymbol:a=st(t,r,"cell");break;default:n=e.numberFormat;break}break}return!n&&(t.formatter||t.groupTotalsFormatter)&&(a=st(t,r,s,o),e.hasOwnProperty(a)||(e[a]=i.createFormat({format:a})),n=e[a]),{excelFormat:n,groupType:o}}function rt(i){const[e,t,r,s,a,o,n,l]=(i==null?void 0:i.match(/^([^\d(-]*)([(]?)([^\d]*)([-]?[\w]]?[\d\s]*[.,\d]*[\d]*[^)\s%]?)([^\d.,)]*)([)]?)([^\d]*)$/i))||[],c=(a||"").replace(/1/g,"0").replace(/[2]/g,"#");return[de(t??""),r??"",de(s??""),c,de(o??""),n??"",de(l??"")].join("").replace(",",",")}function st(i,e,t,r=""){let s="",a="",o="";const{minDecimal:n,maxDecimal:l,thousandSeparator:c}=or(i,e,t),x=parseFloat(`${c?"2220":"0"}.${nr(n,l)}`);return t==="group"&&i.groupTotalsFormatter?(a=Z(i.groupTotalsFormatter({[r]:{[i.field]:x}},i,e)),o=Z(i.groupTotalsFormatter({[r]:{[i.field]:-x}},i,e))):i.formatter&&(a=Z(i.formatter(0,0,x,i,{},e)),o=Z(i.formatter(0,0,-x,i,{},e))),a&&o&&(s=rt(a)+";"+rt(o)),s}function de(i){return i&&`"${i}"`}function nr(i,e){return it("1",i)+it("2",e-i)}function it(i,e){let t="";for(let r=0;r<e;r++)t+=i;return t}const lr={filename:"export",format:pe.xlsx};class dr{constructor(){this._fileFormat=pe.xlsx,this._columnHeaders=[],this._hasColumnTitlePreHeader=!1,this._hasGroupedItems=!1,this._pubSubService=null,this._regularCellExcelFormats={},this._groupTotalExcelFormats={},this.className="ExcelExportService"}get _datasetIdPropName(){var e;return((e=this._gridOptions)==null?void 0:e.datasetIdPropertyName)??"id"}get _dataView(){var e;return(e=this._grid)==null?void 0:e.getData()}get _gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())||{}}get stylesheet(){return this._stylesheet}get stylesheetFormats(){return this._stylesheetFormats}get groupTotalExcelFormats(){return this._groupTotalExcelFormats}get regularCellExcelFormats(){return this._regularCellExcelFormats}dispose(){var e;(e=this._pubSubService)==null||e.unsubscribeAll()}init(e,t){var r,s;if(this._grid=e,this._pubSubService=t.get("PubSubService"),this._locales=((r=this._gridOptions)==null?void 0:r.locales)??at.locales,this._translaterService=(s=this._gridOptions)==null?void 0:s.translater,this._gridOptions.enableTranslate&&(!this._translaterService||!this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be passed in the "translater" Grid Options when "enableTranslate" is enabled. (example: this.gridOptions = { enableTranslate: true, translater: this.translaterService })')}exportToExcel(e){var t;if(!this._grid||!this._dataView||!this._pubSubService)throw new Error('[Slickgrid-Universal] it seems that the SlickGrid & DataView objects and/or PubSubService are not initialized did you forget to enable the grid option flag "enableExcelExport"?');return(t=this._pubSubService)==null||t.publish("onBeforeExportToExcel",!0),this._excelExportOptions=Ct(!0,{},{...lr,...this._gridOptions.excelExportOptions,...e}),this._fileFormat=this._excelExportOptions.format||pe.xlsx,this._regularCellExcelFormats={},this._groupTotalExcelFormats={},new Promise(r=>{const s={name:this._excelExportOptions.sheetName||"Sheet1"};this._workbook=new Jt,this._sheet=this._workbook.createWorksheet(s),this._stylesheet=this._workbook.getStyleSheet();const a=this._stylesheet.createFormat({font:{bold:!0}}),o=this._stylesheet.createFormat({format:"@"}),n=this._stylesheet.createFormat({format:"0"});this._stylesheetFormats={boldFormat:a,numberFormat:n,stringFormat:o},this._sheet.setColumnFormats([a]);const l=this.getDataOutput();window.setTimeout(async()=>{var y,f,u,b;(f=(y=this._gridOptions)==null?void 0:y.excelExportOptions)!=null&&f.customExcelHeader&&this._gridOptions.excelExportOptions.customExcelHeader(this._workbook,this._sheet);const c=((u=this._grid)==null?void 0:u.getColumns())||[];this._sheet.setColumns(this.getColumnStyles(c));const h=this._sheet.data;let x=h;Array.isArray(h)&&Array.isArray(l)&&(x=this._sheet.data.concat(l)),this._sheet.setData(x),this._workbook.addWorksheet(this._sheet);let C=(b=this._excelExportOptions)==null?void 0:b.mimeType;C===void 0&&(C=this._fileFormat===pe.xls?"application/vnd.ms-excel":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const w=`${this._excelExportOptions.filename}.${this._fileFormat}`;Qt(this._workbook,w,{mimeType:C}).then(()=>{var m;(m=this._pubSubService)==null||m.publish("onAfterExportToExcel",{filename:w,mimeType:C}),r(!0)})})})}getExcelColumnNameByIndex(e){const t="ZABCDEFGHIJKLMNOPQRSTUVWXY";let r=Math.floor(e/26);const s=Math.floor(e%26);return s===0&&r--,e>26?this.getExcelColumnNameByIndex(r)+t[s]:t[s]+""}getDataOutput(){var o,n;const e=((o=this._grid)==null?void 0:o.getColumns())||[],t=[],r=(n=this._gridOptions)==null?void 0:n.excelExportOptions,s=r==null?void 0:r.columnHeaderStyle;let a=this._stylesheetFormats.boldFormat.id;if(s&&(a=this._stylesheet.createFormat(s).id),this._gridOptions.createPreHeaderPanel&&this._gridOptions.showPreHeaderPanel&&!this._gridOptions.enableDraggableGrouping){const l=this._stylesheet.createFormat({alignment:{horizontal:"center"},font:{bold:!0}});t.push(this.getColumnGroupedHeaderTitlesData(e,{style:l==null?void 0:l.id})),this._hasColumnTitlePreHeader=!0}return t.push(this.getColumnHeaderData(e,{style:a})),this.pushAllGridRowDataToArray(t,e),t}getColumnStyles(e){var s,a;const t=this._dataView.getGrouping(),r=[];return Array.isArray(t)&&t.length>0&&r.push({bestFit:!0,columnStyles:((a=(s=this._gridOptions)==null?void 0:s.excelExportOptions)==null?void 0:a.customColumnWidth)??10}),e.forEach(o=>{var l,c,h;const n=o.excludeFromExport??!1;(o.width===void 0||o.width>0)&&!n&&r.push({bestFit:!0,width:((l=o.excelExportOptions)==null?void 0:l.width)??((h=(c=this._gridOptions)==null?void 0:c.excelExportOptions)==null?void 0:h.customColumnWidth)??10})}),r}getColumnGroupedHeaderTitlesData(e,t){let r=[];this._groupedColumnHeaders=this.getColumnGroupedHeaderTitles(e)||[],this._groupedColumnHeaders&&Array.isArray(this._groupedColumnHeaders)&&this._groupedColumnHeaders.length>0&&(r=this._groupedColumnHeaders.map(o=>({value:o.title,metadata:t})));let s=0;const a=this._groupedColumnHeaders.length;for(let o=0;o<a;o++)if(o+1===a||o+1<a&&this._groupedColumnHeaders[o].title!==this._groupedColumnHeaders[o+1].title){const n=this.getExcelColumnNameByIndex(s+1),l=this.getExcelColumnNameByIndex(o+1);this._sheet.mergeCells(`${n}1`,`${l}1`),s=o+1}return r}getColumnHeaderData(e,t){let r=[];this._columnHeaders=this.getColumnHeaders(e)||[],this._columnHeaders&&Array.isArray(this._columnHeaders)&&this._columnHeaders.length>0&&(r=this._columnHeaders.map(a=>({value:Z(a.title),metadata:t})));const s=this.getGroupColumnTitle();return s&&r.unshift({value:s,metadata:t}),r}getGroupColumnTitle(){var r,s;let e=this._excelExportOptions.groupingColumnHeaderTitle;!e&&this._gridOptions.enableTranslate&&((r=this._translaterService)!=null&&r.translate)?e=this._translaterService.translate(`${vt(this._gridOptions)}GROUP_BY`):e||(e=(s=this._locales)==null?void 0:s.TEXT_GROUP_BY);const t=this._dataView.getGrouping();return Array.isArray(t)&&t.length>0?(this._hasGroupedItems=!0,e):(this._hasGroupedItems=!1,null)}getColumnGroupedHeaderTitles(e){const t=[];return Array.isArray(e)&&e.forEach(r=>{var o;let s="";r.columnGroupKey&&this._gridOptions.enableTranslate&&((o=this._translaterService)!=null&&o.translate)?s=this._translaterService.translate(r.columnGroupKey):s=r.columnGroup||"";const a=r.excludeFromExport||!1;(r.width===void 0||r.width>0)&&!a&&t.push({key:r.field||r.id,title:s||""})}),t}getColumnHeaders(e){const t=[];return Array.isArray(e)&&e.forEach(r=>{var o;let s="";(r.nameKey||r.nameKey)&&this._gridOptions.enableTranslate&&((o=this._translaterService)!=null&&o.translate)?s=this._translaterService.translate(r.nameKey||r.nameKey):s=wt(r.name||"","innerHTML")||Et(r.field);const a=r.excludeFromExport||!1;(r.width===void 0||r.width>0)&&!a&&t.push({key:(r.field||r.id)+"",title:s})}),t}pushAllGridRowDataToArray(e,t){const r=this._dataView.getLength();for(let s=0;s<r;s++){const a=this._dataView.getItem(s);a&&!a.hasOwnProperty("getItem")&&(a[this._datasetIdPropName]!==null&&a[this._datasetIdPropName]!==void 0?e.push(this.readRegularRowData(t,s,a,s)):this._hasGroupedItems&&a.__groupTotals===void 0?e.push([this.readGroupedRowTitle(a)]):a.__groupTotals&&e.push(this.readGroupedTotalRows(t,a,s)))}return e}readRegularRowData(e,t,r,s){var x,C,w,y;let a=0;const o=[],n=e.length;let l=1,c=0;const h=this._dataView.getItemMetadata(t);for(let f=0;f<n;f++){const u=e[f];if(u.excludeFromExport)continue;this._hasGroupedItems&&a===0&&o.push("");let b=1;if(this._gridOptions.enableCellRowSpan){const p=this._grid.getParentRowSpanByCell(t,f,!1);if(p)if(p.start===t)b=p.end-p.start+1;else{o.push("");continue}}let m=1,E;if(h!=null&&h.columns){const p=h.columns,S=p[u.id]||p[f];!isNaN(l)&&+l>1||l==="*"&&f>0||(l=(S==null?void 0:S.colspan)??1),l==="*"?m=e.length-f:(m=l,(u.id in p||f in p)&&(E=u.id,c=f))}if(b>1&&!isNaN(l)&&+l==1&&u.id===E){const p=t+(this._hasColumnTitlePreHeader?3:2),S=this.getExcelColumnNameByIndex(f+1),A=this.getExcelColumnNameByIndex(f+1);this._sheet.mergeCells(`${S}${p}`,`${A}${p+b-1}`)}if(l==="*"&&f>0||!isNaN(l)&&+l>1&&u.id!==E){const p=t+(this._hasColumnTitlePreHeader?3:2);if(typeof l=="number"&&m-1===1){const S=this.getExcelColumnNameByIndex(c+1),A=this.getExcelColumnNameByIndex(f+1);this._sheet.mergeCells(`${S}${p}`,`${A}${p+b-1}`),o.push("")}else if(l==="*"&&m===1){const S=this.getExcelColumnNameByIndex(f+1);this._sheet.mergeCells(`A${p}`,`${S}${p+b-1}`)}else o.push("");typeof l=="number"&&!isNaN(l)&&+l>1&&(m=l--)}else{let p="";const S=fe(u),A={...this._excelExportOptions};if(u.exportWithFormatter!==!1&&Ft(S)&&(A.exportWithFormatter=!0),p=St(t,f,u,r,this._grid,A),!this._regularCellExcelFormats.hasOwnProperty(u.id)){const v=((x=u.excelExportOptions)==null?void 0:x.autoDetectCellFormat)??((C=this._excelExportOptions)==null?void 0:C.autoDetectCellFormat),O=ir(this._stylesheet,this._stylesheetFormats,u,this._grid,v);(w=u.excelExportOptions)!=null&&w.style&&(O.excelFormatId=this._stylesheet.createFormat(u.excelExportOptions.style).id),(y=u.excelExportOptions)!=null&&y.valueParserCallback&&(O.getDataValueParser=u.excelExportOptions.valueParserCallback),this._regularCellExcelFormats[u.id]=O}typeof p=="string"&&(u.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(p=Z(p));const{excelFormatId:k,getDataValueParser:F}=this._regularCellExcelFormats[u.id];p=F(p,{columnDef:u,excelFormatId:k,stylesheet:this._stylesheet,gridOptions:this._gridOptions,dataRowIdx:s,dataContext:r}),o.push(p),a++}}return o}readGroupedRowTitle(e){var r,s,a;const t=Z(e.title);if((r=this._excelExportOptions)!=null&&r.addGroupIndentation){const o=((s=this._excelExportOptions)==null?void 0:s.groupCollapsedSymbol)||"⮞",n=((a=this._excelExportOptions)==null?void 0:a.groupExpandedSymbol)||"⮟";return(e.collapsed?o:n)+" "+_t(5*e.level)+t}return t}readGroupedTotalRows(e,t,r){const a=[this._excelExportOptions.groupingAggregatorRowText||""];return e.forEach(o=>{var x,C,w,y,f,u,b;let n="";const l=fe(o),c=o.excludeFromExport||!1;if(o.exportCustomGroupTotalsFormatter){const m=o.exportCustomGroupTotalsFormatter(t,o,this._grid);n=m instanceof HTMLElement?m.textContent||"":m}const h=((x=o.excelExportOptions)==null?void 0:x.autoDetectCellFormat)??((C=this._excelExportOptions)==null?void 0:C.autoDetectCellFormat);if(l===Me.number&&h!==!1){let m=this._groupTotalExcelFormats[o.id];m!=null&&m.groupType||(m=Ve(this._stylesheet,this._stylesheetFormats,o,this._grid,"group"),(w=o.groupTotalsExcelExportOptions)!=null&&w.style&&(m.excelFormat=this._stylesheet.createFormat(o.groupTotalsExcelExportOptions.style)),this._groupTotalExcelFormats[o.id]=m);const E=((y=o.groupTotalsExcelExportOptions)==null?void 0:y.valueParserCallback)??ar;if(((f=t[m.groupType])==null?void 0:f[o.field])!==void 0){const p=E(t,{columnDef:o,groupType:m.groupType,excelFormatId:(u=m.excelFormat)==null?void 0:u.id,stylesheet:this._stylesheet,dataRowIdx:r});n=typeof p=="object"&&p.hasOwnProperty("metadata")?p:n={value:p,metadata:{style:(b=m.excelFormat)==null?void 0:b.id}}}}else if(o.groupTotalsFormatter){const m=o.groupTotalsFormatter(t,o,this._grid);n=m instanceof HTMLElement?m.textContent||"":m}typeof n=="string"&&(o.sanitizeDataExport||this._excelExportOptions.sanitizeDataExport)&&(n=Z(n)),(o.width===void 0||o.width>0)&&!c&&a.push(n)}),a}}export{dr as E};
//# sourceMappingURL=excelExport.service-BVEnwJlG.js.map
