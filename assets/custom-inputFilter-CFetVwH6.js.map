{"version":3,"file":"custom-inputFilter-CFetVwH6.js","sources":["../../src/examples/slickgrid/custom-inputFilter.ts"],"sourcesContent":["import {\n  type Column,\n  type ColumnFilter,\n  emptyElement,\n  type Filter,\n  type FilterArguments,\n  type FilterCallback,\n  type GridOption,\n  OperatorType,\n  type OperatorString,\n  type SearchTerm,\n  type SlickGrid,\n} from 'aurelia-slickgrid';\n\nexport class CustomInputFilter implements Filter {\n  private _clearFilterTriggered = false;\n  private _shouldTriggerQuery = true;\n  private filterElm!: HTMLInputElement;\n  grid!: SlickGrid;\n  searchTerms: SearchTerm[] = [];\n  columnDef!: Column;\n  callback!: FilterCallback;\n  operator: OperatorType | OperatorString = OperatorType.equal;\n\n  /** Getter for the Filter Operator */\n  get columnFilter(): ColumnFilter {\n    return this.columnDef?.filter ?? {};\n  }\n\n  /** Getter for the Grid Options pulled through the Grid Object */\n  get gridOptions(): GridOption {\n    return (this.grid?.getOptions() ?? {}) as GridOption;\n  }\n\n  /**\n   * Initialize the Filter\n   */\n  init(args: FilterArguments) {\n    this.grid = args.grid as SlickGrid;\n    this.callback = args.callback;\n    this.columnDef = args.columnDef;\n    this.searchTerms = (args.hasOwnProperty('searchTerms') ? args.searchTerms : []) || [];\n\n    // filter input can only have 1 search term, so we will use the 1st array index if it exist\n    const searchTerm = (Array.isArray(this.searchTerms) && this.searchTerms.length > 0) ? this.searchTerms[0] : '';\n\n    // step 1, create HTML string template\n\n    // step 2, create the DOM Element of the filter & initialize it if searchTerm is filled\n    this.filterElm = this.createDomElement(searchTerm);\n\n    // step 3, subscribe to the keyup event and run the callback when that happens\n    // also add/remove \"filled\" class for styling purposes\n    this.filterElm.addEventListener('keyup', this.handleKeyup.bind(this));\n  }\n\n  handleKeyup(event: any) {\n    let value = event.target?.value ?? '';\n    const enableWhiteSpaceTrim = this.gridOptions.enableFilterTrimWhiteSpace || this.columnFilter.enableTrimWhiteSpace;\n    if (typeof value === 'string' && enableWhiteSpaceTrim) {\n      value = value.trim();\n    }\n\n    if (this._clearFilterTriggered) {\n      this.callback(event, { columnDef: this.columnDef, clearFilterTriggered: this._clearFilterTriggered, shouldTriggerQuery: this._shouldTriggerQuery });\n      this.filterElm.classList.remove('filled');\n    } else {\n      value === '' ? this.filterElm.classList.remove('filled') : this.filterElm.classList.add('filled');\n      this.callback(event, { columnDef: this.columnDef, searchTerms: [value], shouldTriggerQuery: this._shouldTriggerQuery });\n    }\n    // reset both flags for next use\n    this._clearFilterTriggered = false;\n    this._shouldTriggerQuery = true;\n  }\n\n  /**\n   * Clear the filter value\n   */\n  clear(shouldTriggerQuery = true) {\n    if (this.filterElm) {\n      this._clearFilterTriggered = true;\n      this._shouldTriggerQuery = shouldTriggerQuery;\n      this.filterElm.value = '';\n      this.filterElm.dispatchEvent(new Event('keyup'));\n    }\n  }\n\n  /**\n   * destroy the filter\n   */\n  destroy() {\n    if (this.filterElm) {\n      this.filterElm.removeEventListener('keyup', this.handleKeyup);\n      this.filterElm.remove();\n    }\n  }\n\n  /** Set value(s) on the DOM element */\n  setValues(values: any) {\n    if (values) {\n      this.filterElm.value = values;\n    }\n  }\n\n  //\n  // private functions\n  // ------------------\n\n  /**\n   * From the html template string, create a DOM element\n   * @param filterTemplate\n   */\n  private createDomElement(searchTerm?: SearchTerm): HTMLInputElement {\n    const headerElm = this.grid.getHeaderRowColumn(this.columnDef.id);\n    emptyElement(headerElm);\n\n    let placeholder = this.gridOptions?.defaultFilterPlaceholder ?? '';\n    if (this.columnFilter?.placeholder) {\n      placeholder = this.columnFilter.placeholder;\n    }\n\n    // create the DOM element & add an ID and filter class\n    const filterElm = document.createElement('input');\n    filterElm.className = 'form-control search-filter';\n    filterElm.placeholder = placeholder;\n\n    const searchTermInput = searchTerm as string;\n\n    filterElm.value = searchTermInput;\n    filterElm.dataset.columnid = `${this.columnDef.id}`;\n\n    // append the new DOM element to the header row\n    if (headerElm) {\n      headerElm.appendChild(filterElm);\n    }\n\n    return filterElm;\n  }\n}\n"],"names":["CustomInputFilter","__publicField","OperatorType","_a","args","searchTerm","event","value","enableWhiteSpaceTrim","shouldTriggerQuery","values","headerElm","emptyElement","placeholder","_b","filterElm","searchTermInput"],"mappings":"2MAcO,MAAMA,CAAoC,CAA1C,aAAA,CACLC,EAAA,KAAQ,wBAAwB,EAAA,EAChCA,EAAA,KAAQ,sBAAsB,EAAA,EACtBA,EAAA,KAAA,WAAA,EACRA,EAAA,KAAA,MAAA,EACAA,EAAA,KAAA,cAA4B,EAAC,EAC7BA,EAAA,KAAA,WAAA,EACAA,EAAA,KAAA,UAAA,EACAA,EAAA,KAAA,WAA0CC,EAAa,KAAA,CAAA,CAGvD,IAAI,cAA6B,OACxB,QAAAC,EAAA,KAAK,YAAL,YAAAA,EAAgB,SAAU,CAAC,CAAA,CAIpC,IAAI,aAA0B,OAC5B,QAAQA,EAAA,KAAK,OAAL,YAAAA,EAAW,eAAgB,CAAC,CAAA,CAMtC,KAAKC,EAAuB,CAC1B,KAAK,KAAOA,EAAK,KACjB,KAAK,SAAWA,EAAK,SACrB,KAAK,UAAYA,EAAK,UACjB,KAAA,aAAeA,EAAK,eAAe,aAAa,EAAIA,EAAK,YAAc,CAAA,IAAO,CAAC,EAGpF,MAAMC,EAAc,MAAM,QAAQ,KAAK,WAAW,GAAK,KAAK,YAAY,OAAS,EAAK,KAAK,YAAY,CAAC,EAAI,GAKvG,KAAA,UAAY,KAAK,iBAAiBA,CAAU,EAIjD,KAAK,UAAU,iBAAiB,QAAS,KAAK,YAAY,KAAK,IAAI,CAAC,CAAA,CAGtE,YAAYC,EAAY,OAClB,IAAAC,IAAQJ,EAAAG,EAAM,SAAN,YAAAH,EAAc,QAAS,GACnC,MAAMK,EAAuB,KAAK,YAAY,4BAA8B,KAAK,aAAa,qBAC1F,OAAOD,GAAU,UAAYC,IAC/BD,EAAQA,EAAM,KAAK,GAGjB,KAAK,uBACP,KAAK,SAASD,EAAO,CAAE,UAAW,KAAK,UAAW,qBAAsB,KAAK,sBAAuB,mBAAoB,KAAK,mBAAA,CAAqB,EAC7I,KAAA,UAAU,UAAU,OAAO,QAAQ,IAE9BC,IAAA,GAAK,KAAK,UAAU,UAAU,OAAO,QAAQ,EAAI,KAAK,UAAU,UAAU,IAAI,QAAQ,EAChG,KAAK,SAASD,EAAO,CAAE,UAAW,KAAK,UAAW,YAAa,CAACC,CAAK,EAAG,mBAAoB,KAAK,oBAAqB,GAGxH,KAAK,sBAAwB,GAC7B,KAAK,oBAAsB,EAAA,CAM7B,MAAME,EAAqB,GAAM,CAC3B,KAAK,YACP,KAAK,sBAAwB,GAC7B,KAAK,oBAAsBA,EAC3B,KAAK,UAAU,MAAQ,GACvB,KAAK,UAAU,cAAc,IAAI,MAAM,OAAO,CAAC,EACjD,CAMF,SAAU,CACJ,KAAK,YACP,KAAK,UAAU,oBAAoB,QAAS,KAAK,WAAW,EAC5D,KAAK,UAAU,OAAO,EACxB,CAIF,UAAUC,EAAa,CACjBA,IACF,KAAK,UAAU,MAAQA,EACzB,CAWM,iBAAiBL,EAA2C,SAClE,MAAMM,EAAY,KAAK,KAAK,mBAAmB,KAAK,UAAU,EAAE,EAChEC,EAAaD,CAAS,EAElB,IAAAE,IAAcV,EAAA,KAAK,cAAL,YAAAA,EAAkB,2BAA4B,IAC5DW,EAAA,KAAK,eAAL,MAAAA,EAAmB,cACrBD,EAAc,KAAK,aAAa,aAI5B,MAAAE,EAAY,SAAS,cAAc,OAAO,EAChDA,EAAU,UAAY,6BACtBA,EAAU,YAAcF,EAExB,MAAMG,EAAkBX,EAExB,OAAAU,EAAU,MAAQC,EAClBD,EAAU,QAAQ,SAAW,GAAA,KAAA,UAAA,EAAA,GAGzBJ,GACFA,EAAU,YAAYI,CAAS,EAG1BA,CAAA,CAEX"}