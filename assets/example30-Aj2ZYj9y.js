import{C as be,z as Ce,P as ve,x as ye,Q as Ee,j as _e,R as ee,T as we,k as q,U as Se,i as Te,V as xe,W as v,X as ke,o as Ie,Y as Oe,r as Re,n as Ne,b as I,a as S,F as k,S as te,d as ie,y as Ve,c as Le}from"./index-Bz3uuwsZ.js";import{I as Ae}from"./index.dev-DuhuQGSj.js";import{E as Me}from"./excelExport.service-BVEnwJlG.js";import{S as De}from"./slickCustomTooltip-DOwB40_c.js";import{E as O}from"./editors.index-CmyHd4IA.js";import{C as Fe}from"./countries-DVECuSGk.js";import"./groupingFormatters.index-B6oGpPhz.js";const oe="example30",K=`<h2>
  \${title}
  <span class="float-end">
    <a style="font-size: 18px"
        target="_blank"
        href="https://github.com/ghiscoding/aurelia-slickgrid/blob/master/packages/demo/src/examples/slickgrid/example30.ts">
      <span class="mdi mdi-link-variant"></span> code
    </a>
  </span>
  <button
      class="ms-2 btn btn-outline-secondary btn-sm btn-icon"
      type="button"
      data-test="toggle-subtitle"
      click.trigger="toggleSubTitle()"
    >
      <span class="mdi mdi-information-outline" title="Toggle example sub-title details"></span>
    </button>
    <button class="btn btn-outline-secondary btn-sm btn-icon" click.trigger="toggleDarkMode()" data-test="toggle-dark-mode">
    <i class="mdi mdi-theme-light-dark"></i>
    <span>Toggle Dark Mode</span>
  </button>
</h2>

<div class="subtitle" innerhtml.bind="subTitle"></div>

<div class="mb-2">
  <div class="btn-group btn-group-sm" role="group" aria-label="Basic Editing Commands">
    <button type="button" class="btn btn-outline-secondary btn-icon" data-test="toggle-readonly-btn"
            click.trigger="toggleGridEditReadonly()">
      <i class="mdi mdi-table-edit"></i> Toggle Edit/Readonly Grid
    </button>
    <button type="button" class="btn btn-outline-secondary btn-icon" data-test="undo-last-edit-btn"
            click.trigger="undoLastEdit()">
      <i class="mdi mdi-undo"></i> Undo Last Edit
    </button>
    <button type="button" class="btn btn-outline-secondary btn-icon" data-test="undo-open-editor-btn"
            click.trigger="undoLastEdit(true)">
      <i class="mdi mdi-undo"></i> Undo Last Edit &amp; Open Editor
    </button>
    <button type="button" class="btn btn-outline-secondary btn-icon" data-test="undo-all-edits-btn"
            click.trigger="undoAllEdits()">
      <i class="mdi mdi-history"></i> Undo All Edits
    </button>
    <button type="button" class="btn btn-outline-secondary btn-icon" data-test="save-all-btn"
            click.trigger="saveAll()">
        <span>Save All</span>
    </button>
  </div>
</div>

<div class="mb-3">
  <div class="btn-group btn-group-sm" role="group" aria-label="Basic example">
    <button type="button" class="btn btn-outline-secondary btn-icon" data-test="open-modal-create-btn"
            click.trigger="openCompositeModal('create')" disabled.bind="isCompositeDisabled">
      <i class="mdi mdi-shape-square-plus"></i> Item Create
    </button>
    <button type="button" class="btn btn-outline-secondary btn-icon" data-test="open-modal-clone-btn"
            click.trigger="openCompositeModal('clone')" disabled.bind="isCompositeDisabled">
      <i class="mdi mdi-content-copy"></i> Item Clone
    </button>
    <button type="button" class="btn btn-outline-secondary btn-icon" data-test="open-modal-edit-btn"
            click.trigger="openCompositeModal('edit')" disabled.bind="isCompositeDisabled">
      <i class="mdi mdi-pencil"></i> Item Edit
    </button>
    <button type="button" class="btn btn-outline-secondary btn-icon" data-test="open-modal-mass-update-btn"
            click.trigger="openCompositeModal('mass-update')" disabled.bind="isCompositeDisabled">
      <i class="mdi mdi-pencil-box-multiple-outline"></i> Mass Update
    </button>
    <button type="button" class="btn btn-outline-secondary btn-icon" data-test="open-modal-mass-selection-btn"
            click.trigger="openCompositeModal('mass-selection')" disabled.bind="isMassSelectionDisabled">
      <i class="mdi mdi-check-box-outline"></i> Update Selected
    </button>
  </div>
</div>

<aurelia-slickgrid grid-id="grid30"
                    column-definitions.bind="columnDefinitions"
                    grid-options.bind="gridOptions"
                    dataset.bind="dataset"
                    on-aurelia-grid-created.trigger="aureliaGridReady($event.detail)"
                    on-before-edit-cell.trigger="handleOnBeforeEditCell($event.detail.eventData, $event.detail.args)"
                    on-cell-change.trigger="handleOnCellChange($event.detail.eventData, $event.detail.args)"
                    on-click.trigger="handleOnCellClicked($event.detail.eventData, $event.detail.args)"
                    on-composite-editor-change.trigger="handleOnCompositeEditorChange($event.detail.eventData, $event.detail.args)"
                    on-item-deleted.trigger="handleItemDeleted($event.detail)"
                    on-grid-state-changed.trigger="handleOnGridStateChanged($event.detail)"
                    on-rows-or-count-changed.trigger="handleReRenderUnsavedStyling()"
                    on-validation-error.trigger="handleValidationError($event.detail.eventData, $event.detail.args)">
</aurelia-slickgrid>
`,ae=[],ne={};let H;function Be(u){H||(H=be.define({name:oe,template:K,dependencies:ae,bindables:ne})),u.register(H)}const Ue=Object.freeze(Object.defineProperty({__proto__:null,bindables:ne,default:K,dependencies:ae,name:oe,register:Be,template:K},Symbol.toStringTag,{value:"Module"}));function le(u,e,t){let i;t={...{modalType:"edit",validationFailedMsg:"Some of the fields have failed validation",validationMsgPrefix:null,show:null,hide:null,position:null,destroy:null,formValues:{},editors:{}},...t};const o=()=>{},l=m=>{const a=e[m],d=ve(a),f=(a==null?void 0:a.clientWidth)??0,c=(a==null?void 0:a.clientHeight)??0;return{top:d.top,left:d.left,bottom:d.top+c,right:d.left+f,width:f,height:c,visible:!0}};function r(m){const a=this;let d=[];function f(){let c={},n=0;for(;n<u.length;){if(u[n].editorClass){const h=u[n];c={...m},c.container=e[n],c.column=h,c.position=l(n),c.commitChanges=o,c.cancelChanges=o,c.compositeEditorOptions=t,c.formValues={};const g=new h.editorClass(c);t.editors[h.id]=g,d.push(g)}n++}window.setTimeout(()=>{Array.isArray(d)&&d.length>0&&typeof d[0].focus=="function"&&d[0].focus()},0)}a.getEditors=()=>d,a.destroy=()=>{var h;let c=d.pop();for(;c;)c==null||c.destroy(),c=d.pop();let n=e.pop();for(;n;)Ce(n),n==null||n.remove(),n=e.pop();(h=t==null?void 0:t.destroy)==null||h.call(t),d=[],e=null},a.focus=()=>{(i||d[0]).focus()},a.isValueChanged=()=>{let c=0;for(;c<d.length;){if(d[c].isValueChanged())return!0;c++}return!1},a.serializeValue=()=>{const c=[];let n=0;for(;n<d.length;)c[n]=d[n].serializeValue(),n++;return c},a.applyValue=(c,n)=>{let h=0;for(;h<d.length;)d[h].applyValue(c,n==null?void 0:n[h]),h++},a.loadValue=c=>{let n=0;for(;n<d.length;)d[n].loadValue(c),n++},a.validate=c=>{var E;let n;i=null;const h=[];let g=0;for(;g<d.length;){const x=(E=d[g].args)==null?void 0:E.column;if((x==null?void 0:x.id)!==void 0){const _=document.querySelector(".slick-editor-modal");let b=_==null?void 0:_.querySelector(`.item-details-validation.editor-${x.id}`),T=_==null?void 0:_.querySelector(`.item-details-label.editor-${x.id}`),w=_==null?void 0:_.querySelector(`[data-editorid='${x.id}']`);const G=(t==null?void 0:t.validationMsgPrefix)??"";(!c||w!=null&&w.contains(c))&&(n=d[g].validate(),n.valid?b&&(b.textContent="",w==null||w.classList.remove("invalid"),T==null||T.classList.remove("invalid")):(i=d[g],h.push({index:g,editor:d[g],container:e[g],msg:n.msg}),b&&(b.textContent=`${G}${n.msg}`,T==null||T.classList.add("invalid"),w==null||w.classList.add("invalid")))),b=null,T=null,w=null}g++}return c=null,h.length?{valid:!1,msg:t.validationFailedMsg,errors:h}:{valid:!0,msg:""}},a.hide=()=>{var n,h,g;let c=0;for(;c<d.length;)(h=(n=d[c])==null?void 0:n.hide)==null||h.call(n),c++;(g=t==null?void 0:t.hide)==null||g.call(t)},a.show=()=>{var n,h,g;let c=0;for(;c<d.length;)(h=(n=d[c])==null?void 0:n.show)==null||h.call(n),c++;(g=t==null?void 0:t.show)==null||g.call(t)},a.position=c=>{var n;(n=t==null?void 0:t.position)==null||n.call(t,c)},f()}return r.prototype=this,r}const se=u=>console.log(u.message);class Ge{get eventHandler(){return this._eventHandler}get dataView(){var e;return(e=this.grid)==null?void 0:e.getData()}get dataViewLength(){return this.dataView.getLength()}get formValues(){return this._formValues}get editors(){return this._editors}set editors(e){this._editors=e}get gridOptions(){var e;return(e=this.grid)==null?void 0:e.getOptions()}constructor(){this._columnDefinitions=[],this._lastActiveRowNumber=-1,this._formValues=null,this.gridService=null,this._eventHandler=new ye,this._bindEventService=new Ee}init(e,t){var i;if(this.grid=e,this.gridService=t.get("GridService"),this.translaterService=t.get("TranslaterService"),!this.gridService)throw new Error("[Slickgrid-Universal] it seems that the GridService is not being loaded properly, make sure the Container Service is properly implemented.");if(this.gridOptions.enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');this._locales=((i=this.gridOptions)==null?void 0:i.locales)??_e.locales}dispose(){this._eventHandler.unsubscribeAll(),this._bindEventService.unbindAll(),this._formValues=null,this.disposeComponent()}disposeComponent(){var e,t,i;(e=this._modalBodyTopValidationElm)==null||e.remove(),(t=this._modalSaveButtonElm)==null||t.remove(),typeof((i=this._modalElm)==null?void 0:i.remove)=="function"&&(this._modalElm.remove(),document.body.classList.remove("slick-modal-open")),this._editorContainers=[]}changeFormInputValue(e,t,i=!1,s=!0){var d,f,c,n,h,g;const o=this.getColumnByObjectOrId(e),l=typeof e=="string"?e:(o==null?void 0:o.id)??"",r=(d=this._editors)==null?void 0:d[l];let m=t;if(!r&&!i)throw new Error(`Composite Editor with column id "${l}" not found.`);if(typeof(r==null?void 0:r.setValue)=="function"&&Array.isArray(this._editorContainers)){r.setValue(t,!0,s);const E=this._editorContainers.find(_=>_.dataset.editorid===l),x=((c=(f=this.gridOptions)==null?void 0:f.compositeEditorOptions)==null?void 0:c.excludeDisabledFieldFormValues)??!1;!r.disabled||r.disabled&&!x?(n=E==null?void 0:E.classList)==null||n.add("modified"):(m="",(h=E==null?void 0:E.classList)==null||h.remove("modified")),r.disabled&&(m!==""||m!==null||m!==void 0||m!==0)&&(m="")}const a=(o==null?void 0:o.field)??"";if(o&&(a!=null&&a.includes("."))){const E=((g=o.editor)==null?void 0:g.complexObjectPath)??a??"";ee(this._formValues??{},E,t)}else this._formValues={...this._formValues,[l]:m}}changeFormValue(e,t){var l;const i=this.getColumnByObjectOrId(e),s=typeof e=="string"?e:(i==null?void 0:i.id)??"",o=(i==null?void 0:i.field)??e;if(o!=null&&o.includes(".")){const r=((l=i==null?void 0:i.editor)==null?void 0:l.complexObjectPath)??o??"";ee(this._formValues,r,t)}else this._formValues={...this._formValues,[s]:t};this._formValues=we({},this._itemDataContext,this._formValues)}changeFormEditorOption(e,t,i){var o;const s=(o=this._editors)==null?void 0:o[e];if(s!=null&&s.changeEditorOption)s.changeEditorOption(t,i);else throw new Error(`Editor with column id "${e}" not found OR the Editor does not support "changeEditorOption" (current only available with Date, MultipleSelect, SingleSelect & Slider Editors).`)}disableFormInput(e,t=!0){var s;const i=(s=this._editors)==null?void 0:s[e];i!=null&&i.disable&&Array.isArray(this._editorContainers)&&i.disable(t)}openDetails(e){var s,o,l,r,m,a,d,f,c;const t=e.onError??se,i={backdrop:"static",showCloseButtonOutside:!0,shouldClearRowSelectionAfterMassAction:!0,viewColumnLayout:"auto",modalType:"edit"};try{if(!this.grid||this.grid.getEditorLock().isActive()&&!this.grid.getEditorLock().commitCurrentEdit())return null;this._formValues=null,this._options={...i,...this.gridOptions.compositeEditorOptions,...e,labels:{...(s=this.gridOptions.compositeEditorOptions)==null?void 0:s.labels,...e==null?void 0:e.labels}},this._options.backdrop=e.backdrop!==void 0?e.backdrop:"static";const n=this._options.viewColumnLayout||1,h=this.grid.getActiveCell(),g=(h==null?void 0:h.cell)??0,E=(h==null?void 0:h.row)??0,x=this.grid.getUID()||"";let _=e.headerTitle||"";typeof this._options.onBeforeOpen=="function"&&this._options.onBeforeOpen(),this.hasRowSelectionEnabled()&&this._options.modalType==="auto-mass"&&this.grid.getSelectedRows&&((this.grid.getSelectedRows()||[]).length>0?(this._options.modalType="mass-selection",e!=null&&e.headerTitleMassSelection&&(_=e==null?void 0:e.headerTitleMassSelection)):(this._options.modalType="mass-update",e!=null&&e.headerTitleMassUpdate&&(_=e==null?void 0:e.headerTitleMassUpdate)));const b=this._options.modalType||"edit";if(this.gridOptions.editable)if(this.gridOptions.enableCellNavigation){if(!this.gridOptions.enableAddRow&&(b==="clone"||b==="create"))return t({type:"error",code:"ENABLE_ADD_ROW_REQUIRED",message:'Composite Editor requires the flag "enableAddRow" to be set to True in your Grid Options when cloning/creating a new item.'}),null;if(!h&&(b==="clone"||b==="edit"))return t({type:"warning",code:"NO_RECORD_FOUND",message:"No records selected for edit or clone operation."}),null;{const T=b==="mass-update"||b==="mass-selection",w=T?{}:this.grid.getDataItem(E);this._originalDataContext=q(!0,{},w),this._columnDefinitions=this.grid.getColumns();const G=this.hasRowSelectionEnabled()?this.grid.getSelectedRows():[],J=((o=this.dataView)==null?void 0:o.getItemCount())??0;this._lastActiveRowNumber=E;const ue=this.dataView.getAllSelectedIds(),he=b==="create"?this.dataViewLength:E;if(!this.focusOnFirstColumnCellWithEditor(this._columnDefinitions,w,g,he,T))return null;if(b==="edit"&&!w)return t({type:"warning",code:"ROW_NOT_EDITABLE",message:"Current row is not editable."}),null;if(b==="mass-selection"&&G.length<1)return t({type:"warning",code:"ROW_SELECTION_REQUIRED",message:"You must select some rows before trying to apply new value(s)."}),null;let R=[];T?R=this._columnDefinitions.filter(p=>{var C;return p.editorClass&&((C=p.editor)==null?void 0:C.massUpdate)===!0}):R=this._columnDefinitions.filter(p=>p.editorClass),R.some(p=>{var C;return((C=p.editor)==null?void 0:C.compositeEditorFormOrder)!==void 0})&&R.sort((p,C)=>{var U,F;const D=((U=p==null?void 0:p.editor)==null?void 0:U.compositeEditorFormOrder)??1/0,W=((F=C==null?void 0:C.editor)==null?void 0:F.compositeEditorFormOrder)??1/0;return Se(D,W,Te.asc)});const pe=_.replace(/\{\{(.*?)\}\}/g,(p,C)=>xe(w,C)),B=n==="auto"?this.autoCalculateLayoutColumnCount(R.length):n;this._modalElm=v("div",{className:`slick-editor-modal ${x}`});const V=v("div",{className:"slick-editor-modal-content"});if((l=this.gridOptions)!=null&&l.darkMode&&V.classList.add("slick-dark-mode"),!isNaN(n)&&+n>1||n==="auto"&&B>1){const p=B===2?"split-view":"triple-split-view";V.classList.add(p)}const L=v("div",{className:"slick-editor-modal-title"});this.grid.applyHtmlCode(L,pe);const A=v("button",{type:"button",ariaLabel:"Close",textContent:"×",className:"close",dataset:{action:"close"}});this._options.showCloseButtonOutside&&((r=L==null?void 0:L.classList)==null||r.add("outside"),(m=A==null?void 0:A.classList)==null||m.add("outside"));const $=v("div",{ariaLabel:"Close",className:"slick-editor-modal-header"});$.appendChild(L),$.appendChild(A);const M=v("div",{className:"slick-editor-modal-body"});this._modalBodyTopValidationElm=v("div",{className:"validation-summary",style:{display:"none"}},M);const P=v("div",{className:"slick-editor-modal-footer"}),Z=v("button",{type:"button",ariaLabel:this.getLabelText("cancelButton","TEXT_CANCEL","Cancel"),className:"btn btn-cancel btn-default btn-sm",textContent:this.getLabelText("cancelButton","TEXT_CANCEL","Cancel"),dataset:{action:"cancel"}});let j="",N="";switch(b){case"clone":N=this.getLabelText("cloneButton","TEXT_CLONE","Clone");break;case"mass-update":const p=this.getLabelText("massUpdateStatus","TEXT_ALL_X_RECORDS_SELECTED","All {{x}} records selected");j=this.parseText(p,{x:J}),N=this.getLabelText("massUpdateButton","TEXT_APPLY_MASS_UPDATE","Mass Update");break;case"mass-selection":const C=this.getLabelText("massSelectionStatus","TEXT_X_OF_Y_MASS_SELECTED","{{x}} of {{y}} selected");j=this.parseText(C,{x:ue.length,y:J}),N=this.getLabelText("massSelectionButton","TEXT_APPLY_TO_SELECTION","Update Selection");break;default:N=this.getLabelText("saveButton","TEXT_SAVE","Save")}const ge=v("div",{className:"footer-status-text",textContent:j});this._modalSaveButtonElm=v("button",{type:"button",className:"btn btn-save btn-primary btn-sm",ariaLabel:N,textContent:N,dataset:{action:b==="create"||b==="edit"?"save":b,ariaLabel:N}});const z=v("div",{className:"footer-buttons"});(b==="mass-update"||b==="mass-selection")&&P.appendChild(ge),z.appendChild(Z),z.appendChild(this._modalSaveButtonElm),P.appendChild(z),V.appendChild($),V.appendChild(M),V.appendChild(P),this._modalElm.appendChild(V);for(const p of R)if(p.editorClass){const C=v("div",{className:`item-details-container editor-${p.id}`});B===1?C.classList.add("slick-col-medium-12"):C.classList.add("slick-col-medium-6",`slick-col-xlarge-${12/B}`);const D=v("div",{className:`item-details-label editor-${p.id}`});this.grid.applyHtmlCode(D,this.getColumnLabel(p)||"n/a");const W=v("div",{className:"item-details-editor-container slick-cell",dataset:{editorid:`${p.id}`}}),U=v("div",{className:`item-details-validation editor-${p.id}`});if((a=this._options)!=null&&a.showResetButtonOnEachEditor){const F=this.createEditorResetButtonElement(`${p.id}`);this._bindEventService.bind(F,"click",this.handleResetInputValue.bind(this)),D.appendChild(F)}C.appendChild(D),C.appendChild(W),C.appendChild(U),M.appendChild(C)}if((d=this._options)!=null&&d.showFormResetButton){const p=this.createFormResetButtonElement();this._bindEventService.bind(p,"click",this.handleResetFormClicked.bind(this)),M.appendChild(p)}document.body.appendChild(this._modalElm),document.body.classList.add("slick-modal-open"),this._bindEventService.bind(document.body,"click",this.handleBodyClicked.bind(this)),typeof this._options.onRendered=="function"&&this._options.onRendered(this._modalElm),this._editors={},this._editorContainers=R.map(p=>M.querySelector(`[data-editorid='${p.id}']`))||[],this._compositeOptions={destroy:this.disposeComponent.bind(this),modalType:b,validationMsgPrefix:"* ",formValues:{},editors:this._editors};const fe=new le(R,this._editorContainers,this._compositeOptions);this.grid.editActiveCell(fe),this._bindEventService.bind(A,"click",this.cancelEditing.bind(this)),this._bindEventService.bind(Z,"click",this.cancelEditing.bind(this)),this._bindEventService.bind(this._modalSaveButtonElm,"click",this.handleSaveClicked.bind(this)),this._bindEventService.bind(this._modalElm,"keydown",this.handleKeyDown.bind(this)),this._bindEventService.bind(this._modalElm,"focusout",this.validateCurrentEditor.bind(this)),this._bindEventService.bind(this._modalElm,"blur",this.validateCurrentEditor.bind(this)),this._eventHandler.subscribe(this.grid.onCompositeEditorChange,this.handleOnCompositeEditorChange.bind(this)),this._eventHandler.subscribe(this.grid.onAddNewRow,(p,C)=>{this._originalDataContext=this.insertNewItemInDataView(C.item)})}}else return t({type:"error",code:"ENABLE_CELL_NAVIGATION_REQUIRED",message:'Composite Editor requires the flag "enableCellNavigation" to be set to True in your Grid Options.'}),null;else return t({type:"error",code:"EDITABLE_GRID_REQUIRED",message:"Your grid must be editable in order to use the Composite Editor Modal."}),null;return this}catch(n){this.dispose();const h=typeof n=="string"?n:(n==null?void 0:n.message)??((f=n==null?void 0:n.body)==null?void 0:f.message)??"",g=typeof n=="string"?n:(n==null?void 0:n.status)??((c=n==null?void 0:n.body)==null?void 0:c.status)??h;return t({type:"error",code:g,message:h}),null}}async cancelEditing(){var t,i,s;let e=!0;this.formValues&&Object.keys(this.formValues).length>0&&typeof this._options.onClose=="function"&&(e=await this._options.onClose()),e&&((t=this.grid.getEditController())==null||t.cancelCurrentEdit(),(((i=this._options)==null?void 0:i.modalType)==="edit"||((s=this._options)==null?void 0:s.modalType)==="clone")&&this.resetCurrentRowDataContext(),this.grid.setActiveRow(this._lastActiveRowNumber),this.dispose())}showValidationSummaryText(e,t=""){var i,s;e&&t!==""?(this._modalBodyTopValidationElm.textContent=t,this._modalBodyTopValidationElm.style.display="block",(s=(i=this._modalBodyTopValidationElm).scrollIntoView)==null||s.call(i),this._modalSaveButtonElm.disabled=!1,this._modalSaveButtonElm.classList.remove("saving")):(this._modalBodyTopValidationElm.style.display="none",this._modalBodyTopValidationElm.textContent=t)}applySaveMassUpdateChanges(e,t,i=!0){const s=i?this.dataView.getItems():q(!0,[],this.dataView.getItems());return Object.keys(e).forEach(o=>{o in e&&s.forEach(l=>{var r;o in e&&(((r=this._options)==null?void 0:r.validateMassUpdateChange)===void 0||this._options.validateMassUpdateChange(o,l,e)!==!1)&&(l[o]=e[o])})}),i&&(this.dataView.setItems(s,this.gridOptions.datasetIdPropertyName),this.grid.invalidate()),s}applySaveMassSelectionChanges(e,t,i=!0){var r;const o=((t==null?void 0:t.dataContextIds)??[]).map(m=>this.dataView.getItemById(m)),l=i?o:q(!0,[],o);return Object.keys(e).forEach(m=>{m in e&&l.forEach(a=>{var d;m in e&&(((d=this._options)==null?void 0:d.validateMassUpdateChange)===void 0||this._options.validateMassUpdateChange(m,a,e)!==!1)&&(a[m]=e[m])})}),i&&((r=this.gridService)==null||r.updateItems(l)),l}autoCalculateLayoutColumnCount(e){return e>=15?3:e>=8?2:1}createEditorResetButtonElement(e){var i,s,o,l;const t=v("button",{type:"button",name:e,ariaLabel:"Reset",title:((s=(i=this._options)==null?void 0:i.labels)==null?void 0:s.resetFormButton)??"Reset Form Input",className:"btn btn-xs btn-editor-reset"});if((o=this._options)!=null&&o.resetEditorButtonCssClass){const r=ke((l=this._options)==null?void 0:l.resetEditorButtonCssClass);for(const m of r)t.classList.add(m)}return t}createFormResetButtonElement(){var i;const e=v("div",{className:"reset-container"}),t=v("button",{type:"button",className:"btn btn-sm reset-form"},e);return v("span",{className:((i=this._options)==null?void 0:i.resetFormButtonIconCssClass)??""},t),t.appendChild(document.createTextNode(" Reset Form")),e}executeOnError(e){var i;(((i=this._options)==null?void 0:i.onError)??se)(e)}async executeOnSave(e,t,i,s){var o,l,r,m;try{if(this.showValidationSummaryText(!1,""),this.validateCompositeEditors().valid){if(this._modalSaveButtonElm.classList.add("saving"),this._modalSaveButtonElm.disabled=!0,typeof((o=this._options)==null?void 0:o.onSave)=="function"){const d=this._options.modalType==="mass-update"||this._options.modalType==="mass-selection";let f;d&&((l=this._options)!=null&&l.shouldPreviewMassChangeDataset)&&(f=e(this.formValues,this.getCurrentRowSelections(),!1));const c=d?f:s;await((r=this._options)==null?void 0:r.onSave(this.formValues,this.getCurrentRowSelections(),c))&&(e(this.formValues,this.getCurrentRowSelections()),t())}else e(this.formValues,this.getCurrentRowSelections()),t();typeof i=="function"&&i(),this.dispose()}}catch(a){const d=typeof a=="string"?a:(a==null?void 0:a.message)??((m=a==null?void 0:a.body)==null?void 0:m.message)??"";this.showValidationSummaryText(!0,d)}}focusOnFirstColumnCellWithEditor(e,t,i,s,o){const l=o&&!this.gridOptions.enableAddRow&&s>=this.dataViewLength?this.dataViewLength-1:s;let r=i;const m=e[i].editorClass;let a=this.grid.getCellNode(l,i);if(!m||!a||!this.getActiveCellEditor(l,i)){if(r=this.findNextAvailableEditorColumnIndex(e,t,s,o),r===-1)return this.executeOnError({type:"error",code:"NO_EDITOR_FOUND",message:"We could not find any Editor in your Column Definition"}),!1;this.grid.setActiveCell(l,r,!1),o&&this.grid.setActiveRow(this.dataViewLength,r,!0)}return a=this.grid.getCellNode(l,r),!!a}findNextAvailableEditorColumnIndex(e,t,i,s){var l;let o=-1;for(let r=0;r<e.length;r++){const m=e[r];if(m.editorClass&&(!s||s&&((l=m.editor)!=null&&l.massUpdate))){const a=this.grid.onBeforeEditCell.notify({row:i,cell:r,item:t,column:m,grid:this.grid,target:"composite",compositeEditorOptions:this._compositeOptions}).getReturnValue();if(this.grid.setActiveCell(i,r,!1),a!==!1){o=r;break}}}return o}getColumnByObjectOrId(e){let t;return typeof e=="object"?t=e:typeof e=="string"&&(t=this._columnDefinitions.find(i=>i.id===e)),t}getActiveCellEditor(e,t){return this.grid.setActiveCell(e,t,!1),this.grid.getCellEditor()}getColumnLabel(e){var l;const t=this.gridOptions.columnGroupSeparator||" - ";let i=e.nameCompositeEditor||e.name||"",s=e.columnGroup||"";if(this.gridOptions.enableTranslate&&this.translaterService){const r=e.nameCompositeEditorKey||e.nameKey;r&&(i=this.translaterService.translate(r)),e.columnGroupKey&&((l=this.translaterService)!=null&&l.translate)&&(s=this.translaterService.translate(e.columnGroupKey))}const o=s?`${s}${t}${i}`:i;return Ie(o,"innerHTML")}getLabelText(e,t,i){var o,l,r,m,a;const s={...(o=this.gridOptions.compositeEditorOptions)==null?void 0:o.labels,...(l=this._options)==null?void 0:l.labels};if((r=this.gridOptions)!=null&&r.enableTranslate&&((m=this.translaterService)!=null&&m.translate)&&s.hasOwnProperty(`${e}Key`)){const d=s[`${e}Key`];return this.translaterService.translate(d||"")}return(s==null?void 0:s[e])??((a=this._locales)==null?void 0:a[t])??i}getCurrentRowSelections(){const e=this.dataView.getAllSelectedIds();return{gridRowIndexes:this.dataView.mapIdsToRows(e),dataContextIds:e}}handleBodyClicked(e){var t,i,s;(i=(t=e.target)==null?void 0:t.classList)!=null&&i.contains("slick-editor-modal")&&((s=this._options)==null?void 0:s.backdrop)!=="static"&&this.dispose()}handleKeyDown(e){e.code==="Escape"?(this.cancelEditing(),e.stopPropagation(),e.preventDefault()):e.code==="Tab"&&this.validateCurrentEditor()}handleResetInputValue(e){var s,o;const t=e.target.name,i=(s=this._editors)==null?void 0:s[t];typeof(i==null?void 0:i.reset)=="function"&&i.reset(),(o=this._formValues)==null||delete o[t]}async handleMassSaving(e,t){if(!this.formValues||Object.keys(this.formValues).length===0)this.executeOnError({type:"warning",code:"NO_CHANGES_DETECTED",message:"Sorry we could not detect any changes."});else{const i=e==="mass-update"?"applySaveMassUpdateChanges":"applySaveMassSelectionChanges";this.executeOnSave(this[i].bind(this),t.bind(this))}}handleOnCompositeEditorChange(e,t){var r,m,a,d;const i=((r=t.column)==null?void 0:r.id)??"";this._formValues={...this._formValues,...t.formValues};const s=(m=this._editors)==null?void 0:m[i],o=((a=s==null?void 0:s.isValueTouched)==null?void 0:a.call(s))??((d=s==null?void 0:s.isValueChanged)==null?void 0:d.call(s))??!1;this._itemDataContext=(s==null?void 0:s.dataContext)??{};const l=this._modalElm.querySelector(`[data-editorid='${i}']`);l!=null&&l.classList&&(o?l.classList.add("modified"):l.classList.remove("modified")),this.validateCompositeEditors()}hasRowSelectionEnabled(){const e=this.grid.getSelectionModel();return!!((this.gridOptions.enableRowSelection||this.gridOptions.enableCheckboxSelector)&&e)}handleResetFormClicked(){for(const e of Object.keys(this._editors)){const t=this._editors[e];t!=null&&t.reset&&t.reset()}this._formValues=Oe(this._formValues)}async handleSaveClicked(){var t,i,s,o;const e=(t=this._options)==null?void 0:t.modalType;switch(e){case"mass-update":this.handleMassSaving(e,()=>{var a;(a=this.grid.getEditController())==null||a.cancelCurrentEdit(),this.grid.setActiveCell(0,0,!1),this._options.shouldClearRowSelectionAfterMassAction&&this.grid.setSelectedRows([])});break;case"mass-selection":this.handleMassSaving(e,()=>{var a;(a=this.grid.getEditController())==null||a.cancelCurrentEdit(),this.grid.setActiveRow(this._lastActiveRowNumber),this._options.shouldClearRowSelectionAfterMassAction&&this.grid.setSelectedRows([])});break;case"clone":const l={...this._originalDataContext,...this.formValues},r=()=>{var a;(a=this.grid.getEditController())==null||a.cancelCurrentEdit(),this.grid.setActiveCell(0,0,!1)};this.executeOnSave(this.insertNewItemInDataView.bind(this,l),r,this.resetCurrentRowDataContext.bind(this),l);break;case"create":case"edit":default:let m=(i=this.grid.getEditController())==null?void 0:i.commitCurrentEdit();if(m&&typeof((s=this._options)==null?void 0:s.onSave)=="function"){const a=e==="create"?this._originalDataContext:this.grid.getDataItem(this._lastActiveRowNumber);m=await((o=this._options)==null?void 0:o.onSave(this.formValues,this.getCurrentRowSelections(),a))}m&&this.dispose();break}}insertNewItemInDataView(e){var s,o;const t=((s=this.dataView)==null?void 0:s.getItemCount())||0,i=this._options.insertNewId??t+1;return e[this.gridOptions.datasetIdPropertyName||"id"]=i,this.dataView.getItemById(i)?this.executeOnError({type:"error",code:"ITEM_ALREADY_EXIST",message:`The item object which you are trying to add already exist with the same Id:: ${i}`}):(o=this.gridService)==null||o.addItem(e,this._options.insertOptions),e}parseText(e,t){return e.replace(/\{\{(.*?)\}\}/g,(i,s)=>t[s]!==void 0?t[s]:i)}resetCurrentRowDataContext(){const e=this.gridOptions.datasetIdPropertyName||"id";this.grid.getData().updateItem(this._originalDataContext[e],this._originalDataContext)}validateCompositeEditors(e){let t={valid:!0,msg:""};const i=this.grid.getCellEditor();return i&&(t=i.validate(e)),t}validateCurrentEditor(){const e=this.grid.getCellEditor();e!=null&&e.validate&&e.validate()}}var $e=Object.create,Y=Object.defineProperty,Pe=Object.getOwnPropertyDescriptor,je=(u,e)=>(e=Symbol[u])?e:Symbol.for("Symbol."+u),re=u=>{throw TypeError(u)},de=(u,e,t)=>e in u?Y(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t,ze=(u,e)=>Y(u,"name",{value:e,configurable:!0}),We=u=>[,,,$e(null)],qe=["class","method","getter","setter","accessor","field","value","get","set"],ce=u=>u!==void 0&&typeof u!="function"?re("Function expected"):u,He=(u,e,t,i,s)=>({kind:qe[u],name:e,metadata:i,addInitializer:o=>t._?re("Already initialized"):s.push(ce(o||null))}),Ke=(u,e)=>de(e,je("metadata"),u[3]),Qe=(u,e,t,i)=>{for(var s=0,o=u[e>>1],l=o&&o.length;s<l;s++)o[s].call(t);return i},Ye=(u,e,t,i,s,o)=>{var l,r,m,a=e&7,d=!1,f=0,c=u[f]||(u[f]=[]),n=a&&(s=s.prototype,a<5&&(a>3||!d)&&Pe(s,t));ze(s,t);for(var h=i.length-1;h>=0;h--)m=He(a,t,r={},u[3],c),l=(0,i[h])(s,m),r._=1,ce(l)&&(s=l);return Ke(u,s),n&&Y(s,t,n),d?a^4?o:n:s},y=(u,e,t)=>de(u,typeof e!="symbol"?e+"":e,t),me,X;const Xe=500;function Je(u,e,t){const i=t==null?void 0:t.getOptions(),s=e.editor;let l=!!(i.editable&&s);if(u&&e&&(i!=null&&i.editable))switch(e.id){case"finish":l=!!(u!=null&&u.completed);break}return l}const Ze=(u,e,t,i,s,o)=>{const r=o.getOptions().editable&&i.editor;return t=t??"",r?{text:t,addClasses:"editable-field",toolTip:"Click to Edit"}:t},et=(u,e)=>(u==null||!u.length)&&(e.compositeEditorOptions&&e.compositeEditorOptions.modalType==="create"||e.compositeEditorOptions.modalType==="edit")?{valid:!1,msg:"This is a required field."}:/^(task\s\d+)*$/i.test(u)?{valid:!0,msg:""}:{valid:!1,msg:'Your title is invalid, it must start with "Task" followed by a number.'};me=[Le(Ue)];class Q{constructor(e=Re(Ne(Ae))){this.http=e,y(this,"_darkMode",!1),y(this,"title","Example 30: Composite Editor Modal"),y(this,"subTitle",`Composite Editor allows you to Create, Clone, Edit, Mass Update & Mass Selection Changes inside a nice Modal Window.
  <br>The modal is simply populated by looping through your column definition list and also uses a lot of the same logic as inline editing (see <a href="https://ghiscoding.gitbook.io/aurelia-slickgrid/grid-functionalities/composite-editor-modal" target="_blank">Composite Editor - Wiki</a>.)`),y(this,"aureliaGrid"),y(this,"compositeEditorInstance"),y(this,"gridOptions"),y(this,"columnDefinitions",[]),y(this,"dataset",[]),y(this,"editQueue",[]),y(this,"editedItems",{}),y(this,"hideSubTitle",!1),y(this,"isGridEditable",!0),y(this,"isCompositeDisabled",!1),y(this,"isMassSelectionDisabled",!0),y(this,"cellCssStyleQueue",[]),y(this,"complexityLevelList",[{value:0,label:"Very Simple"},{value:1,label:"Simple"},{value:2,label:"Straightforward"},{value:3,label:"Complex"},{value:4,label:"Very Complex"}]),this.compositeEditorInstance=new Ge}created(){this.defineGrids()}attached(){this.dataset=this.loadData(Xe)}detaching(){document.querySelector(".panel-wm-content").classList.remove("dark-mode"),document.querySelector("#demo-container").dataset.bsTheme="light"}defineGrids(){this.columnDefinitions=[{id:"title",name:'<span title="Task must always be followed by a number" class="text-warning mdi mdi-alert-outline"></span> Title <span title="Title is always rendered as UPPERCASE" class="mdi mdi-information-outline"></span>',field:"title",sortable:!0,type:S.string,minWidth:75,cssClass:"text-uppercase fw-bold",columnGroup:"Common Factor",filterable:!0,filter:{model:I.compoundInputText},editor:{model:O.longText,massUpdate:!1,required:!0,alwaysSaveOnEnterKey:!0,maxLength:12,editorOptions:{cols:45,rows:6,buttonTexts:{cancel:"Close",save:"Done"}},validator:et}},{id:"duration",name:"Duration",field:"duration",sortable:!0,filterable:!0,minWidth:75,type:S.number,columnGroup:"Common Factor",formatter:(e,t,i)=>i==null||i===""?"":i>1?`${i} days`:`${i} day`,editor:{model:O.float,massUpdate:!0,decimal:2,valueStep:1,minValue:0,maxValue:1e4,alwaysSaveOnEnterKey:!0,required:!0}},{id:"cost",name:"Cost",field:"cost",width:90,minWidth:70,sortable:!0,filterable:!0,type:S.number,columnGroup:"Analysis",filter:{model:I.compoundInputNumber},formatter:k.dollar},{id:"percentComplete",name:"% Complete",field:"percentComplete",minWidth:100,type:S.number,sortable:!0,filterable:!0,columnGroup:"Analysis",filter:{model:I.compoundSlider,operator:">="},editor:{model:O.slider,massUpdate:!0,minValue:0,maxValue:100},customTooltip:{position:"center"}},{id:"complexity",name:"Complexity",field:"complexity",minWidth:100,type:S.number,sortable:!0,filterable:!0,columnGroup:"Analysis",formatter:(e,t,i)=>{var s;return(s=this.complexityLevelList[i])==null?void 0:s.label},exportCustomFormatter:(e,t,i)=>{var s;return(s=this.complexityLevelList[i])==null?void 0:s.label},filter:{model:I.multipleSelect,collection:this.complexityLevelList},editor:{model:O.singleSelect,collection:this.complexityLevelList,massUpdate:!0}},{id:"start",name:"Start",field:"start",sortable:!0,minWidth:100,formatter:k.dateUs,columnGroup:"Period",exportCustomFormatter:k.dateUs,type:S.date,outputType:S.dateUs,saveOutputType:S.dateUtc,filterable:!0,filter:{model:I.compoundDate},editor:{model:O.date,massUpdate:!0,editorOptions:{hideClearButton:!1}}},{id:"completed",name:"Completed",field:"completed",width:80,minWidth:75,maxWidth:100,sortable:!0,filterable:!0,columnGroup:"Period",cssClass:"text-center",formatter:k.checkmarkMaterial,exportWithFormatter:!1,filter:{collection:[{value:"",label:""},{value:!0,label:"True"},{value:!1,label:"False"}],model:I.singleSelect},editor:{model:O.checkbox,massUpdate:!0}},{id:"finish",name:"Finish",field:"finish",sortable:!0,minWidth:100,formatter:k.dateUs,columnGroup:"Period",type:S.date,outputType:S.dateUs,saveOutputType:S.dateUtc,filterable:!0,filter:{model:I.compoundDate},exportCustomFormatter:k.dateUs,editor:{model:O.date,editorOptions:{range:{min:"today"}},massUpdate:!0,validator:(e,t)=>{const i=t==null?void 0:t.item;return i&&i.completed&&!e?{valid:!1,msg:'You must provide a "Finish" date when "Completed" is checked.'}:{valid:!0,msg:""}}}},{id:"product",name:"Product",field:"product",filterable:!0,columnGroup:"Item",minWidth:100,exportWithFormatter:!0,dataKey:"id",labelKey:"itemName",formatter:k.complexObject,exportCustomFormatter:k.complex,type:S.object,sortComparer:te.objectString,editor:{model:O.autocompleter,alwaysSaveOnEnterKey:!0,massUpdate:!0,editorOptions:{minLength:1,fetch:(e,t)=>{const i=this.mockProducts();t(i.filter(s=>s.itemName.toLowerCase().includes(e.toLowerCase())))},renderItem:{layout:"fourCorners",templateCallback:e=>this.renderItemCallbackWith4Corners(e)}}},filter:{model:I.inputText,type:S.string,queryField:"product.itemName"}},{id:"origin",name:"Country of Origin",field:"origin",formatter:k.complexObject,columnGroup:"Item",exportCustomFormatter:k.complex,dataKey:"code",labelKey:"name",type:S.object,sortComparer:te.objectString,filterable:!0,sortable:!0,minWidth:100,editor:{model:O.autocompleter,massUpdate:!0,customStructure:{label:"name",value:"code"},collectionAsync:this.http.fetch(Fe),editorOptions:{minLength:0}},filter:{model:I.inputText,type:"string",queryField:"origin.name"}},{id:"action",name:"Action",field:"action",width:70,minWidth:70,maxWidth:70,excludeFromExport:!0,formatter:()=>'<div class="button-style margin-auto" style="width: 35px;"><span class="mdi mdi-chevron-down text-primary"></span></div>',cellMenu:{hideCloseButton:!1,commandTitle:"Commands",commandItems:[{command:"edit",title:"Edit Row",iconCssClass:"mdi mdi-pencil",positionOrder:66,action:()=>this.openCompositeModal("edit")},{command:"clone",title:"Clone Row",iconCssClass:"mdi mdi-content-copy",positionOrder:66,action:()=>this.openCompositeModal("clone")},"divider",{command:"delete-row",title:"Delete Row",positionOrder:64,iconCssClass:"mdi mdi-close color-danger",cssClass:"red",textCssClass:"text-italic color-danger-light",itemVisibilityOverride:e=>{var t;return!((t=e.dataContext)!=null&&t.completed)},action:(e,t)=>{const i=t.dataContext,s=(t==null?void 0:t.row)??0;confirm(`Do you really want to delete row (${s+1}) with "${i.title}"`)&&this.aureliaGrid.gridService.deleteItemById(i.id)}}]}}],this.gridOptions={enableAddRow:!0,enableCellNavigation:!0,asyncEditorLoading:!1,autoEdit:!0,autoCommitEdit:!0,editable:!0,autoAddCustomEditorFormatter:Ze,autoResize:{container:"#demo-container",rightPadding:10},darkMode:this._darkMode,enableAutoSizeColumns:!0,enableAutoResize:!0,showCustomFooter:!0,enablePagination:!0,pagination:{pageSize:10,pageSizes:[10,200,250,500,5e3]},enableExcelExport:!0,excelExportOptions:{exportWithFormatter:!1},externalResources:[new Me,new De,this.compositeEditorInstance],enableFiltering:!0,rowSelectionOptions:{selectActiveRow:!1},createPreHeaderPanel:!0,showPreHeaderPanel:!0,preHeaderPanelHeight:28,enableCheckboxSelector:!0,enableRowSelection:!0,multiSelect:!1,checkboxSelector:{hideInFilterHeaderRow:!1,hideInColumnTitleRow:!0},enableCompositeEditor:!0,editCommandHandler:(e,t,i)=>{const s=Array.isArray(i.prevSerializedValue)?i.prevSerializedValue:[i.prevSerializedValue],o=Array.isArray(i.serializedValue)?i.serializedValue:[i.serializedValue],l=this.columnDefinitions.filter(m=>m.editor!==void 0),r=[];s.forEach((m,a)=>{const d=s[a],f=o[a];if(d!==f||f===""){const c=Array.isArray(i.prevSerializedValue)?l[a]:t;this.editedItems[this.gridOptions.datasetIdPropertyName||"id"]=e,this.aureliaGrid.slickGrid.invalidate(),i.execute(),this.renderUnsavedCellStyling(e,c,i),r.push(c)}}),this.editQueue.push({item:e,columns:r,editCommand:i})},enableCellMenu:!0,cellMenu:{activateCellOnMenuClick:!0},gridMenu:{hideToggleDarkModeCommand:!1,onCommand:(e,t)=>{t.command==="toggle-dark-mode"&&(this._darkMode=!this._darkMode,this.toggleBodyBackground())}}}}loadData(e){var i,s;const t=[];for(let o=0;o<e;o++){const l=Math.floor(Math.random()*this.mockProducts().length),r=2e3+Math.floor(Math.random()*10),m=new Date().getFullYear()+Math.floor(Math.random()*10),a=Math.floor(Math.random()*11),d=Math.floor(Math.random()*29),f=Math.floor(Math.random()*59),c=new Date(m,a+1,d,f,f,f),n=Math.floor(Math.random()*100)+15,h=n>100?o>5?100:88:n,g=h===100;t[o]={id:o,title:"Task "+o,duration:Math.floor(Math.random()*100)+10,percentComplete:h,analysis:{percentComplete:h},complexity:o%3?0:2,start:new Date(r,a,d,d,f,f,f),finish:g||o%3===0&&c>new Date&&o>3?g?new Date:c:"",cost:o%33===0?null:Math.round(Math.random()*1e4)/100,completed:g&&o>5||o%3===0&&c>new Date&&o>3,product:{id:(i=this.mockProducts()[l])==null?void 0:i.id,itemName:(s=this.mockProducts()[l])==null?void 0:s.itemName},origin:o%2?{code:"CA",name:"Canada"}:{code:"US",name:"United States"}},o%8||(delete t[o].finish,delete t[o].percentComplete)}return t}aureliaGridReady(e){this.aureliaGrid=e}handleValidationError(e,t){if(t.validationResults){let i=t.validationResults.msg||"";if(t.editor&&t.editor instanceof le){if(t.validationResults.errors){i+=`
`;for(const s of t.validationResults.errors){const o=s.editor.args.column.name;i+=`${o.toUpperCase()}: ${s.msg}`}}console.log(i)}}else alert(t.validationResults.msg);return e.preventDefault(),!1}handleItemDeleted(e){console.log("item deleted with id:",e)}handleOnBeforeEditCell(e,t){const{column:i,item:s,grid:o}=t;return i&&s&&!Je(s,i,o)?(e.preventDefault(),!1):!0}handleOnCellChange(e,t){const i=t==null?void 0:t.item;i&&!i.completed&&(i.finish=null,this.aureliaGrid.gridService.updateItem(i))}handleOnCellClicked(e,t){console.log(e,t)}handleOnCompositeEditorChange(e,t){const i=t.column,s=t.formValues;i.id==="percentComplete"&&s.percentComplete===100&&(this.compositeEditorInstance.changeFormInputValue("completed",!0),this.compositeEditorInstance.changeFormInputValue("finish",new Date))}handleReRenderUnsavedStyling(){this.removeAllUnsavedStylingFromCell(),this.renderUnsavedStylingOnAllVisibleCells()}handleOnGridStateChanged(e){var t,i,s,o;Array.isArray((i=(t=e.gridState)==null?void 0:t.rowSelection)==null?void 0:i.dataContextIds)&&(this.isMassSelectionDisabled=((o=(s=e.gridState)==null?void 0:s.rowSelection)==null?void 0:o.dataContextIds.length)===0)}openCompositeModal(e){var i;let t="";switch(e){case"create":t="Inserting New Task";break;case"clone":t="Clone - {{title}}";break;case"edit":t='Editing - {{title}} (<span class="text-muted">id:</span> <span class="text-primary">{{id}}</span>)';break;case"mass-update":t="Mass Update All Records";break;case"mass-selection":t="Update Selected Records";break}(i=this.compositeEditorInstance)==null||i.openDetails({headerTitle:t,modalType:e,insertOptions:{highlightRow:!1},showFormResetButton:!0,resetFormButtonIconCssClass:"mdi mdi-undo",onClose:()=>Promise.resolve(confirm("You have unsaved changes, are you sure you want to close this window?")),onError:s=>alert(s.message),onRendered:s=>{s.dataset.bsTheme=this._darkMode?"dark":"light"},onSave:(s,o,l)=>e==="mass-update"||e==="mass-selection"?new Promise((m,a)=>{window.setTimeout(()=>{s.percentComplete>=50?m(!0):a("Unfortunately we only accept a minimum of 50% Completion...")},50)}):(console.log(`${e} item data context`,l),new Promise(m=>window.setTimeout(()=>m(!0),50)))})}toggleGridEditReadonly(){this.undoAllEdits(),this.isGridEditable=!this.isGridEditable,this.isCompositeDisabled=!this.isGridEditable,this.isGridEditable||(this.isMassSelectionDisabled=!0),this.aureliaGrid.slickGrid.setOptions({editable:this.isGridEditable})}toggleDarkMode(){var e;this._darkMode=!this._darkMode,this.toggleBodyBackground(),(e=this.aureliaGrid.slickGrid)==null||e.setOptions({darkMode:this._darkMode})}toggleBodyBackground(){this._darkMode?(document.querySelector(".panel-wm-content").classList.add("dark-mode"),document.querySelector("#demo-container").dataset.bsTheme="dark"):(document.querySelector(".panel-wm-content").classList.remove("dark-mode"),document.querySelector("#demo-container").dataset.bsTheme="light")}removeUnsavedStylingFromCell(e,t,i){const s=`unsaved_highlight_${[t.id]}${i}`;this.aureliaGrid.slickGrid.removeCellCssStyles(s);const o=this.cellCssStyleQueue.findIndex(l=>l===s);o>=0&&this.cellCssStyleQueue.splice(o,1)}removeAllUnsavedStylingFromCell(){for(const e of this.cellCssStyleQueue)this.aureliaGrid.slickGrid.removeCellCssStyles(e);this.cellCssStyleQueue=[]}renderUnsavedStylingOnAllVisibleCells(){for(const e of this.editQueue)if(e){const{item:t,columns:i,editCommand:s}=e;Array.isArray(i)&&i.forEach(o=>{this.renderUnsavedCellStyling(t,o,s)})}}renderUnsavedCellStyling(e,t,i){if(i&&e&&t){const s=this.aureliaGrid.dataView.getRowByItem(e);if(s>=0){const o={[s]:{[t.id]:"unsaved-editable-field"}},l=`unsaved_highlight_${[t.id]}${s}`;this.aureliaGrid.slickGrid.setCellCssStyles(`unsaved_highlight_${[t.id]}${s}`,o),this.cellCssStyleQueue.push(l)}}}saveAll(){console.log(this.editQueue),console.log(this.editedItems),this.removeAllUnsavedStylingFromCell(),this.editQueue=[],this.editedItems={}}undoLastEdit(e=!1){const t=this.editQueue.pop(),i=t==null?void 0:t.editCommand;if(t&&i&&ie.cancelCurrentEdit()){i.undo();for(const s of t.columns)this.removeUnsavedStylingFromCell(t.item,s,i.row);this.aureliaGrid.slickGrid.invalidate(),e&&this.aureliaGrid.slickGrid.gotoCell(i.row,i.cell,!1)}}undoAllEdits(){for(const e of this.editQueue){const t=e==null?void 0:e.editCommand;if(t&&ie.cancelCurrentEdit()){t.undo();for(const i of e.columns)this.removeUnsavedStylingFromCell(e.item,i,t.row)}}this.aureliaGrid.slickGrid.invalidate(),this.editQueue=[]}mockProducts(){return[{id:0,itemName:"Sleek Metal Computer",itemNameTranslated:"some fantastic sleek metal computer description",listPrice:2100.23,itemTypeName:"I",image:"http://i.stack.imgur.com/pC1Tv.jpg",icon:this.getRandomIcon(0)},{id:1,itemName:"Tasty Granite Table",itemNameTranslated:"an extremely huge and heavy table",listPrice:3200.12,itemTypeName:"I",image:"https://i.imgur.com/Fnm7j6h.jpg",icon:this.getRandomIcon(1)},{id:2,itemName:"Awesome Wooden Mouse",itemNameTranslated:"super old mouse",listPrice:15,itemTypeName:"I",image:"https://i.imgur.com/RaVJuLr.jpg",icon:this.getRandomIcon(2)},{id:3,itemName:"Gorgeous Fresh Shirt",itemNameTranslated:"what a gorgeous shirt seriously",listPrice:25.76,itemTypeName:"I",image:"http://i.stack.imgur.com/pC1Tv.jpg",icon:this.getRandomIcon(3)},{id:4,itemName:"Refined Cotton Table",itemNameTranslated:"super light table that will fall apart amazingly fast",listPrice:13.35,itemTypeName:"I",image:"https://i.imgur.com/Fnm7j6h.jpg",icon:this.getRandomIcon(4)},{id:5,itemName:"Intelligent Wooden Pizza",itemNameTranslated:"wood not included",listPrice:23.33,itemTypeName:"I",image:"https://i.imgur.com/RaVJuLr.jpg",icon:this.getRandomIcon(5)},{id:6,itemName:"Licensed Cotton Chips",itemNameTranslated:"not sure what that is",listPrice:71.21,itemTypeName:"I",image:"http://i.stack.imgur.com/pC1Tv.jpg",icon:this.getRandomIcon(6)},{id:7,itemName:"Ergonomic Rubber Soap",itemNameTranslated:"so good you'll want to use it every night",listPrice:2.43,itemTypeName:"I",image:"https://i.imgur.com/Fnm7j6h.jpg",icon:this.getRandomIcon(7)},{id:8,itemName:"Handcrafted Steel Car",itemNameTranslated:"aka tesla truck",listPrice:31288.39,itemTypeName:"I",image:"https://i.imgur.com/RaVJuLr.jpg",icon:this.getRandomIcon(8)}]}getRandomIcon(e){const t=["mdi-arrow-collapse","mdi-arrow-expand","mdi-cancel","mdi-check","mdi-checkbox-blank-outline","mdi-check-box-outline","mdi-checkbox-marked","mdi-close","mdi-close-circle","mdi-close-circle-outline","mdi-close-thick","mdi-content-copy","mdi-database-refresh","mdi-download","mdi-file-document-outline","mdi-file-excel-outline","mdi-file-music-outline","mdi-file-pdf-outline","mdi-filter-remove-outline","mdi-flip-vertical","mdi-folder","mdi-folder-open","mdi-help-circle","mdi-help-circle-outline","mdi-history","mdi-information","mdi-information-outline","mdi-link","mdi-link-variant","mdi-menu","mdi-microsoft-excel","mdi-minus","mdi-page-first","mdi-page-last","mdi-paperclip","mdi-pin-off-outline","mdi-pin-outline","mdi-playlist-plus","mdi-playlist-remove","mdi-plus","mdi-redo","mdi-refresh","mdi-shape-square-plus","mdi-sort-ascending","mdi-sort-descending","mdi-swap-horizontal","mdi-swap-vertical","mdi-sync","mdi-table-edit","mdi-table-refresh","mdi-undo"],i=Math.floor(Math.random()*t.length-1);return t[e??i]}renderItemCallbackWith2Rows(e){return`<div class="autocomplete-container-list">
      <div class="autocomplete-left">
        <!--<img src="http://i.stack.imgur.com/pC1Tv.jpg" width="50" />-->
        <span class="mdi ${e.icon}"></span>
      </div>
      <div>
        <span class="autocomplete-top-left">
          <span class="mdi ${e.itemTypeName==="I"?"mdi-information-outline":"mdi-content-copy"}"></span>
          ${e.itemName}
        </span>
      <div>
      </div>
    <div>
    <div class="autocomplete-bottom-left">${e.itemNameTranslated}</div>
    </div>`}renderItemCallbackWith4Corners(e){return`<div class="autocomplete-container-list">
          <div class="autocomplete-left">
            <!--<img src="http://i.stack.imgur.com/pC1Tv.jpg" width="50" />-->
            <span class="mdi ${e.icon}"></span>
          </div>
          <div>
            <span class="autocomplete-top-left">
              <span class="mdi ${e.itemTypeName==="I"?"mdi-information-outline":"mdi-content-copy"}"></span>
              ${e.itemName}
            </span>
            <span class="autocomplete-top-right">${Ve(e.listPrice,2,2,!1,"$")}</span>
          <div>
        </div>
        <div>
          <div class="autocomplete-bottom-left">${e.itemNameTranslated}</div>
          <span class="autocomplete-bottom-right">Type: <b>${e.itemTypeName==="I"?"Item":e.itemTypeName==="C"?"PdCat":"Cat"}</b></span>
        </div>`}toggleSubTitle(){var t;this.hideSubTitle=!this.hideSubTitle;const e=this.hideSubTitle?"add":"remove";(t=document.querySelector(".subtitle"))==null||t.classList[e]("hidden"),this.aureliaGrid.resizerService.resizeGrid(0)}}X=We();Q=Ye(X,0,"Example30",me,Q);Qe(X,1,Q);export{Q as Example30};
//# sourceMappingURL=example30-Aj2ZYj9y.js.map
