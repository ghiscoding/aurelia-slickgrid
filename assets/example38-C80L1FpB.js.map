{"version":3,"file":"example38-C80L1FpB.js","sources":["../../src/examples/slickgrid/example38.$au.ts","../../src/examples/slickgrid/example38.ts"],"sourcesContent":["import { CustomElement } from '@aurelia/runtime-html';\nimport \"./example38.scss\";\nexport const name = \"example38\";\nexport const template = \"<div class=\\\"demo38\\\">\\n  <h2>\\n    Example 38: OData (v4) Backend Service with Infinite Scroll\\n    <span class=\\\"float-end\\\">\\n      <a style=\\\"font-size: 18px\\\" target=\\\"_blank\\\"\\n        href=\\\"https://github.com/ghiscoding/aurelia-slickgrid/blob/master/packages/demo/src/examples/slickgrid/example38.ts\\\">\\n        <span class=\\\"mdi mdi-link-variant\\\"></span> code\\n      </a>\\n    </span>\\n    <button\\n      class=\\\"ms-2 btn btn-outline-secondary btn-sm btn-icon\\\"\\n      type=\\\"button\\\"\\n      data-test=\\\"toggle-subtitle\\\"\\n      click.trigger=\\\"toggleSubTitle()\\\"\\n    >\\n      <span class=\\\"mdi mdi-information-outline\\\" title=\\\"Toggle example sub-title details\\\"></span>\\n    </button>\\n  </h2>\\n\\n  <div class=\\\"subtitle\\\">\\n    <ul>\\n      <li>\\n        Infinite scrolling allows the grid to lazy-load rows from the server when reaching the scroll bottom (end) position.\\n        In its simplest form, the more the user scrolls down, the more rows get loaded.\\n        If we reached the end of the dataset and there is no more data to load, then we'll assume to have the entire dataset loaded in memory.\\n        This contrast with the regular Pagination approach which will only hold a single page data at a time.\\n      </li>\\n      <li>NOTES</li>\\n      <ol>\\n        <li>\\n          <code>presets.pagination</code> is not supported with Infinite Scroll and will revert to the first page,\\n          simply because since we keep appending data, we always have to start from index zero (no offset).\\n        </li>\\n        <li>\\n          Pagination is not shown BUT in fact, that is what is being used behind the scene whenever reaching the scroll end (fetching next batch).\\n        </li>\\n        <li>\\n          Also note that whenever the user changes the Sort(s)/Filter(s) it will always reset and go back to zero index (first page).\\n        </li>\\n      </ol>\\n    </ul>\\n  </div>\\n\\n  <div class=\\\"row\\\">\\n    <div class=\\\"col-sm-3\\\">\\n      <div class=\\\"alert alert-danger\\\" show.bind=\\\"errorStatus\\\" data-test=\\\"error-status\\\">\\n        <em><strong>Backend Error:</strong> <span innerhtml.bind=\\\"errorStatus\\\"></span></em>\\n      </div>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"row\\\">\\n    <div class=\\\"col-sm-2\\\">\\n      <div class.bind=\\\"status.class\\\" role=\\\"alert\\\" data-test=\\\"status\\\">\\n        <strong>Status: </strong> ${status.text}\\n        <span hidden.bind=\\\"!processing\\\">\\n          <i class=\\\"mdi mdi-sync mdi-spin\\\"></i>\\n        </span>\\n      </div>\\n    </div>\\n    <div class=\\\"col-sm-10\\\">\\n      <div class=\\\"alert alert-info\\\" data-test=\\\"alert-odata-query\\\">\\n        <strong>OData Query:</strong> <span data-test=\\\"odata-query-result\\\">${odataQuery}</span>\\n      </div>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"row\\\">\\n    <div class=\\\"col-sm-12\\\">\\n      <button class=\\\"btn btn-outline-secondary btn-sm btn-icon\\\" data-test=\\\"clear-filters-sorting\\\"\\n              click.trigger=\\\"clearAllFiltersAndSorts()\\\" title=\\\"Clear all Filters & Sorts\\\">\\n        <i class=\\\"mdi mdi-filter-remove-outline\\\"></i>\\n        Clear all Filter & Sorts\\n      </button>\\n      <button class=\\\"btn btn-outline-secondary btn-sm\\\" data-test=\\\"set-dynamic-filter\\\"\\n              click.trigger=\\\"setFiltersDynamically()\\\">\\n        Set Filters Dynamically\\n      </button>\\n      <button class=\\\"btn btn-outline-secondary btn-sm\\\" data-test=\\\"set-dynamic-sorting\\\"\\n              click.trigger=\\\"setSortingDynamically()\\\">\\n        Set Sorting Dynamically\\n      </button>\\n      <button class=\\\"btn btn-outline-secondary btn-sm\\\" data-test=\\\"group-by-gender\\\"\\n              click.trigger=\\\"groupByGender()\\\">\\n        Group by Gender\\n      </button>\\n\\n      <div show.bind=\\\"metrics\\\" class=\\\"mt-2\\\" style=\\\"margin: 10px 0px\\\">\\n        <b>Metrics:</b>\\n        <span>\\n          <span>${metrics.endTime | dateFormat: 'DD MMM, h:mm:ss a'}</span> â€”\\n            <span data-test=\\\"itemCount\\\">${metrics.itemCount}</span>\\n            of\\n            <span data-test=\\\"totalItemCount\\\">${metrics.totalItemCount}</span>\\n            items\\n        </span>\\n        <span class=\\\"badge rounded-pill text-bg-primary\\\" class.bind=\\\"tagDataClass\\\" data-test=\\\"data-loaded-tag\\\">All Data Loaded!!!</span>\\n      </div>\\n    </div>\\n  </div>\\n\\n  <aurelia-slickgrid\\n    grid-id=\\\"grid38\\\"\\n    column-definitions.bind=\\\"columnDefinitions\\\"\\n    grid-options.bind=\\\"gridOptions\\\"\\n    dataset.bind=\\\"dataset\\\"\\n    instances.bind=\\\"aureliaGrid\\\"\\n    on-aurelia-grid-created.trigger=\\\"aureliaGridReady($event.detail)\\\"\\n    on-row-count-changed.trigger=\\\"refreshMetrics($event.detail.args)\\\">\\n  </aurelia-slickgrid>\\n</div>\\n\";\nexport default template;\nexport const dependencies = [  ];\nexport const bindables = {};\nlet _e;\nexport function register(container) {\n  if (!_e) {\n    _e = CustomElement.define({ name, template, dependencies, bindables });\n  }\n  container.register(_e);\n}\n","import { IHttpClient } from '@aurelia/fetch-client';\nimport { newInstanceOf, resolve } from '@aurelia/kernel';\nimport { GridOdataService, type OdataServiceApi } from '@slickgrid-universal/odata';\nimport {\n  type AureliaGridInstance,\n  Aggregators,\n  type Column,\n  FieldType,\n  Filters,\n  type GridOption,\n  type Grouping,\n  type Metrics,\n  type OnRowCountChangedEventArgs,\n  SortComparers,\n} from 'aurelia-slickgrid';\n\nimport './example38.scss';\nimport SAMPLE_DATA_URL from './data/customers_100.json?url';\n\nconst CARET_HTML_ESCAPED = '%5E';\nconst PERCENT_HTML_ESCAPED = '%25';\n\nexport class Example38 {\n  aureliaGrid: AureliaGridInstance;\n  backendService: GridOdataService;\n  columnDefinitions!: Column[];\n  gridOptions!: GridOption;\n  dataset: any[] = [];\n  isPageErrorTest = false;\n  metrics!: Partial<Metrics>;\n  tagDataClass = '';\n  odataQuery = '';\n  hideSubTitle = false;\n  processing = false;\n  errorStatus = '';\n  errorStatusClass = 'hidden';\n  status = { text: 'processing...', class: 'alert alert-danger' };\n\n  constructor(readonly http: IHttpClient = resolve(newInstanceOf(IHttpClient))) {\n    this.backendService = new GridOdataService();\n    this.initializeGrid();\n  }\n\n  aureliaGridReady(aureliaGrid: AureliaGridInstance) {\n    this.aureliaGrid = aureliaGrid;\n  }\n\n  initializeGrid() {\n    this.columnDefinitions = [\n      {\n        id: 'name', name: 'Name', field: 'name', sortable: true,\n        type: FieldType.string,\n        filterable: true,\n        filter: { model: Filters.compoundInput }\n      },\n      {\n        id: 'gender', name: 'Gender', field: 'gender', filterable: true, sortable: true,\n        filter: {\n          model: Filters.singleSelect,\n          collection: [{ value: '', label: '' }, { value: 'male', label: 'male' }, { value: 'female', label: 'female' }]\n        }\n      },\n      { id: 'company', name: 'Company', field: 'company', filterable: true, sortable: true },\n      {\n        id: 'category_name', name: 'Category', field: 'category/name', filterable: true, sortable: true,\n        formatter: (_row, _cell, _val, _colDef, dataContext) => dataContext['category']?.['name'] || ''\n      }\n    ];\n\n    this.gridOptions = {\n      enableAutoResize: true,\n      autoResize: {\n        container: '#demo-container',\n        rightPadding: 10\n      },\n      checkboxSelector: {\n        // you can toggle these 2 properties to show the \"select all\" checkbox in different location\n        hideInFilterHeaderRow: false,\n        hideInColumnTitleRow: true\n      },\n      enableCellNavigation: true,\n      enableFiltering: true,\n      enableCheckboxSelector: true,\n      enableRowSelection: true,\n      enableGrouping: true,\n      headerMenu: {\n        hideFreezeColumnsCommand: false,\n      },\n      presets: {\n        // NOTE: pagination preset is NOT supported with infinite scroll\n        // filters: [{ columnId: 'gender', searchTerms: ['female'] }]\n      },\n      backendServiceApi: {\n        service: this.backendService,\n        options: {\n          // enable infinite via Boolean OR via { fetchSize: number }\n          infiniteScroll: { fetchSize: 30 }, // or use true, in that case it would use default size of 25\n          enableCount: true,\n          version: 4\n        },\n        onError: (error: Error) => {\n          this.errorStatus = error.message;\n          this.errorStatusClass = 'visible notification is-light is-danger is-small is-narrow';\n          this.displaySpinner(false, true);\n        },\n        preProcess: () => {\n          this.errorStatus = '';\n          this.errorStatusClass = 'hidden';\n          this.displaySpinner(true);\n        },\n        process: (query) => this.getCustomerApiCall(query),\n        postProcess: (response) => {\n          this.metrics = response.metrics;\n          this.displaySpinner(false);\n          this.getCustomerCallback(response);\n        },\n        // we could use local in-memory Filtering (please note that it only filters against what is currently loaded)\n        // that is when we want to avoid reloading the entire dataset every time\n        // useLocalFiltering: true,\n      } as OdataServiceApi,\n    };\n  }\n\n  displaySpinner(isProcessing: boolean, isError?: boolean) {\n    this.processing = isProcessing;\n    if (isError) {\n      this.status = { text: 'ERROR!!!', class: 'alert alert-danger' };\n    } else {\n      this.status = (isProcessing)\n        ? { text: 'loading', class: 'alert alert-warning' }\n        : { text: 'finished', class: 'alert alert-success' };\n    }\n  }\n\n  getCustomerCallback(data: { '@odata.count': number; infiniteScrollBottomHit: boolean; metrics: Metrics; query: string; value: any[]; }) {\n    // totalItems property needs to be filled for pagination to work correctly\n    // however we need to force a dirty check, doing a clone object will do just that\n    const totalItemCount: number = data['@odata.count'];\n    this.metrics.totalItemCount = totalItemCount;\n\n    // even if we're not showing pagination, it is still used behind the scene to fetch next set of data (next page basically)\n    // once pagination totalItems is filled, we can update the dataset\n\n    // infinite scroll has an extra data property to determine if we hit an infinite scroll and there's still more data (in that case we need append data)\n    // or if we're on first data fetching (no scroll bottom ever occured yet)\n    if (!data.infiniteScrollBottomHit) {\n      // initial load not scroll hit yet, full dataset assignment\n      this.aureliaGrid.slickGrid?.scrollTo(0); // scroll back to top to avoid unwanted onScroll end triggered\n      this.dataset = data.value;\n      this.metrics.itemCount = data.value.length;\n    } else {\n      // scroll hit, for better perf we can simply use the DataView directly for better perf (which is better compare to replacing the entire dataset)\n      this.aureliaGrid.dataView?.addItems(data.value);\n    }\n\n    this.odataQuery = data['query'];\n\n    // NOTE: you can get currently loaded item count via the `onRowCountChanged`slick event, see `refreshMetrics()` below\n    // OR you could also calculate it yourself or get it via: `this.sgb.dataView.getItemCount() === totalItemCount`\n    // console.log('is data fully loaded: ', this.sgb.dataView?.getItemCount() === totalItemCount);\n  }\n\n  getCustomerApiCall(query: string) {\n    // in your case, you will call your WebAPI function (wich needs to return a Promise)\n    // for the demo purpose, we will call a mock WebAPI function\n    return this.getCustomerDataApiMock(query);\n  }\n\n  /**\n   * This function is only here to mock a WebAPI call (since we are using a JSON file for the demo)\n   *  in your case the getCustomer() should be a WebAPI function returning a Promise\n   */\n  getCustomerDataApiMock(query: string): Promise<any> {\n    this.errorStatusClass = 'hidden';\n\n    // the mock is returning a Promise, just like a WebAPI typically does\n    return new Promise((resolve) => {\n      const queryParams = query.toLowerCase().split('&');\n      let top = 0;\n      let skip = 0;\n      let orderBy = '';\n      let countTotalItems = 100;\n      const columnFilters: any = {};\n\n      if (this.isPageErrorTest) {\n        this.isPageErrorTest = false;\n        throw new Error('Server timed out trying to retrieve data for the last page');\n      }\n\n      for (const param of queryParams) {\n        if (param.includes('$top=')) {\n          top = +(param.substring('$top='.length));\n          if (top === 50000) {\n            throw new Error('Server timed out retrieving 50,000 rows');\n          }\n        }\n        if (param.includes('$skip=')) {\n          skip = +(param.substring('$skip='.length));\n        }\n        if (param.includes('$orderby=')) {\n          orderBy = param.substring('$orderby='.length);\n        }\n        if (param.includes('$filter=')) {\n          const filterBy = param.substring('$filter='.length).replace('%20', ' ');\n          if (filterBy.includes('matchespattern')) {\n            const regex = new RegExp(`matchespattern\\\\(([a-zA-Z]+),\\\\s'${CARET_HTML_ESCAPED}(.*?)'\\\\)`, 'i');\n            const filterMatch = filterBy.match(regex) || [];\n            const fieldName = filterMatch[1].trim();\n            columnFilters[fieldName] = { type: 'matchespattern', term: '^' + filterMatch[2].trim() };\n          }\n          if (filterBy.includes('contains')) {\n            const filterMatch = filterBy.match(/contains\\(([a-zA-Z/]+),\\s?'(.*?)'/) || [];\n            const fieldName = filterMatch[1].trim();\n            columnFilters[fieldName] = { type: 'substring', term: filterMatch[2].trim() };\n          }\n          if (filterBy.includes('substringof')) {\n            const filterMatch = filterBy.match(/substringof\\('(.*?)',\\s([a-zA-Z/]+)/) || [];\n            const fieldName = filterMatch[2].trim();\n            columnFilters[fieldName] = { type: 'substring', term: filterMatch[1].trim() };\n          }\n          for (const operator of ['eq', 'ne', 'le', 'lt', 'gt', 'ge']) {\n            if (filterBy.includes(operator)) {\n              const re = new RegExp(`([a-zA-Z ]*) ${operator} '(.*?)'`);\n              const filterMatch = re.exec(filterBy);\n              if (Array.isArray(filterMatch)) {\n                const fieldName = filterMatch[1].trim();\n                columnFilters[fieldName] = { type: operator, term: filterMatch[2].trim() };\n              }\n            }\n          }\n          if (filterBy.includes('startswith') && filterBy.includes('endswith')) {\n            const filterStartMatch = filterBy.match(/startswith\\(([a-zA-Z ]*),\\s?'(.*?)'/) || [];\n            const filterEndMatch = filterBy.match(/endswith\\(([a-zA-Z ]*),\\s?'(.*?)'/) || [];\n            const fieldName = filterStartMatch[1].trim();\n            columnFilters[fieldName] = { type: 'starts+ends', term: [filterStartMatch[2].trim(), filterEndMatch[2].trim()] };\n          } else if (filterBy.includes('startswith')) {\n            const filterMatch = filterBy.match(/startswith\\(([a-zA-Z ]*),\\s?'(.*?)'/) || [];\n            const fieldName = filterMatch[1].trim();\n            columnFilters[fieldName] = { type: 'starts', term: filterMatch[2].trim() };\n          } else if (filterBy.includes('endswith')) {\n            const filterMatch = filterBy.match(/endswith\\(([a-zA-Z ]*),\\s?'(.*?)'/) || [];\n            const fieldName = filterMatch[1].trim();\n            columnFilters[fieldName] = { type: 'ends', term: filterMatch[2].trim() };\n          }\n\n          // simular a backend error when trying to sort on the \"Company\" field\n          if (filterBy.includes('company')) {\n            throw new Error('Server could not filter using the field \"Company\"');\n          }\n        }\n      }\n\n      // simulate a backend error when trying to sort on the \"Company\" field\n      if (orderBy.includes('company')) {\n        throw new Error('Server could not sort using the field \"Company\"');\n      }\n\n      this.http.fetch(SAMPLE_DATA_URL)\n        .then(e => e.json())\n        .then((data: any) => {\n          // Sort the data\n          if (orderBy?.length > 0) {\n            const orderByClauses = orderBy.split(',');\n            for (const orderByClause of orderByClauses) {\n              const orderByParts = orderByClause.split(' ');\n              const orderByField = orderByParts[0];\n\n              let selector = (obj: any): string => obj;\n              for (const orderByFieldPart of orderByField.split('/')) {\n                const prevSelector = selector;\n                selector = (obj: any) => {\n                  return prevSelector(obj)[orderByFieldPart as any];\n                };\n              }\n\n              const sort = orderByParts[1] ?? 'asc';\n              switch (sort.toLocaleLowerCase()) {\n                case 'asc':\n                  data = data.sort((a, b) => selector(a).localeCompare(selector(b)));\n                  break;\n                case 'desc':\n                  data = data.sort((a, b) => selector(b).localeCompare(selector(a)));\n                  break;\n              }\n            }\n          }\n\n          // Read the result field from the JSON response.\n          let firstRow = skip;\n          let filteredData = data;\n          if (columnFilters) {\n            for (const columnId in columnFilters) {\n              if (columnFilters.hasOwnProperty(columnId)) {\n                filteredData = filteredData.filter(column => {\n                  const filterType = columnFilters[columnId].type;\n                  const searchTerm = columnFilters[columnId].term;\n                  let colId = columnId;\n                  if (columnId?.indexOf(' ') !== -1) {\n                    const splitIds = columnId.split(' ');\n                    colId = splitIds[splitIds.length - 1];\n                  }\n\n                  let filterTerm;\n                  let col = column;\n                  for (const part of colId.split('/')) {\n                    filterTerm = col[part];\n                    col = filterTerm;\n                  }\n\n                  if (filterTerm) {\n                    const [term1, term2] = Array.isArray(searchTerm) ? searchTerm : [searchTerm];\n\n                    switch (filterType) {\n                      case 'eq': return filterTerm.toLowerCase() === term1;\n                      case 'ne': return filterTerm.toLowerCase() !== term1;\n                      case 'le': return filterTerm.toLowerCase() <= term1;\n                      case 'lt': return filterTerm.toLowerCase() < term1;\n                      case 'gt': return filterTerm.toLowerCase() > term1;\n                      case 'ge': return filterTerm.toLowerCase() >= term1;\n                      case 'ends': return filterTerm.toLowerCase().endsWith(term1);\n                      case 'starts': return filterTerm.toLowerCase().startsWith(term1);\n                      case 'starts+ends': return filterTerm.toLowerCase().startsWith(term1) && filterTerm.toLowerCase().endsWith(term2);\n                      case 'substring': return filterTerm.toLowerCase().includes(term1);\n                      case 'matchespattern': return new RegExp((term1 as string).replaceAll(PERCENT_HTML_ESCAPED, '.*'), 'i').test(filterTerm);\n                    }\n                  }\n                });\n              }\n            }\n            countTotalItems = filteredData.length;\n          }\n\n          // make sure page skip is not out of boundaries, if so reset to first page & remove skip from query\n          if (firstRow > filteredData.length) {\n            query = query.replace(`$skip=${firstRow}`, '');\n            firstRow = 0;\n          }\n          const updatedData = filteredData.slice(firstRow, firstRow + top);\n\n          window.setTimeout(() => {\n            const backendResult: any = { query };\n            backendResult['value'] = updatedData;\n            backendResult['@odata.count'] = countTotalItems;\n\n            // console.log('Backend Result', backendResult);\n            resolve(backendResult);\n          }, 100);\n        });\n    });\n  }\n\n  groupByGender() {\n    this.aureliaGrid?.dataView?.setGrouping({\n      getter: 'gender',\n      formatter: (g) => `Gender: ${g.value} <span class=\"text-green\">(${g.count} items)</span>`,\n      comparer: (a, b) => SortComparers.string(a.value, b.value),\n      aggregators: [\n        new Aggregators.Sum('gemder')\n      ],\n      aggregateCollapsed: false,\n      lazyTotalsCalculation: true\n    } as Grouping);\n\n    // you need to manually add the sort icon(s) in UI\n    this.aureliaGrid?.slickGrid.setSortColumns([{ columnId: 'duration', sortAsc: true }]);\n    this.aureliaGrid?.slickGrid.invalidate(); // invalidate all rows and re-render\n  }\n\n  clearAllFiltersAndSorts() {\n    if (this.aureliaGrid?.gridService) {\n      this.aureliaGrid.gridService.clearAllFiltersAndSorts();\n    }\n  }\n\n  setFiltersDynamically() {\n    // we can Set Filters Dynamically (or different filters) afterward through the FilterService\n    this.aureliaGrid?.filterService.updateFilters([\n      { columnId: 'gender', searchTerms: ['female'] },\n    ]);\n  }\n\n  refreshMetrics(args: OnRowCountChangedEventArgs) {\n    if (args?.current >= 0) {\n      this.metrics.itemCount = this.aureliaGrid.dataView?.getFilteredItemCount() || 0;\n      this.tagDataClass = this.metrics.itemCount === this.metrics.totalItemCount\n        ? 'fully-loaded'\n        : 'partial-load';\n    }\n  }\n\n  setSortingDynamically() {\n    this.aureliaGrid?.sortService.updateSorting([\n      { columnId: 'name', direction: 'DESC' },\n    ]);\n  }\n\n  toggleSubTitle() {\n    this.hideSubTitle = !this.hideSubTitle;\n    const action = this.hideSubTitle ? 'add' : 'remove';\n    document.querySelector('.subtitle')?.classList[action]('hidden');\n    this.aureliaGrid.resizerService.resizeGrid(0);\n  }\n}\n"],"names":["name","template","dependencies","bindables","_e","register","container","CustomElement","_Example38_decorators","_init","CARET_HTML_ESCAPED","PERCENT_HTML_ESCAPED","customElement","__au2ViewDef","Example38","http","resolve","newInstanceOf","IHttpClient","__publicField","GridOdataService","aureliaGrid","FieldType","Filters","_row","_cell","_val","_colDef","dataContext","_a","error","query","response","isProcessing","isError","data","totalItemCount","_b","queryParams","top","skip","orderBy","countTotalItems","columnFilters","param","filterBy","regex","filterMatch","fieldName","operator","filterStartMatch","filterEndMatch","SAMPLE_DATA_URL","e","orderByClauses","orderByClause","orderByParts","orderByField","selector","obj","orderByFieldPart","prevSelector","a","b","firstRow","filteredData","columnId","column","filterType","searchTerm","colId","splitIds","filterTerm","col","part","term1","term2","updatedData","backendResult","g","SortComparers","Aggregators","_c","_d","args","action","__decoratorStart","__decorateElement","__runInitializers"],"mappings":"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"}