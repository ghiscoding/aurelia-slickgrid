{"version":3,"file":"example35-BGs_mPsL.js","sources":["../../src/examples/slickgrid/example35.$au.ts","../../src/examples/slickgrid/example35.ts"],"sourcesContent":["import { CustomElement } from '@aurelia/runtime-html';\nimport \"./example35.scss\";\nexport const name = \"example35\";\nexport const template = \"<h2>\\n  Example 35: Row Based Editing\\n  <span class=\\\"float-end\\\">\\n    <a style=\\\"font-size: 18px\\\"\\n        target=\\\"_blank\\\"\\n        href=\\\"https://github.com/ghiscoding/aurelia-slickgrid/blob/master/packages/demo/src/examples/slickgrid/example35.ts\\\">\\n      <span class=\\\"mdi mdi-link-variant\\\"></span> code\\n    </a>\\n  </span>\\n  <button\\n      class=\\\"ms-2 btn btn-outline-secondary btn-sm btn-icon\\\"\\n      type=\\\"button\\\"\\n      data-test=\\\"toggle-subtitle\\\"\\n      click.trigger=\\\"toggleSubTitle()\\\"\\n    >\\n      <span class=\\\"mdi mdi-information-outline\\\" title=\\\"Toggle example sub-title details\\\"></span>\\n    </button>\\n</h2>\\n\\n<div class=\\\"subtitle\\\">\\n  <ul>\\n    <li>\\n      The Row Based Edit plugin allows you to edit either a single or multiple\\n      specific rows at a time, while disabling the rest of the grid rows.\\n    </li>\\n    <li>\\n      Editedable rows, as well as modified cells are highlighted with a\\n      different color, which you can customize using css variables (see\\n      <a\\n        target=\\\"_blank\\\"\\n        href=\\\"https://github.com/ghiscoding/aurelia-slickgrid/blob/master/packages/demo/src/examples/slickgrid/example35.scss\\\"\\n      >\\n        example35.scss </a\\n      >)\\n    </li>\\n    <li>\\n      Modifications are kept track of and if the cancel button is pressed, all\\n      modifications are rolled back.\\n    </li>\\n    <li>\\n      If the save button is pressed, a custom \\\"onBeforeRowUpdated\\\" callback is called, which you can use to save the data with your backend.<br />\\n      The callback needs to return a Promise&lt;boolean&gt; and if the promise resolves to true, then the row will be updated, otherwise it will be cancelled and stays in edit mode.\\n      You can try out the later by defining a Duration value <b>larger than 40</b>.\\n      <br />\\n      <small><span class=\\\"has-text-danger\\\">NOTE:</span> You can also combine this with e.g. Batch Editing like shown <a href=\\\"#/example30\\\">in Example 30</a></small>\\n    </li>\\n    <li>\\n      This example additionally uses the ExcelCopyBuffer Plugin, which you can see also in Slickgrid-Universal\\n       <a href=\\\"https://ghiscoding.github.io/slickgrid-universal/#/example19\\\">example 19</a>.\\n      The example defines a rule that pastes in the first column are prohibited. In combination with the Row Based Editing Plugin though, this rule gets enhanced with the fact\\n      that only the edited rows are allowed to be pasted into, while still respecting the original rule.\\n    </li>\\n  </ul>\\n</div>\\n\\n<section>\\n  <div class=\\\"row mb-4\\\">\\n      <div class=\\\"col-sm-8\\\">\\n        <button\\n          class=\\\"btn btn-outline-secondary btn-sm btn-icon\\\"\\n          data-test=\\\"single-multi-toggle\\\"\\n          click.trigger=\\\"toggleSingleMultiRowEdit()\\\"\\n        >\\n          Toggle Single/Multi Row Edit\\n        </button>\\n        <button class=\\\"btn btn-outline-secondary btn-sm btn-icon\\\" data-test=\\\"toggle-language\\\" click.trigger=\\\"switchLanguage()\\\">\\n          <i class=\\\"mdi mdi-translate\\\"></i>\\n          Switch Language for Action column buttons\\n        </button>\\n        <label>Locale:</label>\\n        <span style=\\\"font-style: italic; width: 70px;\\\" data-test=\\\"selected-locale\\\">\\n          ${selectedLanguage + '.json'}\\n        </span>\\n      </div>\\n\\n      <div class=\\\"col-sm-4\\\" class.bind=\\\"statusClass\\\">\\n        <strong>Status: </strong>\\n        <span data-test=\\\"fetch-result\\\" textcontent.bind=\\\"fetchResult\\\"></span>\\n      </div>\\n  </div>\\n</section>\\n\\n<aurelia-slickgrid grid-id=\\\"grid35\\\" column-definitions.bind=\\\"columnDefinitions\\\" grid-options.bind=\\\"gridOptions\\\"\\n    dataset.bind=\\\"dataset\\\" instances.bind=\\\"aureliaGrid\\\">\\n</aurelia-slickgrid>\\n\";\nexport default template;\nexport const dependencies = [  ];\nexport const bindables = {};\nlet _e;\nexport function register(container) {\n  if (!_e) {\n    _e = CustomElement.define({ name, template, dependencies, bindables });\n  }\n  container.register(_e);\n}\n","import {\n  type AureliaGridInstance,\n  type Column,\n  Editors,\n  FieldType,\n  Formatters,\n  type GridOption,\n} from 'aurelia-slickgrid';\nimport { I18N } from '@aurelia/i18n';\nimport { SlickCustomTooltip } from '@slickgrid-universal/custom-tooltip-plugin';\n// import { TOptions as I18NOptions } from 'i18next';\n\nimport './example35.scss';\nimport { resolve } from 'aurelia';\n\nconst NB_ITEMS = 20;\n\nexport class Example35 {\n  aureliaGrid!: AureliaGridInstance;\n  gridOptions!: GridOption;\n  columnDefinitions!: Column[];\n  dataset!: any[];\n  fetchResult = '';\n  hideSubTitle = false;\n  selectedLanguage: string;\n  selectedLanguageFile: string;\n  statusClass = 'alert alert-light';\n  statusStyle = 'display: none';\n\n  constructor(private readonly i18n: I18N = resolve(I18N)) {\n    // define the grid options & columns and then create the grid itself\n    this.defineGrid();\n\n    // always start with English for Cypress E2E tests to be consistent\n    const defaultLang = 'en';\n    this.i18n.setLocale(defaultLang);\n    this.selectedLanguage = defaultLang;\n  }\n\n  attached() {\n    // mock some data (different in each dataset)\n    this.dataset = this.getData(NB_ITEMS);\n  }\n\n  /* Define grid Options and Columns */\n  defineGrid() {\n    this.columnDefinitions = [\n      {\n        id: 'title',\n        name: 'Title',\n        field: 'title',\n        sortable: true,\n        minWidth: 100,\n        filterable: true,\n        editor: { model: Editors.text },\n      },\n      {\n        id: 'duration',\n        name: 'Duration (days)',\n        field: 'duration',\n        sortable: true,\n        minWidth: 100,\n        filterable: true,\n        type: FieldType.number,\n        editor: { model: Editors.text },\n      },\n      {\n        id: '%',\n        name: '% Complete',\n        field: 'percentComplete',\n        sortable: true,\n        minWidth: 100,\n        filterable: true,\n        type: FieldType.number,\n        editor: { model: Editors.text },\n      },\n      {\n        id: 'start',\n        name: 'Start',\n        field: 'start',\n        formatter: Formatters.dateIso,\n        exportWithFormatter: true,\n        filterable: true,\n        editor: { model: Editors.date },\n      },\n      {\n        id: 'finish',\n        name: 'Finish',\n        field: 'finish',\n        formatter: Formatters.dateIso,\n        exportWithFormatter: true,\n        filterable: true,\n        editor: { model: Editors.date },\n      },\n      {\n        id: 'effort-driven',\n        name: 'Effort Driven',\n        field: 'effortDriven',\n        sortable: true,\n        minWidth: 100,\n        filterable: true,\n        type: 'boolean',\n        editor: { model: Editors.checkbox },\n      },\n    ];\n\n    this.gridOptions = {\n      enableAutoResize: false,\n      gridHeight: 350,\n      gridWidth: 800,\n      rowHeight: 33,\n      enableExcelCopyBuffer: true,\n      excelCopyBufferOptions: {\n        onBeforePasteCell: (_e, args) => {\n          // for the sake of the demo, do not allow to paste into the first column title\n          // this will be overriden by the row based edit plugin to additionally only work if the row is in editmode\n          return args.cell > 0;\n        },\n      },\n      // NOTE: this will be automatically turned to true by the Row Based Edit Plugin.\n      // A console warning will be shown if you omit this flag\n      autoEdit: false,\n      editable: true,\n      enableCellNavigation: true,\n      enableRowBasedEdit: true,\n      enableTranslate: true,\n      i18n: this.i18n,\n      rowBasedEditOptions: {\n        allowMultipleRows: false,\n        onBeforeEditMode: () => this.clearStatus(),\n        onBeforeRowUpdated: (args) => {\n          const { effortDriven, percentComplete, finish, start, duration, title } = args.dataContext;\n\n          if (duration > 40) {\n            alert('Sorry, 40 is the maximum allowed duration.');\n            return Promise.resolve(false);\n          }\n\n          return fakeFetch('your-backend-api/endpoint', {\n            method: 'POST',\n            body: JSON.stringify({ effortDriven, percentComplete, finish, start, duration, title }),\n            headers: {\n              'Content-type': 'application/json; charset=UTF-8'\n            }\n          }).catch(err => {\n            console.error(err);\n            return false;\n          })\n            .then((response: any) => {\n              if (response === false) {\n                this.statusClass = 'alert alert-danger';\n                return false;\n              }\n              if (typeof response === 'object') {\n                return response!.json();\n              }\n            })\n            .then(json => {\n              this.statusStyle = 'display: block';\n              this.statusClass = 'alert alert-success';\n              this.fetchResult = json.message;\n              return true;\n            });\n        },\n        actionColumnConfig: { // override the defaults of the action column\n          width: 100,\n          minWidth: 100,\n          maxWidth: 100,\n        },\n        actionButtons: {\n          editButtonClassName: 'button-style margin-auto btn-icon px-2 me-1',\n          iconEditButtonClassName: 'mdi mdi-pencil',\n          // since no title and no titleKey is provided, it will fallback to the default text provided by the plugin\n          // if the title is provided but no titleKey, it will override the default text\n          // last but not least if a titleKey is provided, it will use the translation key to translate the text\n          // editButtonTitle: 'Edit row',\n\n          cancelButtonClassName: 'button-style btn-icon px-2',\n          cancelButtonTitle: 'Cancel row',\n          cancelButtonTitleKey: 'RBE_BTN_CANCEL',\n          iconCancelButtonClassName: 'mdi mdi-undo text-danger',\n          cancelButtonPrompt: 'Are you sure you want to cancel your changes?',\n\n          updateButtonClassName: 'button-style btn-icon px-2 me-1',\n          updateButtonTitle: 'Update row',\n          updateButtonTitleKey: 'RBE_BTN_UPDATE',\n          iconUpdateButtonClassName: 'mdi mdi-check text-success',\n          updateButtonPrompt: 'Save changes?',\n\n          deleteButtonClassName: 'button-style btn-icon px-2',\n          deleteButtonTitle: 'Delete row',\n          iconDeleteButtonClassName: 'mdi mdi-trash-can text-danger',\n          deleteButtonPrompt: 'Are you sure you want to delete this row?',\n        },\n      },\n      externalResources: [new SlickCustomTooltip()],\n    };\n  }\n\n  getData(count: number) {\n    // mock a dataset\n    const mockDataset: any[] = [];\n    for (let i = 0; i < count; i++) {\n      const randomYear = 2000 + Math.floor(Math.random() * 10);\n      const randomMonth = Math.floor(Math.random() * 11);\n      const randomDay = Math.floor(Math.random() * 29);\n      const randomPercent = Math.round(Math.random() * 100);\n\n      mockDataset[i] = {\n        id: i,\n        title: 'Task ' + i,\n        duration: Math.round(Math.random() * 40) + '',\n        percentComplete: randomPercent,\n        start: new Date(randomYear, randomMonth + 1, randomDay),\n        finish: new Date(randomYear + 1, randomMonth + 1, randomDay),\n        effortDriven: i % 5 === 0,\n      };\n    }\n\n    return mockDataset;\n  }\n\n  clearStatus() {\n    this.statusClass = 'alert alert-light';\n    this.statusStyle = 'display: none';\n    this.fetchResult = '';\n  }\n\n  toggleSingleMultiRowEdit() {\n    const gridOptions = {\n      ...this.gridOptions,\n      ...{\n        rowBasedEditOptions: {\n          ...this.gridOptions.rowBasedEditOptions,\n          ...{ allowMultipleRows: !this.gridOptions.rowBasedEditOptions?.allowMultipleRows },\n        },\n      },\n    };\n    this.aureliaGrid.slickGrid.setOptions(gridOptions);\n    this.gridOptions = this.aureliaGrid.slickGrid.getOptions();\n  }\n\n  async switchLanguage() {\n    const nextLanguage = (this.selectedLanguage === 'en') ? 'fr' : 'en';\n    await this.i18n.setLocale(nextLanguage);\n    this.selectedLanguage = nextLanguage;\n  }\n\n  toggleSubTitle() {\n    this.hideSubTitle = !this.hideSubTitle;\n    const action = this.hideSubTitle ? 'add' : 'remove';\n    document.querySelector('.subtitle')?.classList[action]('hidden');\n    this.aureliaGrid.resizerService.resizeGrid(0);\n  }\n}\n\nfunction fakeFetch(_input: string | URL | Request, _init?: RequestInit | undefined): Promise<Response> {\n  return new Promise((resolve) => {\n    window.setTimeout(() => {\n      resolve(new Response(JSON.stringify({ status: 200, message: 'success' })));\n      // reduces the delay for automated Cypress tests\n    }, (window as any).Cypress ? 10 : 500);\n  });\n}\n"],"names":["name","template","dependencies","bindables","_e","register","container","CustomElement","_Example35_decorators","_init","NB_ITEMS","customElement","__au2ViewDef","Example35","i18n","resolve","I18N","__publicField","defaultLang","Editors","FieldType","Formatters","args","effortDriven","percentComplete","finish","start","duration","title","fakeFetch","err","response","json","SlickCustomTooltip","count","mockDataset","i","randomYear","randomMonth","randomDay","randomPercent","gridOptions","_a","nextLanguage","action","__decoratorStart","__decorateElement","__runInitializers","_input"],"mappings":"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"}